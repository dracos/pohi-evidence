FUJ00234962
FUJ00234962

DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

Document Title: DRS Host Support Guide

Document Reference: DEV/APP/SPG/0028

Release: HNG-X 20.15

Abstract: This document details the TWS scheduling of the DRS Host
processes including NWB, DCP and ETU.

Document Status: APPROVED

Author & Dept: Gyan Patel; Wing Pang; Tony Dolton

Akshya Kumar Nahak
External Distribution:

Security Risk YES, see section 0.9
Assessment Confirmed

Approval Authorities:

Signature

Adam Woodley SSC

See HNG-X Reviewers/Approvers Matrix (PGM/DCM/ON/0001) for guidance on who should approve.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEVIAPP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 1 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

0 Document Control
0.1 Table of Contents
Q DOCUMENT CONTROL.......ccccccscsccsccesesetecsseceseseseessesessseesecssesenseseeeeesene 2
0.1 Table of Contents 2
0.2 Document History 7
0.3 Review Details. 7
0.4 Associated Documents (Internal & External) 8
05 9
06
07
0.8 Accuracy..........
0.9 Security Risk Assessmen
4 INTRODUCTION ........ccccsesseseseseseessssessseseeseseesscsseessssesscseeseaseseeecenneeseasens 12
1.1 Document Overview..
41.2 DRS Data Flow Diagram
2 INSTALLATION. ......cccsesssssessesescsssseesesseecsssseesesesecesessesesasecesasenseseecesesanensese 15
2.4 Environment Variable:
2.2
23
2.4 Oracle Tablespaces and Raw Volume:
2.5 Database Roles and Users.

2.5.4

5.2

2.5.3 DRS Workstation Users

2.5.4 DRS Workstation User Account Closure

2.5.5 DRS Workstation User Account Unlocking
3 TWS RESOURCES...
4 TRANSACTION VOLUMES AND DATABASE STORAGE CAPACITY...23
5 PROCESS FAILURE AND RECOVERY 23
5.1 Automatic re-run by TWS... 23
5.2 Failures due to Oracle Error. 24
5.3 Eailures due to Application and System Error .. 24
6 NETWORK BANKING SCHEDULE DETAILS...........ccccseessesseeeseeeeeeeee 24
6.1 Schedule M_DB_SRV#DRS_ NWB_ SOD........cesesseeeseeeee

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY Date 30-Mar-2020

STORED Page No: 2 0f 114
FUJ00234962
FUJ00234962

DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

6.1.4 Dependencies...
6.1.2 Process DRSC350
.2 Schedule M DB SRV#DRS TIDY ORA

is
jw]
toy
oy
iS
io
io
is
9.
lo
ie

6.2.2 Process HousekeepOrafiles.sh
6.3 Schedule M_ DB SRV#DRS_ETU C4LD
3.4 Dependencie:

2 Process DRSC:

6.3.3 Process DRSC306
6.4 Schedule M DB SRV#DRS_NWB_ANALYZI
Dependencies...
Process DRSC368 ..
Schedule M_DB_SRV#DRS_RDDS EXTRACT
Dependencies

I

I

Schedule M_DB_SRV#DRS_NWB_ SOB

5 Dependencies...
2 Process DRSC353

6.8 Schedule M_DB_ SRV:
Dependencies...
Process DRSC302
Schedule M_DB_SRV#DRS_NWB _MS_NIGHT
Dependencies...
Process DRSC310 [NIGHT].

Schedule M_DB_SRV#DRS NWB MS _EXCPTN
Dependencies...

.2 Process DRSC311
DRS_RDDS_EXTRA'
Dependencies
Process DRSC322
Process DRSC324

Schedule M_DB_SRV#DRS_NWB_REP_ 102
Dependencies...
Process DRSC32
Process DRSC323
Process DRSC325

Schedule M_DB_SR'
Dependencies...
Process DRSC328

Schedule M_DB_SRV#DRS_ ADMIN
Dependencies...
Script DRSX365

Schedule M_DB_SRV#DRS_NWB_ ADMIN
Dependencies...
Process DRSC361
Process DRSC368
Script DRSX362 ..

Schedule M_DB_SRV#DRS_NWB_TRN_ACK..
Dependencies seeeeneenee seeeee

I

I

:

4,
4,
6
6
6
6
6
6
7
7
7
7
8
8
8
8
8
9
9
9
9
0
0
0
1
1
1
2
2
2
2
3
3
3
4,
4.
4,
4,
5
5
6
6
6
6
6
7
7
7
8
8
8
8

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 3 of 114
FUJ00234962

FUJ00234962
DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
6.16.2 Process DRSC367 ..
6.17 Schedule M DB SRV#DRS_ COMPLET!
7 DEBIT CARD SCHEDULE DETAILS..........ccccscesssesssesseresseeeseeeneesssseeeenee 39
7.1 Schedule M DB SRV#DRS_EFT SOD 9
0
0
4
4
1
EFT C12 PARS. 1
2
2.
714 “Sc hedule M_DB_ SRV#DRS. 2
74.1 Dependencies... 2
7.4.2 Process DRSC307 2.
Schedule M DB SRV#DRS_EFT STS _C40. 4
4
4
5
EFT STS _C402 5
5
5
6
6
7
‘7
Schedule M_DB_SRV#DRS. 7
Dependencies... 7
7.8.2 Process DRSC305 7
719 Schedule M_DB_SRV3 8
7. Dependencies 8
Process DRSC305 8
Schedule M_DB_SRV#DRS EFT STOP LD 9
Dependencies 19
A Process DRSC: 19
7A4L Schedule M_DB_SRV#DRS EFT C4 PARSE. )
7.11.1 Dependencies... 9
7.11.2 Process DRSC302 10
712 Schedule M_DB_SRV#DRS_EFT C4 RCPTD 0
7.12.1 Dependencies 10
7.12.2 Process DRSC370 10
7.13 Schedule M_DB_SRV#DRS_EFT MS NIGHT. 1
7.13.4 Dependencies 1
7.13.2 Process DRSC: : 1
7.14 Schedule M_DB_SRV#DRS_EFT MS _EXPTN.. 2.
7.14.1 Dependencies... 12
7.14.2 Process DRSC311 2
7.15 Schedule M_DB_SRV#DRS EFT REP 101. 3
7.15.1 Dependencies... 3
7.4 Process DRSC32: 3
7.15.3 Process DRSC324 3
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 4 of 114
DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

7.A6 Schedule M DB _SRV#DRS EFT REP 102.
16.1 Dependencies..........cceereens
Process DRSC320
Process DRSC323
Process DRSC325
TAZ Schedule M_DB_SRV#DRS_ EFT ADMIN ..
17.1 Dependencies
Process DRSC:
Process DRSC368
Script DRSX362.sI
17.5 DRS EFT AUDIT
718 Schedule M_DB_SRV#DRS_ EFT TRN_ ACK
7.18.1 Dependencies
7.18.2 Process DRSC36
7.19 Schedule M_DB_SRV#DRS_EFT PF SIM

7.19.1 Dependencies
7.19.2 Process DRSC:

System Parameters
DRS Tables

3.4 Static Data
Control/Registry Data Tables
Transaction Data Tables ...

9 FILES CREATED/USED.........cccscsssscscecseseeseessecesssessesseecsseseeeseeneceseneneaee 63
9

9.1 Input and Output Data Files
9.1.1 Electronic Top-Up:
9.1.2 Debit Card .....

9.2 Report Files...

9.2.1 Network Banking (Including ETU) and Debit Car

9.3 Oracle Export Files for Audit, Archive and Support .
9.3.1 Network Banking and Debit Card

9.4 DRS File Housekeeping Parameters.

10 SUPPORT USAGE OF ARCHIVE/SUPPORT EXPORT FILEG................. 70

11 BACKUP AND RECOVERY

444 Backup.......
11.2 Recovery...
-1 Process Failui

System Failur
Media Failure.

12 EXTERNAL SYSTEM FAILURES/RESTARTS ......ccsccsscssseseeeeessseeseeees 72
12.4 RDDS Host Database Failur
12.2 TES Host Database Failure
12.3 TWS File Transfer Failure
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 5 of 114
FUJ00234962
FUJ00234962

oO DRS Host Support Guide .
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN &

CONFIDENCE)

12.4 Audit Server File Transfer Failure ..........csssssessssssseseessenteeeeseessestenseeeaseeteseseeeensatense 1D

13.4, Oracle Tuning...
43.2 Schedule tuning
13.2.1 Schedule parallelism
13.2.2 Resource pools.....
13.3 Main store partition tuning.
43.4 SQL hint tuning...............

APPENDIX C — TABLESPACES AND RAW VOLUMES ........cscesesseseeseseeens 78
APPENDIX D — DRS TABLES .........ccssssssesessssesssessseesesssssesssnssessaseeseseeseesseesensens 79

Common Table

Network Banking Table:
Debit Card Tables..

APPENDIX E — DRS EXCEPTIONS. ........cccscsssesessenseseseeessessssesseeesensenserteeneeneas 90

APPENDIX F — DRS ARCHIVING TABLE MAPPING ........cceeesesseeeeeseetnee 114
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEVIAPP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY Date 30-Mar-2020

STORED Page No: 6 of 114
FUJ00234962
FUJ00234962

oO DRS Host Support Guide .
JITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

0.2 Document History

Version No. Date Summary of Changes and Reason for Issue Associated Change -
CP/PEAK/PPRR
Reference

0.1 27/7/2009 Initial build of HNG-X document from Horizon (NB/MAN/003)

02 18/8/2009 Update in response to review comments

03 29/9/2009 Further one-line change in response to comments

04 26/10/2009 Incorporating review comments

1.0 28/10/2009 Approved version

141 25/11/2009 Update for Peak and General corrections PC0189339

1.3 21/12/2010 Additional amendment for Horizon decommissioning CP419

14 09/05/2013 Update for Channel Integration 2a CP0842

15 15-May-2013 Minor corrections to template and reviewers P0842

2.0 07/06/2013 Approved version

24 31/10/2014 Added SSC_TOOLS user (section 2.5.2). CP1305

22 18/12/2014 Updated for comments received. Updated to match the latest

we (sections 6, 7 and 11, most notably 6.2 and 7.4 to

23 21/01/2015 Updated for comments received.

3.0 21/01/2015 Version for approval. CP1305 / R11.47

3.1 16/06/2016 Addition of <SchemeRefData> and <R3Tsmp> to payment file I CP1758

3.2 18/07/2016 Updated for comments received

4.0 18/07/2016 Version for approval

44 15/03/2017 Reference to DAT RMAN BACKUP R17.10

42 20/03/2017 Updated for comments received

5.0 19/04/2017 Approval version

5.1 20/12/2019 Added for New Job DRSC372E_SSK (Section 7.20.3) PC0281363

6.0 24/12/2019 Updated for comments received PC0281363

6.1 27-01-2020 Some corrections made — Pete Jobson N/A

6.2 23-02-2020 Changes for APS/TPS decommission as part of Belfast exit P2347; CWO189

7.0 27-03-2020 For Approval cwo189

0.3 Review Details

See HNG-X Reviewers/Approvers Matrix (PGM/DCM/ION/0001) for guidance on completing the lists below.
You may include additional reviewers if necessary, but you should generally not exclude any of the
mandatory reviewers shown in the matrix for the document type you are authoring.

view Comments by

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEVIAPP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 7 of 114
FUJITSU

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

Review Comments to

Mandatory Review

Gyan Patel & PostOfficeAccountDocumentManagement¢

Role

Name

SSC

Adam Woodley; ssedm¢

Solution Design / Infrastructure Design

Pete Jobson *

Core Services

Andrew Gibson

SV&I Manager ‘Amit Chorgi
Optional Review

Role Name

SMC Team Jacob Cherian; FC.IN. DL_SMC_MANAGEMENT)

Testing Manager

Mark Ascott

Senior Service Delivery Manager

Steve Bansal

Host Development

Issued for Informatio
distribution

Position/Role

toa minimum

Gareth Seemungal

Name

(*) = Reviewers that retured comments

0.4 Associated Documents (Internal & External)

Reference Date le Source
PGM/DCM/TEM/0001(D POA Generic Document Template Dimensions
O NOT REMOVE)
ARC/GEN/REP/0001 HNG-X Glossary Dimensions
PGM/DCM/ION/0001 POA HNG-X Document Dimensions
Reviewers/Approvers Role Matrix
ARC/APP/ARC/007 HNG-X Batch Services Architecture Dimensions
DES/SYM/HLD/0016 HNG-X Scheduling High Level Design Dimensions
DES/SYM/HLD/0015 POA HNG-x Backup and Recovery High I Dimensions
Level Design
ARCISEC/ARC/0003 HNG-X Security Architecture Dimensions
DES/APP/HLD/0033 Data Reconciliation Service High Level Dimensions
Design (Delta)
DES/APP/HLD/0108 DRS Host Sizing HLD Dimensions
PGM/PAS/PRO/0003 HNG-X Design and Build Methodology I Dimensions
Build and Unit Test process
DES/APP/HLD/0089 TES Host Scheduling High Level Design I Dimensions
DES/APP/HLD/0091 HNG-X Host Scheduling High Level Dimensions
Design
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEVIAPP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 8 of 114

FUJ00234962
FUJ00234962

FUJ00234962

FUJ00234962

oO DRS Host Support Guide -
JITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Reference Version Title Sor
DES/APP/IFS/0007 Branch Database to Legacy Host Interface I Dimensions
DEV/APP/SPG/0026 TPS Host Support Guide Dimensions
DEV/INF/LLD/0043 HNG-x SAN Storage Mapping Dimensions
PA/PERIO33 Horizon Capacity Management and Dimensions
Business Volumes
SVM/SEC/PRO/0006 APPLICATION FOR ACCESS TO THE Dimensions
LIVE NETWORK
EF/DES/009 Debit Card System EMIS Timestamp Dimensions
Correction Design Proposal
NB/HLD/003 NWB Data Reconciliation Service High Dimensions
Level Design
NB/HLD/026 DRS Host Application and Workstation Dimensions
High Level Design Delta for IMPACT
Release 3
NB/MAN/003 DRS Host Support Guide (Horizon) Dimensions
EF/IFS/003 DCP DRS Product Interface Specification I Dimensions
DES/APP/IFS/0006 RAC Message Flows in HNG-X Dimensions
DES/APP/SPG/3258 DAT RMAN BACKUP SUPPORT Dimensions
GUIDE

Unless a specific version is referred to above, reference should be made to the current

0.5 Abbreviati

approved versions of the documents.

ons

BCV Business Continuity Volume
BRDB Branch Database

cl Channel Integration

Dep Debit Card Project. New name for EFTPoS/Debit Card Service
DRS Data Reconciliation Service

Dw Fujitsu Services Data Warehouse

EFT EFTPoS. Old name for Debit Card Project

EMIS Electronic Management Information Service

EOD End of Day

ETS Electronic Top-Up Service

ETU Electronic Top-Up

FTMS File Transfer Managed Service

HNG-X Horizon Next Generation

MA Merchant Acquirer (Debit Card Project specific)

MAC Message Authentication Code

MIs. Management Information System

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref.
CONFIDENCE) Version
UNCONTROLLED IF PRINTED OR LOCALLY Date

STORED Page No:

DEV/APP/SPG/0028
7.0

30-Mar-2020

9 of 114
FUJ00234962
FUJ00234962

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

Definiti

Management Support Unit

Network Banking Engine

Network Banking Service

NSI National Savings and Investments
NWB DRS-specific abbreviation for Network Banking Service
PFG Payment File Generation

PODG Post Office Data Gateway

POL Post Office Limited

RMAN Oracle Recovery Manager

TES Transaction Enquiry Service

TIP (POLMI) Transaction Information Project (Now known as POLMI)
TPS Transaction Processing System

Tws Tivoli Work Scheduler

XML eXtensible Mark-up Language

0.6 Glossary

DRS System Date The logical DRS business day. DRS business day falls between running DRS Start of
Day and DRS End of Day jobs. Normally same as the calendar day DRS Start of Day
was run on.

Eternus Astorage system supplied by Fujitsu.

Reconciliation Date The Reconciliation Date is the date attributed to a transaction to allow PO Ltd to

reconcile. It will be set to the first available Settlement Date from the Transaction
Elements ([C112], [C12], [C4], [S], [D]) that make up that transaction. If no Settlement
Date is available, the Reconciliation Date will be set to the processing date that the
DRS first recorded any element of the transaction. If a Settlement Date subsequently
becomes available, the first available Settlement Date will replace the processing
date. However, once a transaction has been accounted for on a reconciliation report,
the Reconciliation Date will never change.

Routing Gateway The Routing Gateway as defined Network Banking Message Flows and Interfaces
[DES/APP/IFS/0006].

Run Date The DRS logical date listed on a report and shows which calendar day the data is for.
It is same as DRS System Date in all cases except NB103 reports where it is a day
(configurable) behind DRS System Date.

Settlement Date The date on which the Client has settled the transaction (in some instances a default
is set by the Banking Host). The Settlement Date will be allocated by the Client (or
failing that the Banking Host) and included in both authorisations and confirmations.
The [C4], [S], and [D] always contain a Settlement Date. Other messages may
contain a Settlement Date.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 10 of 114
FUJ00234962
FUJ00234962

oO DRS Host Support Guide .
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

0.7 Changes Expected

ee

0.8 Accuracy

Fujitsu Services endeavours to ensure that the information contained in this document is correct but, whilst
every effort is made to ensure the accuracy of such information, it accepts no liability for any loss (however
caused) sustained as a result of any error or omission in the same.

0.9 Security Risk Assessment

Security risks have been assessed and it is considered that there are no security risks relating specifically to
this document.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEVIAPP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 11 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
1 Introduction
1.1 Document Overview
This document describes the operational requirements of the DRS application. The document
also describes the procedures for supporting and tuning the application.
ETU Transactions are considered, for the purposes of this document, to be a subset of Network
Banking transactions. The DRS is not performing any ETU or NSI specific functionality.
Like other host systems, the DRS application has been designed to fail-over from one data centre
to the fallback data centre without the need for operator intervention. The restart which requires
an operator intervention can be done on the fall-over data centre.
DRS application performs two main functions during a business day:
1. Provide a high throughput Reconciliation Service handling Debit Card, and Network Banking
transactions in large volumes.
2. Provide an Online Database for 91 (configurable) days to support the Reconciliation Reports
and the Online Query and Resolution System.
The database schema and application modules that primarily deal with the first function have
been designed to provide high throughput and make use of parallelism in processing.
The schema objects and modules (batch and online) that facilitate the second function have been
designed to meet the query requirements with quickest response time.
Most DRS jobs that run as a part of the Network Banking and Debit Card TWS Schedules make
use of checkpoints. These checkpoints are created/maintained in the database and offer the
following benefits:
e Minimise the work that needs to be re-done in the event of fail-over from one data centre
to the other.
* Prevent duplicate report files being produced for the report clients (MSU/Audit/TIP
(POLMI)).
e Avoid re-creating transient objects and data in case of a re-start.
The DRS TWS schedule must be run once for each calendar day’. DRS records the Current
Working Day in the database in order to ensure that a process is not run twice or not skipped in
the event of fail-over from one data centre to the other.
' ETS schedule items where distinct from NBS are included in the NBS schedule
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 12 of 114
FUJ00234962
FUJ00234962

DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

The document provides the following appendices for quick reference:
Appendix A — Network Banking TWS Schedule

Appendix B — Debit Card TWS Schedule

Appendix C — Tablespaces and Raw Volumes

Appendix D — DRS Tables

Appendix E — DRS Exceptions

Appendix F — DRS Archiving Table Mapping

Appendix G — DRS File Housekeeping Parameters

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED PageNo: 13 0f 114
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

1.2. DRS Data Flow Diagram

Audit Transactions to Transactions to POL
Server and from DCSM. and from TES
vw ry v
° C2 Status! C40, C4,D,S So
Audt 02 Des oes C2 nwa Reports cas

Workstation eeeeetI DRS

‘Accounting weeks
Client Info. cid
y DCs & NWB

Transactions from

RDDS Branch Database

The C12 transaction parts are input into DRS database by a batch process that runs once per
day on the Branch Database.

DCS C2 transaction parts are output to the MA through Agents using a file interface. NBS C2
transaction parts are copied from the DRS by the TES Host application over a database link.

The C112 transaction parts are input into DRS from TPS over a unique database link from DRS
to TPS database The DRS requires financial C112 transaction parts only, not Balance Enquiry's
or PIN changes. Furthermore a list of Non Polled Offices and TIP (POLMI) receipted Cash
Account Lines are also input into DRS from TPS. It is believed that this data was required
historically simply to transfer the Cash Account Period to DRS. With the replacement of the Cash
Account with the BTS (Branch Trading Statement), this flow I not required. Also, at HNG-X there
will be no non-polled offices and therefore the entire feed from TPS appears to be redundant
(although still necessary as part of the DRS schedule).

NBS C4/D transaction parts are copied from the TES Host application over a database link.
These transactions are written directly into the DRS C4/D daily main and daily main exception
tables.

The Account Week and Client Information are input into DRS from RDDS. Again, the data is
copied over a unique database link from DRS to RDDS database.

The DRS produces a number of ASCII Text Reconciliation Reports which are both collected by
the SSC and also delivered to POL via PODG

The Network Banking and Debit Card transactions stored in DRS database are sent to the Audit
Server in Archive format.

The DRS Workstation accesses the DRS database for MSU On-line Queries.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 14 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide .
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

Within DRS Host the transaction parts C12, C4, D and S are first stored in XML format as
received from the Agents. The C112 transaction parts are copied directly from TPS transaction
table to DRS transaction table. Therefore, C112 transaction parts are not stored in XML format.
Next, the DRS Parse and Load Process parses, validates and loads the data into a set of Daily
Input tables. These tables are transient and are emptied every day. Any transaction parts which
fail the validation are stored in Daily Exceptions tables.
At S60 new functionality required the Receipt Date to be correctly set on DCS C4/D transaction
parts derived from HMS EMIS files. The full requirements are defined in Design Proposal
EF/DES/009 and implemented in schedule DRS_EFT_C4_RCPTD.
Finally, the DRS Match and Merge Process reads the Daily Input and Exceptions tables and
moves the matched and merged data into a permanent storage called DRS Main Store. The data
in DRS Main Store is kept for a configurable number of days currently set to 91 days.
All the Reconciliation Reports and MSU On-line Queries access data from DRS Main Store. The
Reconciliation Reports and MSU On-line Queries also make use of the reference data copied
from TPS and RDDS.
At S90, a new flag is introduced to C12 and C2 message parts to allow the agent payment file
generation process to distinguish Bureau transactions from sale transactions. Additionally, two
new transaction types will be introduced to support Bureau settlement. Further details of the S90
release changes are documented in HLD NB/HLD/026.
2 Installation
2.1 Environment Variables
All the DRS environment variable names and values are present in the “/home/drs/.vars” file.
When a DRS user logs in, all the variables are "exported" so that they become available to the
DRS executables.
The following table lists the name and values of all the environment variables used by DRS.
The “Accessed by” column in the table below indicates that this directory is accessed by another
application through NFS to move the data in and out of DRS. The details of the data access will
be specified in the IPDU Main Host Platform Specification or the relevant Application
Specification/User Guide.

Environment Variable Value Accessed by

ORACLE_HOME. <Path-of-the-Oracle-Home>

ORACLE_SID DRS

NWB_AUDIT_OUTPUT /bvnw01 /drs/trans/drsaudit AUDIT SERVER

NWB_MSU_OUTPUT /bvnw01 /drs/trans/drsmsu SSC SERVER

NWB_TIP_OUTPUT /bvnw01 /drs/trans/nwbtip PODG

NWB_NBE_INPUT /bvnw01 /drs/trans/nwbC4Din TWS NBE IN

NWB_SUPPORT_OUTPUT /bvnw01 /drs/trans/drssupport SSC ARCHIVE SERVER

NWB_ARCHIVE_OUTPUT /bvnw01 /drs/trans/drsarchive SSC ARCHIVE SERVER

NWB_EXPORT_LOG /bvnw01 /drs/trans/drsexplog SSC ARCHIVE SERVER

EFT_AUDIT_OUTPUT /bvnw01 /drs/trans/drsaudit AUDIT SERVER

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

CONFIDENCE)

© Copyright Fujitsu Services Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED PageNo: 15 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide ~
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Environment Variable Value Accessed by
EFT_FILE_AUDIT /bvnw01/drs/trans/dcpfileaudit AUDIT SERVER
EFT_MSU_OUTPUT /bvnw01 /drs/trans/drsmsu SSC SERVER/DCSM SERVER
EFT_TIP_LOUTPUT /bvnw01/drs/trans/efttip PODG
EFT_NBE_INPUT /bvnw01 /drs/trans/eftC4DSin DCSM SERVER
EFT_C2_INPUT /bynw01 /drs/trans/eftC2in DCSM SERVER
EFT_C2_OUTPUT /bvnw01 /drsitrans/eftC2out DCSM SERVER
EFT_SUPPORT_OUTPUT /bynw01 /drs/trans/drssupport SSC ARCHIVE SERVER
EFT_ARCHIVE_OUTPUT /bvnw01 /drs/trans/drsarchive SSC ARCHIVE SERVER
EFT_EXPORT_LOG /bvnw01/drs/trans/drsexplog SSC ARCHIVE SERVER
DRS_CONNECT_STR drs
DRS_PROC Japp_swidrs/c
DRS_SH /app_swidrs/sh
DRS_SQL Japp_swidrs/sql
DRS_C12_SUM_APP_LOG /bvnw01 /maestro/applog
EXCP_USER ORAEXCP/EXCP123
DATA_CENTRE_CHAR Ww
TZ GMTOBST —
4,M3.5.0/1:00:00,M10.5.0/2:00:00
NLS_DATE_FORMAT DD-MON-YYYY
NLS_LANG AMERICAN_UNITED
KINGDOM.WE8ISO8859P 1
LD_LIBRARY_PATH <Path-of-the-Oracle-
Home>ilib:/usr/lib:/opt/epcllib:/usr/i
nelude
PATH /bin:/ust/bin:<Path-of-Oracle-
Home>/bin:/app_swidrs/c:lapp_sw
Idrsish
2.2 Directories
Following table lists the directories for Network Banking and Debit Card. The table also shows the
minimum storage required on the file-system for these directories. The actual space allocated
could be more and will be set by the System Administrator [ISD].
Directory Name Owner Group Unix Mode I Live Size (in
Mbytes)
foracle/DRS/bdump oracle dba 750 100
Joracle/DRS/cdump oracle dba 750 100
Joracle/DRS/udump oracle dba 750 100
farchredo/DRS oracle dba 750 20000
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version. 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 16 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide ~
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Directory Name Owner Group Unix Mode I Live Size (in
Mbytes)
Jhomeldrs (Home directory common I drs pathway 770 180
to all 9 DRS Unix Users)
Ibvnw01/drs/trans/drsaudit drs pathway 770 1200
Joynw01/drs/trans/drsmsu drs pathway 770 6000
Ipvnw01/drs/trans/drssupport drs pathway 770 9000
Ibvnw01/drsitrans/drsarchive drs pathway 770 3000
Iovnw01/drs/trans/drsexplog drs pathway 770 200
Japp_swidrsic drs pathway 550 200
Japp_swidrs/sh drs pathway 550 10
lapp_swidrs/sql drs pathway 550 10
Idb_build/DRS oracle pathway 770 100
Ibvnw01/drs/trans/nwbtip drs pathway 770 5500
Ipvnw01/drs/trans/inwbC4Din drs pathway 770 8000
Jovnw01/drs/trans/efttip drs pathway 770 600
Ibvnw01/drs/trans/eftC4DSin drs pathway 770 1500
Ipvnw0t/drs/trans/eftC2in drs pathway 770 200
/bvnw0 1/drs/trans/eftC2out drs pathway 770 1000
Ipvnw01/drs/trans/depfileaudit drs pathway 770 1500
2.3 Unix Users
The following Unix users are used by DRS Application for Network Banking and Debit Card:
Unix User Name Group Home Profile
oracle dba /homeloracle Thome/oracle/. profile
drs pathway Jhomeldrs Thomeldrs/.profile
drsnwb pathway Thomeldrs thomeldrs/ profile
drsnwb1 pathway /homeldrs Ihomeldrs/.profile
drsnwb2 pathway Jhomeldrs Thomeldrs/.profile
drsnwb3 pathway Jhomeldrs Thomeldrs/.profile
drsnwb4 pathway Jhomeldrs Ihomeldrs/.profile
drsnwb5 pathway Thomeldrs /homeldrs/.profile
drsnwb6 pathway Thomeldrs /nomeldrs/.profile
drsnwb7 pathway /homeldrs /homeldrs/.profile
drsnwb8 pathway Jhomeldrs Thomeldrs/.profile
drseft pathway Jhomeldrs Ihomeldrs/.profile
drseft1 pathway Thomeldrs Ihomeldrs/_profile
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version. 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 17 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide ~
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Unix User Name Group Home Profile
drseft2 pathway /homeldrs /home/drs/.profile
drseft3 pathway Jhomeldrs Thomeldrs/.profile
drseftd pathway Thomeldrs Thomeldrs/ profile
drseft5 pathway Jhomeldrs Ihomeldrs/.profile
drsefté pathway Jhomeldrs Ihomeldrs/.profile
drseft7 pathway Jhomefdrs thomeldrs/.profile
drseft8 pathway Jhomeldrs Thomeldrs/.profile
2.4 Oracle Tablespaces and Raw Volumes
The details of storage space allocated to DRS database for both Network Banking and Debit
Card are present in Appendix C — Tablespaces and Raw Volumes.
2.5 Database Roles and Users
2.5.1 Roles
DRS has following Oracle roles which are used for both Network Banking and Debit Card:
Role Name Roles Granted I System Privs Description
Granted
ALT_MAIN_STO Role has been granted to DRS-Host users
RE “OPS$DRSNWB” and "OPS$DRSEFT" in order to allow
them to add/drop the partitions of /— tables
DRS_RX_NWB_MAIN_STORE and
DRS_RX_EFT_MAIN_STORE
APPSUP CONNECT All System privileges I Role has been defined for use by ISD Support which will
RESOURCE belong to the DBA I act as first line support team for the DRS Application
role.
AUDITOR MONITOR Role defined for use by Internal/External auditors of the
system
BRDB_EFTUSER I CONNECT Granted to DRSBRDB interface user to allow C12 insert
Ss for EFT.
BRDB_NWBUSE I CONNECT Granted to DRSBRDB interface user to allow C12 insert
RS for NWB.
DB_MONITOR CONNECT Select Any Table Role has been defined for use by ISD Support which will
act as first line support team for the DRS Application
DRS_BATCH CONNECT Create Procedure Role is used all DRS batch users. It has been granted to
users “OPS$DRSNWB", _ “OPS$DRSNWB‘...8",
RESOURCE Select Any Table I OPS$DRSEFT and OPSSDRSEFT1...8.
Insert Any Table
Create Session
Create Public
‘Synonym
Update Any Table
Delete Any Table
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 18 of 114
FUJITSU

FUJ00234962

FUJ00234962

DRS Host Support Guide
FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)
Role Name Roles Granted I System Privs Description
Granted
Drop Public
Synonym

Create Database
Link

Create Sequence

Create Public
Database link

Create Synonym

Drop Public
Database Link

Create Table
Create View

Select Any
Sequence

DRS_EXCEPTIO
NS

CONNECT
RESOURCE

Role has been granted to user “ORAEXCP” to enable it to
log an operational exception

MONITOR

Select Any Table

Role made available for all users that require query-only
access to the system

MSU.

CONNECT
RESOURCE

Role will be been granted to DRS Workstation users. in
order to enable them to access the DRS Database. The
DRS Workstation users will be created on demand.

SECURITY_MAN
AGER

Alter User
Drop User

Grant Any Role
Select Any Table
Create User

Role has been defined for use by support staff who are
authorised to administer support users and to investigate
security breaches

ssc

MONITOR

Role has been defined for use by SSC (EDSC) Support
which will act as third line support team for the DRS
Application

TES_USERS

Role is used by the TES copy processes and TES Query
applications and has been granted to user “DRSTES” to
allow the processes to extract parsed [C2] messages. This
role has got the object privileges necessary to read [C2]
messages from DRS database.

TS

Role is used by the NBS [C12] agents and has been
granted to _ users. “TMS _NWB_USER” and
"TMS_EFT_USER' to allow the agents fo call the DRS-
interface to transfer [C12] XML records. This role has got
the object privileges necessary to harvest C12 messages
into DRS database.

UNXADM

CONNECT
RESOURCE
DBA

Role has been defined for use by ISD Support which will
act as first line support team for the DRS Application

2.5.2 Oracle Users

DRS has following Oracle Users which are used for both Network Banking and Debit Card:

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date 30-Mar-2020

STORED Page No: 19 of 114
FUJITSU

DRS Host Support Guide

FUJ00234962

FUJ00234962

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)
User Name Default Temp I Roles Granted Privs __I Description
Tablespace I Table Granted
space
DRSBRDB USER_TAB I TEMP I BRDB_EFTUSERS Used by BRDB to push C12 into DRS
LESPACE BRDB_NWBUSERS over a database link.
DRSEFTAGENT I USER_TAB I TEMP I CONNECT User owns the PL/SQL package
LESPACE interface used by the Horizon NBS
RESOURCE Agents for transferring [C12] XML for
DCP to DRS.
DRSNWBAGENT I USER_TAB I TEMP I CONNECT User owns the PLISQL package
LESPACE interface used by the Horizon NBS
RESOURCE Agents for transferring [C12] XML for
NWB to DRS
DRSTES USER_TAB I TEMP I CONNECT Used by the TES copy process to
PA RS Ci!
LESPACE TES_USERS access the DRS C2 tables
OPSSDRS USER_TAB I TEMP I DRS BATCH Owns the DRS schema. Has been
LESPACE granted the DBA role in order to allow
the build to create objects in all user
tablespaces and to allow executing jobs
that perform _ purge/housekeeping
functions
OPSSDRSEFT I USER_TAB I TEMP I DRS_BATCH Used to execute single instance jobs
LESPACE ALT MAIN STORE including Main-Store parttion creation
OPSSDRSEFT! I USER_TAB I DRS_ I DRS BATCH Used to execute the multiple instance
8 LESPACE I TEMP jobs for Network Banking/Debit Card.
4..8
OPS$DRSNWB I USER_TAB I TEMP I DRS_BATCH Used to execute single instance jobs
LESPACE including Main-Store partition creation
ALT_MAIN_STORE for Network Banking
OPSSDRSNWB1 I USER_TAB I DRS_ I DRS_BATCH Used to execute the multiple instance
8 LESPACE I TEMP jobs for Network Banking
1..8
OPS$MET_DRS I USER_TAB I TEMP Select I Used by the Metron performance
LESPACE Any monitoring tool to gather database
Table I statistics
ORAEXCP USER_TAB I TEMP I DRS_EXCEPTIONS User is used to connect to the DRS
LESPACE database via a concurrent connection in
order to log an operational exception
$SC_TOOLS USER_TAB I TEMP I SSC Create I Used by SSC monitoring tools (e.g
LESPACE session I HORIce)
TMS_EFT_USER I USER_TAB I TEMP I CONNECT Used by the Horizon NBS Agent/s to
LESPACE connect to the DRS database for
RESOURCE transferring [C12] XML for DCP via the
PL/SQL package interface to DRS.
TMS_NWB_USE I USER_TAB I TEMP I CONNECT Used by the Horizon NBS Agent/s to
R LESPACE connect to the DRS database for
RESOURCE transferring [C12] XML for NWB via the
PL/SQL package interface to DRS.

2.5.3 DRS Workstation Users

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date 30-Mar-2020

STORED

PageNo: 20 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

DRS Workstation users will be created on demand as per Access Control Policy (RS/POL/003).

The DRS Workstation users include the MSU or SSC users who will be accessing the DRS

database using DRS Workstation Application and one or more DRS Workstation Security

Manager users who will be creating and managing DRS Workstation MSU and SSC users.

2.5.3.1 DRS Workstation Security Manager Setup

The procedure for DRS Workstation Security Manager user setup is as follows:

« MSU/SSC will fill the application form as defined in SVM/SEC/PRO/0006 (Application for
Access to the Live Network) to create a new Unix user account on the Host as per the
following details:

User Name: As per SVM/SEC/PRO/0006

User Description: DRS Workstation Security Manager
User Home Directory: /home/drs

Unix Profile: /home/drs/.profile

User Group: pathway

e Host Administrator/DBA (ISD) will create a Unix user account. Also, they will create an Oracle
account (OPS$<Unix User Name>) in the DRS database. The Oracle account will be
identified "externally". That is, no explicit password will be assigned to the Oracle account.

e Host Administrator/DBA (ISD) will grant SECURITY_MANAGER role to the newly created
Oracle account. The SECURITY_MANAGER role already exists in the DRS database.

For example, the SQL commands to create an Oracle user account for the Unix user "arrism" and

grant the required role are:

(Connect to DRS database as the Oracle user "sys" or a user with DBA privileges)
SQL> create user ops$arrism identified externally

default tablespace USER_TABLESPACE temporary tablespace TEMP;

SQL> grant SECURITY_MANAGER to ops$arrism;

2.5.3.2 DRS Workstation User Account Setup

The procedure for DRS Workstation user account setup is as follows:

« MSU/SSC will fill the application form as defined in SVM/SEC/PRO/0006 (Application for
Access to the Live Network) to create a new Oracle account in the DRS database.

e The DRS Workstation Security Manager will create the DRS Workstation user account by
running a Unix shell script. The script will also create the necessary Oracle synonyms and
grant user the privileges to access the DRS database.

e The Security Manager will confirm to user that account has been created along with
password to use for first logon (the user will automatically be forced to change this).

The steps required by the Security Manager to create a DRS Workstation user are as follows:

e Login to the Host as Security Manager Unix user.

e Execute the following command on the Unix prompt (the shell script is present in the directory
“/app_sw/drs/sh" but the directory has been included in the PATH):
create_drs_workstation_user.sh <Oracle_User_Name> <Oracle_User_Password>

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 21 of 114
DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

Where the <Oracle_User_Name>
- must start with the letters DRSWKSNWB for Network Banking users and
DRSWKSEFT for Debit Card Project users.
- can be up to 30 characters long and should contain only letters and numbers.
The <Oracle_User_Password>
- must be at least 6 chars long.
- must be a mixture of alphanumeric characters i.e. a mixture of letters and numbers
(must contain at least 1 char in the range a-z,A-Z and 1 char in the range 0-9).
- must not have two consecutive characters the same.
- can not be the same as the username.

The successful execution of the script displays a number of messages on the standard output.
The exit code of the shell script must be 0 (After running the script, check the exit code using the
command echo $7).

2.5.4. DRS Workstation User Account Closure
The procedure for DRS Workstation user account closure is as follows:
e MSU/SSC will fill in the account closure application form as defined in SVM/SEC/PRO/0006.
e ISD will lock the user account using the following commands:
(Login to the Host as Security Manager Unix user)

sqiplus /

SQL> alter user <Oracle_User_Name> account lock;

SQL> quit;
2.5.5 DRS Workstation User Account Unlocking

The DRS will lock MSU/SSC Oracle user accounts following 3 unsuccessful logon attempts. In
the event of this

¢ Call will be raised with ISD.

e ISD will unlock the account. If the password has been forgotten, it will be reset and the
account status will be set to "password expired"(to force password change on first use). The
procedure for unlocking the account and/or resetting the password follows:

(Login to the Host as Security Manager Unix user)
sqlplus /
SQL> alter user <Oracle_User_Name> account unlock;
SQL> alter user <Oracle_User_Name> identified by <Temporary_Password>;
SQL> alter user <Oracle_User_Name> password expire;
SQL> quit;

e Confirmation will be sent by ISD to the user that the account has been unlocked along with
temporary password to use (the user will automatically be forced to change this at the first
logon).

3 TWS Resources

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED PageNo: 22 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide .
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
No TWS resources have been explicitly defined in the DRS Network Banking and Debit Card
project schedules.
4 Transaction Volumes and Database Storage
Capacity

This section has been included only for reference and to provide a brief description of the
expected data volume and the method used to estimate the database storage required. The
details of the current and the estimated transaction volumes are available in PA/PER/033. The
details of the sizing analysis for the DRS database are available in DES/APP/HLD/0108.
As described in DES/APP/HLD/0108, the DRS database can handle Phase-2 ‘Design-Limit’
volumes of 4.45 million (combined) Network Banking, Debit Card and Electronic Top-Up
transactions. Further, to handle situations where all the transactions for a day are not harvested
until the following day, i.e., two days of transactions are harvested on a single day, the DRS
tables have been sized to handle up to 8.6 million transactions. Note: At HNG-X, the non-
harvesting of transactions is not possible since the TWS Schedule dependencies will not allow it.
The storage required for the DRS Main Store table, which keeps the data online for up to 91
days, has been estimated as follows:
Measure Value
Peak daily transactions (Contract Limit) 3,711,000
Peak daily transactions (Design Limit) 4,445,000
Number of Days for which the data is stored 91 Days
Average Main Store record size 460 bytes
Maximum Main Store record Size 767 bytes
Database Storage required for one day considering average daily transaction 3,711,000 * 767
volumes where each record is of maximum size

= 2.65GB
Storage allocated at BI3 for one day's Main Store data 2000MB
Additional Storage required input/output, Report tables and indexes 136GB
Total Database size considering peak daily transaction volumes 2000MB * 91 days +

136GB

~314GB
5 Process Failure and Recovery
DRS Host processes can fail due to Oracle, Application or System errors. The various types of
error conditions leading to process failure and the possible recovery actions are common for most
processes and are listed below:
5.1 Automatic re-run by TWS
In some cases, if a process instance fails a recovery job is automatically started by TWS, which
effectively reruns the process instance once.
For example, TWS reruns a failed instance of C12 Parser. The auto rerun of an instance is done
only once. Subsequent failures on the same instance require manual intervention.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 23 of 114
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

5.2 Failures due to Oracle Error

In case of Oracle failures such as ‘Object does not exist’ or ‘Insufficient Oracle privileges’ or
‘Insufficient Rollback segments’ or ‘Unable to access database links’ and others, an Operational
Exception is logged in the DRS Operational Exceptions table along with the SQL statement that
caused the failure.

Please refer to Oracle message manual (or “oerr ORA ####” from a command prompt) for advice
on the appropriate recovery action for all such failures.

5.3. Failures due to Application and System Error

In case of Application errors such as invalid reference data or reference data does not exist, an
exception to indicate process failure is raised and recorded in the DRS Operational Exceptions
table which would be highlighted IBM Tivoli Monitoring.

In case of System errors such as errors related to the Operating System please refer to the
Operating System manual for advice on the appropriate recovery.

All DRS processes can be restarted after rectifying the cause of failure.

6 Network Banking Schedule Details

The Network Banking TWS Schedule includes network banking specific jobs and the jobs which
are common (like Reference Data Copy) between Network Banking and Debit Card.

For each job in the schedule, a brief description is included along with implementation details, Job
dependencies (if any) and Rerun action in case of a failure.

Implementation includes the Job name as used in the TWS Schedule. Full details of the Jobs
including the command-line parameters being passed can be found in DES/APP/HLD/0091

6.1 Schedule M_DB_SRV#DRS_NWB_SOD

This is the start of the DRS Network Banking schedule. It will start after the database restart on
completion of cold backup at around 8am.

6.1.1 Dependencies

Follows successful completion of the DRS Network Banking schedule for the previous logical
processing day (implemented via a dependency on existence of the
DRS_NWB_BATCH_COMPLETE.FLAG).

Precedes schedules DRS_RDDS_EXTRACT, DRS_TIDY_ORA, DRS_NWB_ANALYZE,
DRS_NWB_C12_PARS, DRS_ETU_CALD.

6.1.2. Process DRSC350

Process DRSC350 runs at the start of the DRS Network banking day to set the working day for
the schedule, create the Main Store (DRS_RX_NWB_MAIN_STORE) partition for that working
day and re-set various flags.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 24 of 114
DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

The DRS working day is controlled by two logical dates that are stored as “DRS SYSTEM DATE”
and “PARTITION RECEIPT DATE” system parameters for the Application Type "NWB" in the
database. These dates normally correspond to the System Date on the Rig with the exception of
a post fail-over catch-up situation where the dates could lag by one or more days.

DRSC350 will also perform partition maintenance on the NBS C2 tables. New partitions are
created and old partitions dropped. The DRS_NRT_INTERFACE_METADATA table is updated to
reflect the partition state of each C2 output table.

6.1.2.1 Implementation
Implemented in the M_DB_SRV#DRSC350N job (postfix

stands for Network Banking).

6.1.2.2 Job Dependencies

This job is dependent on the TWS resource DRS350LK. This is necessary so that DRSC350N
and DRSC350E do not run at the same time. This resource has a value of 1 and will hold up the
running of DRSC350N until it is available. DRSC350E has the same dependency.

6.1.2.3 Rerun action

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery

Additionally, a migration specific Application error could occur in the form of process failure when
run for the first time on the Rig. The reason for such an error could be missing values for “DRS
SYSTEM DATE” and “PARTITION RECEIPT DATE” system parameters in
DRS_SYSTEM_PARAMETERS table. These parameters are created with NULL values as a part
of DRS database and schema build and must be set by ISD to the value of Unix System Date one
day prior to running the schedule for the first time. The details of how to set these dates in

DRS_SYSTEM_PARAMETERS table are available in the DRS Delivery Handover Note.
The process can be restarted after rectifying the cause of failure.

Note that it is possible due to the unavoidable implicit database commit performed when
adding/dropping table partitions that, in some esoteric failure scenarios, the partition metadata will
be out of sync with the actual partitions. In this situation, re-running the SOD process will
potentially fail.

In this scenario it will be necessary to confirm whether the metadata/partitions are inconsistent by
running a script provided by development.

If the partitions/metadata are inconsistent it will be necessary to manipulate either to remedy the
situation. Given that the remedial activity will be dependent on a number of variables including
whether any data has been written to the new partitions etc, a call should be raised with 4'" line
support.

In some situations, typically in test, it is desirable to run DRSC350 more than once in a calendar
day. The default (build) value of the PROCESS _DAY_MULTIPLE_RUNS_YN flag in the
DRS_PROCESSES table for the DRSC350 process is ‘N’ so would prevent this. Therefore the
PROCESS_DAY_MULTIPLE_RUNS_YN flag should be changed to ‘Y’ to allow this if required.

WARNING - This should only be done in Live at the guidance of development or support.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED PageNo: 25 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
6.2 Schedule M_DB_SRV#DRS_TIDY_ORA
The schedule runs a script to tidy files associated with the Oracle database. This activity is not
solely applicable to Network Banking, but for convenience is scheduled to run after the Network
Banking Start Of Day schedule.
6.2.1. Dependencies
Follows successful completion of the schedule DRS_NWB_SOD.
6.2.2. Process HousekeepOrafiles.sh
This process housekeeps a number of log and dump files associated with the Oracle database.
6.2.2.1 Implementation
Implemented in M_DB_SRV#DRS_ORA_TIDY
6.2.2.2 Job Dependencies
None
6.3 Schedule M_DB_SRV#DRS_ETU_C4LD
The schedule runs DRSC305 to load the ETU file containing C4/D messages into the NWB C4SD
input table and then DRSC306 to parse the C4/D messages into the C4/D daily main tables.
6.3.1 Dependencies
Follows successful completion of the schedules DRS_NWB_SOD and
DRS_ETU_BATCH_COMPLETE.FLAG.
6.3.2 Process DRSC305
This process reads [C4/D] XML records from a data-file whose absolute filename is passed to it
on command-line by TWS and loads them into the FTMS_RX_NWB_C4SbD input table.
The input data-file/s are read from directory $NWB_NBE_INPUT and are renamed to change
their extension to lowercase once they have been successfully processed.
6.3.2.1 Implementation
Implemented in M_DB_SRV#DRSC305N where the postfix "N" stands for NWB.
6.3.2.2 Job Dependencies
None
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 26 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
6.3.3 Process DRSC306
This process sets the value of DRS system parameter “C4SD FILE LOAD COMPLETE” for
Application Type "NWB" to ‘Y' to indicate that all the DRS C4/S/D files have been successfully
loaded. Once this flag is set, all instances of DRSC302 (see section 6.13.2) exit after processing
the last set of C4/S/D input records.
6.3.3.1 Implementation
Implemented in M_DB_SRV#DRSC306N.
6.3.3.2 Job Dependencies
Depends on successful completion of DRSC305N where the postfix “N’ stands for NWB.
6.3.3.3 Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.4 Schedule M_DB_SRV#DRS_NWB_ANALYZE
The schedule runs a job every day to gather the statistics for specified DRS database objects.
The statistics are used by Oracle optimiser to improve the query performance.
6.4.1 Dependencies
Follows successful completion of the M_DB_SRV#DRS_NWB_SOD.
Precedes DRS_NWB_SOB
6.4.2 Process DRSC368
The process reads the table DRS_ANALYZED_OBJECTS for the details of DRS database
objects to be "ANALYZED". It then runs DBMS_STATS package or SQL command "ANALYZE"
to gather and store statistics on the objects specified. This is required whenever a table's data
content changes or a partition is dropped as part of Start of Day. In this way Workstation Query
and Report Generation performance can be optimised.
6.4.2.1 Job Dependencies
None.
6.4.2.2 Implementation
Implemented in the M_DB_SRV#DRSC368N_1 job (the postfix "N" stands for Network Banking).
6.4.2.3 Rerun action
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED PageNo: 27 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.5 Schedule M_DB_SRV#DRS_RDDS_EXTRACT
This schedule runs DRSC364, which copies RDDS reference data for Routing Gateways and
Accounting Weeks into DRS.
The schedule is common between Network Banking and Debit Card.
6.5.1 Dependencies
This schedule follows the successful completion of the schedule DRS_NWB_SOD and
DRS_EFT_SOD. Requires RDDSLOCK.
6.5.2 Process DRSC364
Process DRSC364 refreshes accounting weeks (RDDS_ACCOUNTING_WEEKS), routing
gateways (RDDS_ROUTING_GATEWAYS) tables and clients (RDDS_CLIENTS) using
corresponding tables/views in RDDS-Host system. The RDDS objects are accessed via a pre-
defined database link. The RDDS table names from where the data is copied from are
DRS_ACCOUNTING_WEEKS, DRS_ROUTING_GATEWAYS and DRS_CLIENTS respectively.
6.5.2.1 Implementation
Implemented in M_DB_SRV#DRSC364C_NOPAGE (the postfix "C" stands for Common).
6.5.2.2 Job Dependencies
None.
6.5.2.3. Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery. The exception to the rerun action described in the common section is that
TWS will continue processing in case of a process failure. No page message will be sent to first-
line support. Operational exception/s will be logged and they can be used for error analysis and
resolution.
6.6 Schedule M_DB_SRV#DRS_NWB_C12_PARS
This schedule runs multiple instances of the DRS [C12] parse and load process. The schedule
becomes active after completion of BRDB_DRS_COMPL
6.6.1 Dependencies
Follows successful completion of DRS Network Banking schedule DRS_NWB_SOD and
BRDB_DRS_COMPL
Precedes schedule DRS_NWB_MS_NIGHT
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 28 of 114
DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

6.6.2 Process DRSC301

This process reads [C12] XML records from TMS_RX_NWB_C12 (C12-Input), parses and loads
them into the DRS_RX_NWB_C12 and DRS_RX_NWB_C12_EXCP tables.

TWS invokes eight instances of DRSC301 at the start of the schedule.

Introduced at S75, the DRSC301 instances will write NBX transactions (as derived from Logical
Fl) into a set of partitioned C2 tables. These tables are used to copy C2 transactions in the TES.

The function processes all outstanding data in TMS_RX_NWB_C12.

6.6.2.1 Implementation

Implemented in the M_DB_SRV#DRSC301N_1...8 jobs (the postfix "N" stands for Network
Banking).

6.6.2.2 Job Dependencies
None

6.6.2.3 Rerun action

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery. As listed in this section, if an instance of DRSC301 fails, TWS
automatically reruns the failed instance once. If it fails on the rerun, TWS does not attempt any
further automatic reruns for that instance. Any failures would result in operational exceptions
being logged which can be used for fault analysis/resolution.

6.7 Schedule M_DB_SRV#DRS_NWB_SOB

This schedule runs the first job of the DRS batch overnight for Network Banking which is Start of
the Batch overnight.

6.7.1. Dependencies
Follows successful completion of DRS_NWB_ANALYZE.

6.7.2. Process DRSC353

This job runs at the start of the DRS batch overnight process at 20:00.

It sets the value of system parameter “BATCH JOB STARTED?” for Application Type "NWB" to “Y”
to inform the DRS Workstation that the batch overnight has started and all subsequent
connections should be read-only. It also ‘kills’ the SQL*Net connections made by DRS
workstation users (all Oracle usernames starting with “DRSWKS’) to the database using the SQL
statement “ALTER SYSTEM DISCONNECT SESSION...”

6.7.2.1 Implementation

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED PageNo: 29 0f 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Implemented in job M_DB_SRV#DRSC353N (the postfix "N" stands for Network Banking).
6.7.2.2 Job Dependencies
None.
6.7.2.3. Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.8 Schedule M_DB_SRV#DRS_NWB_C4_PARSE
This schedule runs multiple instances of the DRS [C4/D] parse and load process.
6.8.1 Dependencies
Follows successful completion of schedule DRS_ETU_C4LD.DRSC305N.
Precedes schedule DRS_NWB_MS_NIGHT, TES_LINK_REC_RUN, TES_CAPO_REC_RUN
and TES_AL_REC_RUN
6.8.2 Process DRSC302
This process reads [C4 /D] XML records from FTMS_RX_NWB_C4SD (C4D-Input), parses and
loads them into the DRS_RX_NWB_{C4ID} and DRS_RX_NWB_{C4ID}_EXCP tables
respectively.
TWS invokes eight instances of DRSC302 at the start of the schedule.
The process polls the C12-Input table at periodic intervals after a pause whose duration in
seconds is taken from the value of “C4SD PAUSE WAIT LIMIT” system parameter.
The process execution is controlled by the value of system parameter “C4SD FILE LOAD
COMPLETE” for Application Type "NWB". The parameter value is set to “N” by process
DRSC306 on successful completion of all C4SD file load jobs and this would result in all eight
instances of DRSC302 to exit after processing the last let of records from the C4/D input table.
6.8.2.1 Implementation
Implemented in the M_DB_SRV#DRSC302N_NOPAGE_1...8 jobs (the postfix "N" stands for
Network Banking).
6.8.2.2 Job Dependencies
None
6.8.2.3 Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery. As listed in this section, if an instance of DRSC302 fails, TWS
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 30 of 114
FUJ00234962

FUJ00234962

DRS Host Support Guide

FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
automatically reruns the failed instance once. If it fails on the rerun, TWS does not attempt any
further automatic reruns for that instance. Any failures would result in operational exceptions
being logged, which can be used for fault analysis/resolution.
6.9 Schedule M_DB_SRV#DRS_NWB_MS_NIGHT
This schedule runs DRS Main Store Processing (DRSC310) as "batch-overnight" to process all
the transaction parts [C12/C112/C4/D] received in DRS since the last run of the schedule. The
same process DRSC310 is also used as part of the daily schedule. See section 6.8 for details.
6.9.1 Dependencies
This schedule follows the successful completion of the schedule DRS_NWB_C4_PARSE,
DRS_NWB_SOB, TES_AL_REC_RUN, TES_CAPO_REC_RUN,
TES_LINK_FILEMON.TES_LREC_STOPLOAD, DRS_NWB_C12_PARS.
This schedule precedes the schedule DRS_NWB_MS_EXCPTN.
6.9.2 Process DRSC310 [NIGHT]
The ‘NIGHT’ run of the DRSC310 process picks up all the transaction parts for processing which
have Receipt Date less than or equal to the current Partition Receipt Date. The value of current
Partition Receipt Date is derived from DRS System Parameter "PARTITION RECEIPT DATE" for
the Application Type "NWB" [refer to System Parameters for details].
This process reads the transaction parts [C12/C112/C4/S/D] from Daily Input tables
[DRS_RX_NWB_C12, DRS_RX_NWB_C112, DRS_RX_NWB_C4, DRS_RX_NWB_D and
DRS_RX_NWB_S] in the order of their arrival sequence in DRS. No [S] transactions are
expected I for Network Banking. The transaction parts are matched on necessary elements and
the State Information is derived and set in chronological order once for the arrival of each
transaction part. The resulting transaction record containing all the available transaction parts and
the State Information is then inserted into DRS_RX_NWB_MAIN_STORE table. The process also
inserts a copy of Main Store record into DRS_I RX NWB_MAIN_STORE_UPDATES table where
the transaction part(s) had the Receipt Date less than the current Partition Receipt Date to
facilitate fast reporting.
Multiple instances of the process can be run in parallel. Each instance can process a set number
of Daily Input table partitions.
6.9.2.1 Implementation
This process has been implemented in M_DB_SRV#DRSC310NN_x, where x is the instance
number ranging from 1 to 8 and the postfix "NN" stands for Night Network Banking.
6.9.2.2 Job Dependencies
None
6.9.2.3 Rerun action
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 31 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.10 Schedule M_DB_SRV#DRS_NWB_MS_EXCPTN
This schedule runs DRSC311, which copies records from the daily exception tables into the
corresponding main store exception tables.
6.10.1 Dependencies
This schedule follows the successful completion of the schedule DRS_NWB_MS_NIGHT.
Precedes DRS_RDDS_EXTRACT. Also precedes DRS_NWB_REP_101 &
DRS_NWB_REP_102 but these dependencies are never exercised.
6.10.2 Process DRSC311
The purpose of this module is to merge those DRS Transaction parts [C112, C12, D, C4, S] that
are in exception with the corresponding DRS main exception tables. No [S] transactions are
expected for Network Banking.
Only one instance of the program must be run at any time. Multiple instances could result in
duplicate rows being inserted into the main exception tables.
All the transaction parts that have the value of Receipt Date less than or equal to the current
Partition Receipt Date are processed. The value of current Partition Receipt Date is derived from
DRS System Parameter "PARTITION RECEIPT DATE" for the Application Type "NWB". The
record is validated to check it exists in the Main Store (DRS_RX_NWB_MAIN_STORE) and the
current state of the transaction part in exception is derived or copied from the main store.
After a record has been successfully processed and inserted into the Exceptions Main table, the
PROCESSED_YN flag for the corresponding record in Daily Exceptions table is set to ‘Y’.
6.10.2.1 Implementation
Implemented in M_DB_SRV#DRSC311N (the postfix stands for Network Banking).
6.10.2.2 Job Dependencies
None
6.10.2.3. Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.11 DRS_RDDS_EXTRACTSchedule
M_DB_SRV#DRS_NWB_REP_101
This schedule contains jobs that generate the Network Banking NB101 report.
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 32 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
This Schedule is run daily after the DRS Main store processing and DRS Main exception merge
from daily exception tables.
6.11.1 Dependencies
Follows after successful completion of schedule DRS_NWB_MS_EXCPTN and
DRS_RDDS_EXTRACT
Precedes schedule DRS REP_000
6.11.2 Process DRSC322
The purpose of this DRS host program is to extract all C4 Transactions for each Routing Gateway
from DRS Main Store (DRS_RX_NWB_MAIN_STORE), Main Store Updates
(DRS_RX_NWB_MAIN_STORE_UPDATES) and C4 Exception Main table (DRS_RX_NW
B_C4_EXCP_MAIN) tables against each settlement date, received for the current Run date i.e.,
DRS Processing date. The extracted information is then populated onto the DRS NB101 Results
table (DRS_REP_NWB_RESULTS_NB101).
This program does not create any report files.
6.11.2.1 Job Dependencies
None
6.11.2.2 Implementation
Implemented in the M_DB_SRV#DRSC322N job (the postfix "N" stands for Network Banking).
6.11.2.3 Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.11.3 Process DRSC324
The purpose of this DRS host program is to Generate NB101 Reconciliation report for the current
Run date. Data is extracted from DRS_REP_NWB_RESULTS_NB101 table and written to the
report text files.
6.11.3.1 Job Dependencies
Follows successful completion of M_DB_SRV#DRSC322N.
6.11.3.2 Implementation
Implemented in the M_DB_SRV#DRSC324N job (the postfix "N" stands for Network Banking).
6.11.3.3 Rerun action
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 33 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.12 Schedule M_DB_SRV#DRS_NWB_REP_102
The generation of DRS Network Banking NB102 reconciliation report involve three functional
steps:
1. Population of Intermediate tables DRS_REP_NWB_STATE_TOTALS (process DRSC320).
2. Population of Result tables DRS_REP_NWB_RESULTS_NB102_1...12 (process DRSC323).
3. Producing the report text files on the Host operating system (process DRSC325).
Jobs in this schedule perform the above-mentioned three steps.
This Schedule is run daily after successful completion of NB101 Reconciliation report generation.
6.12.1 Dependencies
Follows after successful completion of schedule DRS_NWB_MS_EXCPTN and
DRS_RDDS_EXTRACT.
Precedes schedule DRS_REP_000.
6.12.2 Process DRSC320
The purpose of this DRS host program is to populate the DRS State Totals table
(DRS_REP_NWB_STATE_TOTALS) from the transactions held within the DRS Main store (for
current day's transactions), DRS Main Store Updates and the DRS Exception tables for NB102
reports.
This program does not create any report files.
6.12.2.1 Job Dependencies
None
6.12.2.2 Implementation
Implemented in the M_DB_SRV#DRSC32O0N job (the postfix N stands for Network Banking).
6.12.2.3. Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.12.3 Process DRSC323
The purpose of this DRS host program is to populate the 12 tables of DRS report NB102 results
(DRS_REP_NWB_RESULTS_NB102_1...12) where each table corresponds to a section of the
report.
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 34 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
To derive this information records from the DRS Main Store (DRS_RX_NWB_MAIN_STORE),
Exceptions Main tables (DRS_RX_NWB_{C12IC112IC4ISID}_ EXCP_MAIN) and the State totals
table (DRS_REP_NWB_STATE_TOTALS) is populated into DRS NB102 result tables. No [S]
transactions are expected for Network Banking.
For performance this process is run twelve times, once for each section to be produced. Sections
1, 6, 7 and 12 are run sequentially, then after these have finished execution, sections 2, 3, 4, 5, 8,
9, 10 and 11 are run in parallel.
Please note that sections do not take similar lengths of time to run. For instance sections 5 and
11 can take up to 30 to 40 minutes, while other sections may be over in a few seconds.
This program does not create any report files.
6.12.3.1 Job Dependencies
This Program DRSC323N follows after successful completion of DRS host program DRSC320N.
6.12.3.2 Implementation
Implemented in the M_DB_SRV#DRSC323N_x job. Where N is for Network Banking and x is the
section number.
6.12.3.3 Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.12.4 Process DRSC325
The purpose of this DRS host program is to Generate NB102 Reconciliation report for the current
Run Date. Data is extracted from DRS_REP_NWB_RESULTS_NB102_1...12 tables and written
to text files.
This program is scheduled to run daily.
6.12.4.1 Job Dependencies
This Program follows successful completion of all M_DB_SRV#DRSC323N_x jobs, where N is for
Network Banking and x is the value all the sections run in parallel in job DRSC323.
6.12.4.2_ Implementation
Implemented in the M_DB_SRV#DRSC325N job (the postfix N stands for Network Banking).
6.12.4.3 Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.13 Schedule M_DB_SRV#DRS_REP_000
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 35 0f 114
FUJ00234962
FUJ00234962

DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

This schedule runs DRS328C job which produces Nil Returns Report.

6.13.1 Dependencies

Follows after successful completion of schedule DRS_NWB_REP_101, DRS_NWB_REP_102,
DRS_EFT_REP_101 and DRS_EFT_REP_102.

Precedes schedule DRS_ADMIN.

6.13.2 Process DRSC328
The purpose of this DRS host program is to create the DRS Nil Return Report NBOOO.

This program displays reports produced for all routing gateways for the current run date. For
routing gateways where no transactions have been reported, a ‘[NIL RETURN] entry is displayed
on the report. Data is extracted from DRS_REP_FILE_REGISTER, DRS_REPORTS and
RDDS_ROUTING_GATEWAYS to be written to a text file.

6.13.2.1 Job Dependencies

None

6.13.2.2 Implementation
Implemented in the M_DB_SRV#DRSC328C job (where "C" stands for Common).

6.13.2.3. Rerun action

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.

6.14 Schedule M_DB_SRV#DRS_ADMIN

The schedule generates the Database statistics.

6.14.1 Dependencies
Follows successful completion of DRS_REP_000.
Precedes DRS_NWB_ADMIN and DRS_EFT_ADMIN

6.14.2 Script DRSX365

This Unix shell script generates Database statistics such as Oracle Tablespace usage, Extents
and Data segments available.

6.14.2.1 Job Dependencies

None

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 36 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
6.14.2.2 Implementation
Implemented in the M_DB_SRV#DRSX365C job (the postfix "C" stands for Common).
6.14.2.3. Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.15 Schedule M_DB_SRV#DRS_NWB_ADMIN
This is the Database housekeeping schedule. The schedule archives and purges data and
housekeeps file older than the pre-defined retention period.
6.15.1 Dependencies
Follows successful completion of DRS_ADMIN
Precedes schedule DRS_NWB_TRN_ACK
6.15.2 Process DRSC361
The purpose of this module is to Archive Control, Data and Report tables to Support and Audit
requirements and Archive/Purge Data and Report tables older than the Retention period for
Archive server. The archive files stored under Archive server are for future references. The old
data is cleared to make space for the new data. Entries from the table
DRS_ARCHIVED_TABLES are used for archive parameters and criteria. The records that go into
this table are also present in the form of a spreadsheet in Appendix F — DRS Archiving Table
Mapping.
This module uses Oracle Export/Import method to archive data as specified in the DRS High
Level Design DES/APP/HLD/0033
Only one instance of the program must be run at any time. Multiple instances at the same time
could result in corrupt export dump files being created.
If the data purge process fails due to the process not being able to get exclusive access to the
table to purge, an exception is raised and it continues to the next table. The next time the purge
process is run it will purge two days’ worth of data. Some of the tables (like the daily tables) can
only hold around three days’ worth of data, so three failures in a row will give problems.
6.15.2.1 Job Dependencies
None.
6.15.2.2 Implementation
Implemented in the M_DB_SRV#DRSC361N job (the postfix "N" stands for Network Banking).
6.15.2.3 Rerun action
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 37 of 114
FUJ00234962
FUJ00234962

DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.

6.15.3 Process DRSC368

Please refer to the section 6.4.2 for details of the process.

6.15.3.1 Job Dependencies
Follows the successful completion of M_DB_SRV#DRSC361N job.

6.15.3.2 Implementation

The job runs every day. Implemented in the M_DB_SRV#DRSC368N_3 job (the postfix "N"
stands for Network Banking).

6.15.3.3 Rerun action

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.

6.15.4 Script DRSX362

The purpose of this Unix shell script is to housekeep various input/output files. Entries from the
table DRS_FILES_TO_HOUSEKEEP are used as parameters for file deletion.

6.15.4.1 Job Dependencies
This job should follow after successful completion of the job DRSC361N.

6.15.4.2 Implementation
Implemented in the M_DB_SRV#DRSX362N job (the postfi:

" stands for Network Banking).

6.15.4.3 Rerun action

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.

6.16 Schedule M_DB_SRV#DRS_NWB_TRN_ACK

The schedule contains a job that checks for delivery status of report files by PODG

6.16.1 Dependencies
Follows after successful completion of Schedule DRS_NWB_ ADMIN
Precedes Schedule DRS_BACKUP, DRS_FS_BACKUP

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED PageNo:  380f 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
6.16.2 Process DRSC367
Report files created by DRS in the $NWB_TIP_OUTPUT (for Network Banking) directories are
transferred by PODG to POL.
Process DRSC367 harvests file receipt information by checking for report file delivery success in
the delivery receipt files. If found, it renames the files and updates the TIP (POLMI) Receipt date
in DRS_REP_FILE_REGISTER for the corresponding report file.
Since PODG never returns acknowledgement files then this process is redundant
6.16.2.1 Job Dependencies
None
6.16.2.2 Implementation
Implemented in the M_DB_SRV#DRSC367N job (the postfix "N" stands for Network Banking).
6.16.2.3 Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
6.17 Schedule M_DB_SRV#DRS_COMPLETE
This schedule contains a job that creates the Network Banking and Debit Card schedule
completion flags. These flags are used by TWS to determine successful logical completion of the
processing.
The schedule and job details have been provided by the TWS Development team.
6.17.1.1 Job Dependencies
DRS_BACKUP.DRS_DB_START, DRS_FS_BACKUP.DRSF_CLONE_SPLIT_S.
7 Debit Card Schedule Details
This section describes all the Schedules and Jobs listed in Appendix B — Debit Card TWS
Schedule. The Debit Card TWS Schedule includes just the Debit Card specific jobs and NOT the
jobs which are common (like Reference Data Copy) between Network Banking and Debit Card.
For each job in the schedule, a brief description is included along with implementation details, Job
dependencies (if any) and Rerun action in case of a failure.
Implementation includes the Job name as used in the TWS Schedule. Full details of the Jobs
including the command-line parameters being passed can be found in Appendix B — Debit Card
TWS Schedule.
7.1 Schedule M_DB_SRV#DRS_EFT_SOD
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 39 of 114
DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

This is the start of the DRS Debit Card schedule. It will start after the database restart on
completion of BCV Split at around 8am.

7.1.1. Dependencies

Follows successful completion of the DRS Debit Card schedule for the previous logical
processing day (implemented via a dependency on DRS_EFT_BATCH_COMPLETE.FLAG).

Precedes schedules DRS_RDDS_EXTRACT, DRS_EFT_ANALYZE, DRS_EFT_C12_PARS.

7.1.2 Process DRSC350

Process DRSC3650 runs at the start of the DRS Debit Card day to set the working day for the
schedule, create the Main Store (DRS_RX_EFT_MAIN_STORE) partition for that working day
and re-set various flags.

The DRS working day is controlled by two logical dates that are stored as ‘DRS SYSTEM DATE”
and “PARTITION RECEIPT DATE” system in the database. There are two sets of logical dates -
one for NWB and EFT each. These dates normally correspond to the System Date on the Rig
with the exception of a post fail-over catch-up situation where the dates could lag by one or more
days.

7.1.2.1 Implementation
Implemented in the M_DB_SRV#DRSC350E job (the postfix "E" stands for Debit Card/EFTPoS).

7.1.2.2 Job Dependencies

This job is dependent on the TWS resource DRS350LK. This is necessary so that DRSC350N
and DRSC350E do not run at the same time. This resource has a value of 1 and will hold up the
running of DRSC350E until it is available. DRSC350N has the same dependency.

7.1.2.3 Rerun action

The common process failure scenarios and rerun actions are described in the section 5-Process
Failure and Recovery.

Additionally, a migration specific Application error could occur in the form of process failure when
run for the first time on the Rig. The reason for such an error could be missing values for "DRS
SYSTEM DATE” and “PARTITION RECEIPT DATE” system parameters in
DRS_SYSTEM_PARAMETERS table. These parameters are created with NULL values as a part
of DRS database and schema build and must be set by ISD to the value of Unix System Date one
day prior to the running the BI3 schedule for the first time. The details of how to set these dates in
DRS_SYSTEM_PARAMETERS table are available in the DRS Delivery Handover Note.

The process can be restarted after rectifying the cause of failure.

Note that it is possible due to the unavoidable implicit database commit performed when
adding/dropping table partitions that, in some esoteric failure scenarios, the partition metadata will
be out of sync with the actual partitions. In this situation, re-running the SOD process will
potentially fail.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 40 of 114
FUJ00234962
FUJ00234962

oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

In this scenario it will be necessary to confirm whether the metadata/partitions are inconsistent by
running a script provided by development.

If the partitions/metadata are inconsistent it will be necessary to manipulate either to remedy the
situation. Given that the remedial activity will be dependent on a number of variables including
whether any data has been written to the new partitions etc, a call should be raised with 4" line
support.

In some situations, typically in test, it is desirable to run DRSC350 more than once in a calendar
day. The default (build) value of the PROCESS_DAY_MULTIPLE_RUNS_YN flag in the
DRS_PROCESSES table for the DRSC350 process is ‘N' so would prevent this. Therefore the
PROCESS_DAY_MULTIPLE_RUNS_YN flag should be changed to ‘Y’ to allow this if required.

WARNING - This should only be done in Live at the guidance of development or support.

7.2. Schedule M_DB_SRV#DRS_EFT_ANALYZE

The schedule runs a job every day to gather the statistics for specified DRS database objects.
The statistics are used by Oracle optimiser to improve the query performance.

7.2.1. Dependencies
Follows successful completion of the M_DB_SRV#DRS_EFT_SOD.
Precedes DRS_EFT_SOB

7.2.2 Process DRSC368

Refer to the section 6.3.2 for details of the process.

7.2.2.1 Job Dependencies

None.

7.2.2.2 Implementation

Implemented in the M_DB_SRV#DRSC368E_1 job (the postfix "E" stands for Debit
Card/EFTPoS).

7.2.2.3 Rerun action

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.

7.3 Schedule M_DB_SRV#DRS_EFT_C12_PARS

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 41 of 114
FUJ00234962
FUJ00234962

DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

This schedule runs multiple instances of the DRS [C12] parse and load process. The schedule
becomes active after completion of BRDB_DRS_COMPL and continues until all C12 data has
been processed.

7.3.1 Dependencies
Follows successful completion of DRS_EFT_SOD and BRDB_DRS_COMPL.
Precedes schedule DRS_PF_GEN, DRS_EFT_PF_SIM

7.3.2 Process DRSC301

This process reads [C12] XML records from TMS_RX_EFT_C12 (C12-Input), parses and loads
them into the DRS_RX_EFT_C12 and DRS_RX_EFT_C12_EXCP tables for Debit Card. TWS
invokes eight instances of DRSC301.

The process execution exists having processed all outstanding data in TMS_RX_EFT_C12.

7.3.2.1 Implementation

Implemented in the M_DB_SRV#DRSC301E_1...8 jobs (the postfix "E" stands for Debit
Card/EFTPoS).

7.3.2.2 Job Dependencies

None

7.3.2.3 Rerun action

The common process failure scenarios and rerun actions are described in the section 5-Process
Failure and Recovery.

7.4 Schedule M_DB_SRV#DRS_EFT_PF_GEN

This schedule runs the job to generate the Payment Files.

7.4.1. Dependencies

Follows successful completion of schedule DRS_EFT_C12_PARS. DRS_EFT_C12_PARS will
continue processing any outstanding data if there was a backlog in the C12 Input
(TMS_RX_EFT_C12) table before allowing this schedule to begin.

Precedes schedule DRS_EFT_C4_PARSE and DCM_H_PF_D.

7.4.2. Process DRSC307

The process extracts the contents of C2 Output (DRS_TX_EFT_C2) table into a data file
containing C2 XML messages. The data file is created in the directory defined by the environment
variable EFT_C2_OUTPUT.

The process extracts all C2 XML records from the C2 Output table where:

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED PageNo: 42 of 114
DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

e PROCESS_STATUS is set to "I" (Initial)
e ROUTING_GATEWAY is set to the third parameter passed

and writes these records to a data file in order of Service_Type, Merchant Number, Receipt Date
and Sequence number in the ascending order. Before writing each C2 XML record into the file,
the date, terminal id and transaction number will be extracted from the C2 message and used to
look up the same transaction on the NPS status table (TMS_RX_TXN_STATUS_DCS_H). The
XML tag <SchemeRefData> will be extracted from field A1_INFO and column “R3Tsmp” will be
selected and added to the file content (refer to EF/IFS/003) as <SchemeRefData> and
<R3Tsmp>. After successfully writing a record to the file, the record's PROCESS_STATUS is set
to "T" (Transfer) and the RECORD_STATUS to "N" (None).

However, since DRS cannot access the NPS Table via its unique index (because it does not have
the necessary data), DRS will extract all the required data from NPS ( <SchemeRefData> from
field A1_INFO and column “R3Tsmp” ) into a local table that can be indexed as required.
Therefore, the first task for DRSC307 is to read all necessary data from the NPS table into
DRS_NPS_DCS_STATUS and to then join this with DRS_TX_EFT_C2 during payment file
processing.

If no records are found in C2 Output table for processing, the file is generated with header and
trailer records and the module exits with SUCCESS.

Two instances of the program (one for GlobalPay, one for AMEX) can be run several times a day
although a new Payments file will be generated by each execution; THIS IS NOT ADVISED.

7.4.2.1 Implementation

Implemented in jobs M_DB_SRV#DRSC307E_H_1 and M_DB_SRV#DRSC307E_H_AMEX (the
postfix "E" stands for Debit Card/EFTPoS), the H for HSBC Merchant Services or HMS.

7.4.2.2 Job Dependencies
DRSC307E_H_AMEX runs after M_DB_SRV#DRSC307E_H_1 is run successfully.

7.4.2.3 Rerun action

The common process failure scenarios and rerun actions are described in the section 5-Process
Failure and Recovery.

7.4.2.4 DRSC307 Job Reset Procedure
Execute the following script when logged in as ops$drs user:

update drs _tx_eft_c2

set record status='N',
process_status='I',
transfer _date='',
horizon_agent.
horizon_agent_

where process status

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED PageNo: 43 0f 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
This script will reset all records updated as part of the last DRSC307 run to allow the transactions
to be included in a future C2 Bulk File. Note that this script should NOT be run if DRSC308 has
been run. The dependency revisions to the schedule mean that DRSC308 will not run unless the
S bulk process has completed successfully.
WARNING - Indiscriminate use of this script can result in duplicate transactions being passed
to Globalpay. Under no circumstances run this script unless absolutely sure that it is required.
This script should only be run where the payment run has been abandoned and no payment
file has been sent to HMS.
7.5 Schedule M_DB_SRV4DRS_EFT_STS_C40
This schedule runs the jobs to load back the Status File produced by the DCS C2 Agent.
DRS also receives Zero-Value-C4 (corresponding to Null Confirmations) and S input data files
each day following Payment File generation. This schedule also loads the Zero value C4 file.
DRS also receives a C4/D data file. It is the responsibility of the DCS Schedule to load the C4D
file that is the result of data received in the HMS EMIS File
7.5.1. Dependencies
The schedule follows job DCM_H_PF_D.DCM_H_CREATE_PF_D that is responsible for
generating the file that is the input to this process.
7.5.2 Process DRSC308
The process reads the C2 Status File sent by the DCS C2 Agent and updates the C2 record
status in the C2 Output (EFT_C2_OUTPUT) table. Once a record is loaded successfully the
record's PROCESS_STATUS is set to "C" (complete and the RECORD_STATUS to the value
sent by the Agent. If the RECORD_STATUS is received as "E" (Error) then the Agent Error Code
and Message are also updated in the C2 Output table.
The C2 Status File resides in the directory defined by the environment variable EFT_C2_INPUT.
If no records are found in C2 status file for processing, the module exits with SUCCESS.
7.5.2.1 Implementation
Implemented in job M_DB_SRV#DRSC308E_H_1 (the postfix “E” stands for Debit
Card/EFTPoS).
7.5.2.2 Job Dependencies
Commencement of this job is dependent on completion of the job
DCM_H_PF_D.DCM_H_CHECK_PF_D.
7.5.2.3 Rerun action
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 44 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
The common process failure scenarios and rerun actions are described in the section 5-Process
Failure and Recovery.
7.5.3 Process DRSC305
This process reads C40 XML records from the input data file passed on the command line and
loads the contents into FTMS_RX_EFT_C4SD table.
The input data-file/s are read from the directory $EFT_NBE_INPUT and are renamed to change
their extension to lowercase once they have been successfully processed.
The file that is loaded is dependent on the filename that is passed to the module on invocation.
This process is invoked at this point in the schedule to load the C40 file.
7.5.3.1 Implementation
Implemented in M_DB_SRV#DRSC305E_H_C40. The job is passed the input data file name
containing C40 parts as the command line parameter.
7.5.3.2 Job Dependencies
Runs after the successful execution of M_DB_SRV#DRSC308E_H_1.
7.5.3.3 Rerun action
The common process failure scenarios and rerun actions are described in the section 5-Process
Failure and Recovery.
7.6 Schedule M_DB_SRV#DRS_EFT_STS_C402
This schedule runs the jobs to load back the Status File produced by the DCS C2 Agent for
AMEX.
DRS also receives Zero-Value-C4 (corresponding to Null Confirmations) and S input data files
each day following Payment File generation. This schedule also loads the Zero value C4 file for
AMEX.
DRS also receives a C4/D data file. It is the responsibility of the DCS Schedule to load the C4D
file that is the result of data received in the HMS EMIS File
7.6.1 Dependencies
The schedule follows job DCM_H_PF_D.DCM_H_AMEX_CREATE_PF_D that is responsible for
generating the file that is the input to this process.
7.6.2 Process DRSC308
The process reads the C2 Status File for AMEX sent by the DCS C2 Agent and updates the C2
record status in the C2 Output (EFT_C2_OUTPUT) table. Once a record is loaded successfully
the record's PROCESS_STATUS is set to "C" (complete and the RECORD_STATUS to the value
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 45 of 114
FUJ00234962
FUJ00234962

DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

sent by the Agent. If the RECORD_STATUS is received as "E" (Error) then the Agent Error Code
and Message are also updated in the C2 Output table.

The C2 Status File resides in the directory defined by the environment variable EFT_C2_INPUT.
If no records are found in C2 status file for processing, the module exits with SUCCESS.

7.6.2.1 Implementation

Implemented in job M_DB_SRV#DRSC308E_H_AMEX< (the postfix "E” stands for Debit
Card/EFTPoS).

7.6.2.2 Job Dependencies

Commencement of this job is dependent on completion of the job
DCM_H_PF_D.DCM_H_AMEX_CHECK_PF_D.

7.6.2.3 Rerun action

The common process failure scenarios and rerun actions are described in the section 5-Process
Failure and Recovery.

7.6.3 Process DRSC305

This process reads C40 XML records for AMEX from the input data file passed on the command
line and loads the contents into FTMS_RX_EFT_C4SD table.

The input data-file/s are read from the directory $EFT_NBE_INPUT and are renamed to change
their extension to lowercase once they have been successfully processed.

The file that is loaded is dependent on the filename that is passed to the module on invocation.
This process is invoked at this point in the schedule to load the C40 file.

7.6.3.1 Implementation

Implemented in M_DB_SRV#DRSC305E_H_C40_AMEX. The job is passed the input data file
name containing C40 parts as the command line parameter.

7.6.3.2 Job Dependencies
Runs after the successful execution of M_LDB_SRV#DRSC308E_H_AMEX.

7.6.3.3 Rerun action

The common process failure scenarios and rerun actions are described in the section 5-Process
Failure and Recovery.

7.7. Schedule M_DB_SRV#DRS_EFT_SOB

This schedule runs the first job of the DRS batch overnight for Debit Card. The job runs at around
20:00 every day.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 46 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
7.7.1 Dependencies
Follows successful completion of schedule DRS_EFT_ANALYZE.
7.7.2 Process DRSC353
This job runs at the start of the DRS batch overnight process on completion of the TPS Cash
Account Report jobs.
It sets the value of system parameter “BATCH JOB STARTED” to “Y” to inform the DRS
Workstation that the batch overnight has started and all subsequent connections should be read-
only. It also ‘kills’ the SQL*Net connections made by DRS workstation users (all Oracle
usernames starting with "DRSWKS’) to the database using the SQL statement “ALTER SYSTEM
DISCONNECT SESSION...”
7.7.2.1 Implementation
Implemented in job M_DB_SRV#DRSC353E (the postfix “E” stands for Debit Card/EFTPoS).
7.7.2.2 Job Dependencies
None.
7.7.2.3. Rerun action
The common process failure scenarios and rerun actions are described in the section 5-Process
Failure and Recovery.
7.8 Schedule M_DB_SRV#DRS_EFT_S
This schedule runs the loading of the S input data files into the DRS C4/S/D XML input table.
DRS receives Zero-Value-C4 (corresponding to Null Confirmations) and S input data files each
day following Payment File generation. This schedule loads the S input file.
DRS also receives a C4/D data file. It is the responsibility of the DCS Schedule to load the C4D
file that is the result of data received in the HMS EMIS File
7.8.1. Dependencies
Follows successful completion of schedules DRS_EFT_STS_C40,
DCM_H_PF_D.DCM_H_CREATE_S_D.
Precedes schedule DRS_EFT_STOP_LD, DCM_H_EMIS.DRS_C305E_*_C4D,
7.8.2 Process DRSC305
This process reads S XML records from input data file passed on the command line and loads the
contents into FTMS_RX_EFT_C4SD table.
The input data-file/s are read from the directory $EFT_NBE_INPUT and are renamed to change
their extension to lowercase once they have been successfully processed.
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 47 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
The file that is loaded is dependent on the filename that is passed to the module on invocation.
This process is invoked four times in the schedule, to load the C40 file and the S File, for AMEX
and non-AMEx. It is also called as part of DCM_EMIS schedule to load the C4/D files.
7.8.2.1 Implementation
Implemented in M_DB_SRV#DRSC305E_H_S. The job is passed the input data file name
containing [S] parts as the command line parameter.
7.8.2.2 Job Dependencies
Follows successful completion of DCM_H_PF_D.DCM_H_CHECK_PF_D.
7.8.2.3 Rerun action
The common process failure scenarios and rerun actions are described in the section 5-Process
Failure and Recovery.
7.9 Schedule M_DB_SRV#DRS_EFT_S 2
This schedule runs the loading of the S input data files into the DRS C4/S/D XML input table for
AMEX.
DRS receives Zero-Value-C4 (corresponding to Null Confirmations) and S input data files each
day following Payment File generation. This schedule loads the S input file.
DRS also receives a C4/D data file. It is the responsibility of the DCS Schedule to load the C4D
file that is the result of data received in the HMS EMIS File
7.9.1 Dependencies
Follows successful completion of schedules DRS_EFT_STSC402,
DCM_H_PF_D.DCM_H_AMEX_CREATE_S_D.
Precedes schedule DCM_H_EMIS.DRS_C305E_*_C4D_AMEX
7.9.2 Process DRSC305
This process reads S XML records from input data file passed on the command line and loads the
contents into FTMS_RX_EFT_C4SD table.
The input data-file/s are read from the directory $EFT_NBE_INPUT and are renamed to change
their extension to lowercase once they have been successfully processed.
The file that is loaded is dependent on the filename that is passed to the module on invocation.
This process is invoked four times in the schedule, to load the C40 file and the S File, for AMEX
and non-AMEx. It is also called as part of DCM_EMIS schedule to load the C4/D files.
7.9.2.1 Implementation
Implemented in M_DB_SRV#DRSC305E_H_S_AMExX. The job is passed the input data file name
containing [S] parts as the command line parameter.
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 48 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
7.9.2.2 Job Dependencies
Follows successful completion of DCM_H_PF_D.DCM_H_AMEX_CHECK_PF_D.
7.9.2.3 Rerun action
The common process failure scenarios and rerun actions are described in the section 5-Process
Failure and Recovery.
7.10 Schedule M_DB_SRV#DRS_EFT_STOP_LD
The schedule contains a job to set “C4SD FILE LOAD COMPLETE” flag in the DRS database so
that the C4/S/D parsers exit after processing the current set of data loaded into the DRS C4/S/D
XML input table.
It follows the loader processes DCM_H_EMIS.DRS_C305E_H_*_C4D.
7.10.1 Dependencies
Follows successful completion of jobs DCM_H_EMIS.DRS_C305E_H_*_C4D and schedule
DRS_EFT_S
7.10.2 Process DRSC306
This process sets the value of DRS system parameter “C4SD FILE LOAD COMPLETE” for the
Application Type “EFT” to ‘Y' to indicate that all the DRS C4/S/D files have been successfully
loaded.
Once this flag is set, all instances of DRSC302 exit after processing the last let of C4/S/D input
records.
7.10.2.1 Implementation
Implemented in M_DB_SRV#DRSC306E (the postfix “E” stands for Debit Card/EFTPoS).
7.10.2.2 Job Dependencies
Follows successful completion of DCM_H_EMIS.DRS_C305E_H_*_C4D.
7.10.2.3 Rerun action
The common process failure scenarios and rerun actions are described in the section 5-Process
Failure and Recovery.
7.11 Schedule M_DB_SRV#DRS_EFT_C4_PARSE
This schedule runs multiple instances of the DRS C4/D parse and load process.
7.11.1 Dependencies
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 49 of 114
DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

Follows successful completion of DRS_EFT_PF_SIM and DRS_EFT_PF_GEN.
Precedes schedule DRS_EFT_C4_RCPTD

7.11.2 Process DRSC302

This process reads [C4/D] XML records from FTMS_RX_EFT_C4SD (C4D-Input), parses and
loads them into the DRS_RX_EFT_{C4ID} and DRS_RX_EFT_{C4ID}_EXCP tables respectively
for Debit Card.

TWS invokes eight instances of DRSC302 at the start of the schedule.

The process polls the C12-Input table at periodic intervals after a pause whose duration in
seconds is taken from the value of “C4SD PAUSE WAIT LIMIT” system parameter.

The process execution is controlled by the value of system parameter “C4SD FILE LOAD
COMPLETE” for the Application Type “EFT”. The parameter value is set to “N” by process
DRSC306 on successful completion of all C4SD file load jobs and this would result in all eight
instances of DRSC302 to exit after processing the last set of records from the C4/D input table.

7.11.2.1 Implementation

Implemented in the M_DB_SRV#DRSC302E_NOPAGE_1...8 jobs (the postfix “E” stands for
Debit Card/EFTPoS).

7.11.2.2 Job Dependencies

None

7.11.2.3 Rerun action

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery. As listed in this section, if an instance of DRSC302 fails, TWS
automatically reruns the failed instance once. If it fails on the rerun, TWS does not attempt any
further automatic reruns for that instance. Any failures would result in operational exceptions
being logged, which can be used for fault analysis/resolution.

7.12 Schedule M_DB_SRV#DRS_EFT_C4_RCPTD

This schedule runs multiple instances of the DRS Receipt date update process

7.12.1 Dependencies
Follows successful completion of the schedule DRS_EFT_C4_PARSE & DRS_EFT_MS_DAY
Precedes schedule DRS_EFT_MS_NIGHT

7.12.2 Process DRSC370

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 50 of 114
DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

This process updates the receipt date on each C4/D daily and daily exception record using the
receipt date defined for each record in the C2 Output table. This is required to reconstitute the
seconds information on the Receipt Date which is removed by HMS.

7.12.2.1 Implementation

Implemented in jobs M_DB_SRV#DRSC370E_1..8 (the postfix “E” stands for Debit
Card/EFTPoS).

7.12.2.2 Job Dependencies
None.

7.12.2.3 Rerun action

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery. As listed in this section, if an instance of DRSC302 fails, TWS
automatically reruns the failed instance once. If it fails on the rerun, TWS does not attempt any
further automatic reruns for that instance. Any failures would result in operational exceptions
being logged, which can be used for fault analysis/resolution.

7.13 Schedule M_DB_SRV#DRS_EFT_MS_NIGHT

This schedule runs DRS Main Store Processing (DRSC310) as “batch-overnight” to process all
the transaction parts [C12/C112/C4/D/S] received in DRS since the last run of the schedule. The
same process DRSC310 is also used as part of the daily schedule. See section 7.5 for details.

7.13.1 Dependencies

This schedule follows the successful completion of the schedule DRS_EFT_C4_RCPTD and
DRS_EFT_SOB.

This schedule precedes the schedule DRS_EFT_MS_EXPTN.

7.13.2 Process DRSC310 [NIGHT]

The ‘NIGHT’ run of the DRSC310 process picks up all the transaction parts for processing which
have Receipt Date less than or equal to the current Partition Receipt Date. The value of current
Partition Receipt Date is derived from DRS System Parameter “PARTITION RECEIPT DATE” for
the Application Type “EFT” [refer to System Parameters for details].

This process reads the transaction parts [C12/C112/C4/S/D] from Daily Input tables
[DRS_RX_EFT_C12, DRS_RX_EFT_C112, DRS_RX_EFT_C4, DRS_RX_EFT.D and
DRS_RX_EFT_S for Debit Card] in the order of their arrival sequence in DRS. The transaction
parts are matched on necessary elements and the State Information is derived and set in
chronological order once for the arrival of each transaction part. The resulting transaction record
containing all the available transaction parts and the State Information is then inserted into
DRS_RX_EFT_MAIN_STORE table. The process also inserts a copy of Main Store record into

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 51 of 114
FUJ00234962
FUJ00234962

DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

DRS_RX_EFT_MAIN_STORE_UPDATES table where the transaction part(s) had the Receipt
Date less than the current Partition Receipt Date to facilitate fast reporting.

Multiple instances of the process can be run in parallel. Each instance can process a set number
of Daily Input table partitions.

7.13.2.1 Implementation

This process has been implemented in M_DB_SRV#DRSC310EN_x, where x is the instance
number ranging from 1 to 8 and the postfix “EN” stands for Debit Card/EFTPoS and Night.

7.13.2.2 Job Dependencies
None

7.13.2.3. Rerun action

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.

7.14 Schedule M_DB_SRV4DRS_EFT_MS_EXPTN

This schedule runs DRSC311, which copies records from the daily exception tables into the
corresponding main store exception tables and sets the appropriate State for the records.

7.14.1. Dependencies
This schedule follows the successful completion of the schedule DRS_EFT_MS_NIGHT.

Precedes the schedules DRS_RDDS_EXTRACT. It also precedes DRS_EFT_REP_101,
DRS_EFT_REP_102 but these dependencies are not exercised.

7.14.2 Process DRSC311

The purpose of this module is to copy the DRS Transaction parts (C112, C12, D, C4 and S] that
are in exception from the Daily Exception tables [DRS_RX_EFT_{C12IC112IC4IDIS} EXCP] to
the corresponding Exception Main tables [DRS_RX_EFT_{C12IC112IC4IDIS}_EXCP_MAIN].

Only one instance of the program must be run at any time. Multiple instances could result in
duplicate rows being inserted into the Exception Main tables.

On the pattern of DRS Main Store processing (DRSC310), only those exceptions are processed
that have the value of Receipt Date less than or equal to the current Partition Receipt Date. The
value of current Partition Receipt Date is derived from DRS System Parameter “PARTITION
RECEIPT DATE” for the Application Type “EFT”. The record is validated to check it exists in the
Main Store (DRS_RX_EFT_MAIN_STORE] table and the current state of the transaction part in
exception is either derived or copied from the Main Store table.

After a record has been successfully processed and inserted into the Exceptions Main table, the
PROCESSED_YN flag for the corresponding record in Daily Exception table is set to ‘Y'.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED PageNo: 520f 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
7.14.2.1 Implementation
Implemented in M_DB_SRV#DRSC311E (the postfix “E” stands for Debit Card/EFTPoS).
7.14.2.2 Job Dependencies
None
7.14.2.3 Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
7.15 Schedule M_DB_SRV#DRS_EFT_REP_101
This schedule contains jobs that generate the Debit Card NB101 report.
This Schedule is run daily after the DRS Main store processing and DRS Main exception merge
from daily exception tables.
7.15.1 Dependencies
Follows after successful completion of schedule DRS_EFT_MS_EXPTN and
DRS_RDDS_EXTRACT.
Precedes the Network Banking schedule DRS_ REP_000.
7.15.2 Process DRSC322
The process extracts the C4 transactions for each Routing Gateway from DRS Main Store
(DRS_RX_EFT_MAIN_STORE), Main Store Updates DRS_RX_EFT_MAIN_STORE_UPDATES)
and C4 Exception Main DRS_RX_EFT_C4_EXCP_MAIN) tables and inserts into the DRS NB101
Results (DRS_REP_EFT_RESULTS_NB101) table.
This program does not create any report files.
7.15.2.1 Job Dependencies
None
7.15.2.2 Implementation
Implemented in the M_DB_SRV#DRSC322E job (the postfix “E” stands for Debit Card/EFTPoS).
7.15.2.3 Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
7.15.3 Process DRSC324
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 53 of 114
DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

The process generates NB101 reconciliation reports for the current Run date. The data is
extracted from DRS_REP_EFT_RESULTS_NB101 table and written to the text files.

7.15.3.1 Job Dependencies
Follows successful completion of M_DB_SRV#DRSC322E.

7.15.3.2. Implementation
Implemented in the M_DB_SRV#DRSC324E job (the postfix “E” stands for Debit Card/EFTPoS).

7.15.3.3 Rerun action

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.

7.16 Schedule M_DB_SRV#DRS_EFT_REP_102

The generation of DRS NB102 reconciliation report for Debit Card involves three functional steps:
1. Population of Intermediate tables DRS_REP_EFT_STATE_TOTALS (process DRSC320).

2. Population of Result tables DRS_REP_EFT_RESULTS_NB102_1...12 (process DRSC323).
3. Producing the report text files on the Host operating system (process DRSC325).

The jobs in this schedule perform the above-mentioned three steps.

This Schedule is run daily after the successful completion of NB101 reconciliation reports.

7.16.1 Dependencies

Follows after successful completion of schedule DRS_EFT_MS_EXPTN = and
DRS_RDDS_EXTRACT.

Precedes the Network Banking schedule DRS REP_000.

7.16.2 Process DRSC320

The process populates the DRS State Totals (DRS_REP_EFT_STATE_TOTALS) table from the
transactions held within the DRS Main store (for current day's transactions), DRS Main Store
Updates and the DRS Exception tables for NB102 reports.

This program does not create any report files.

7.16.2.1 Job Dependencies

None

7.16.2.2 Implementation
Implemented in the M_DB_SRV#DRSC320E job (the postfix E stands for Debit Card/EFTPoS).

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 54 0f 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
7.16.2.3. Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
7.16.3 Process DRSC323
The process populates DRS report NB102 Results (DRS_REP_EFT_RESULTS_NB102_1...12)
tables where each table corresponds to a section of the NB102 reports.
The data is extracted from the DRS Main Store (DRS_RX_EFT_MAIN_STORE) Exceptions Main
(DRS_RX_EFT_{C12IC112IC4ISID}_EXCP_MAIN) and the State Totals
(DRS_REP_EFT_STATE_TOTALS) tables and inserted into DRS NB102 Results tables.
The process runs once for each section. To reduce the overall run time, the multiple instances of
the process are run in parallel, where possible. The sections 1, 6, 7 and 12 are run sequentially —
one after the other but the sections 2, 3, 4, 5, 8, 9, 10 and 11 are run in parallel.
Please note that sections do not take similar lengths of time to run. For instance sections 5 and
11 can take up to 30 to 40 minutes, while other sections may be over in a few seconds.
This program does not create any report files.
7.16.3.1 Job Dependencies
Follows successful completion of M_DB_SRV#DRSC320E.
7.16.3.2 Implementation
Implemented in the M_DB_SRV#DRSC323E_x job. Where E is for Debit Card and x is the
section number ranging from 1 to 12. Please refer to the TWS Schedule for Debit Card for inter-
dependencies among the multiple instances of DRSC323.
7.16.3.3. Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
7.16.4 Process DRSC325
The process generates NB102 reconciliation reports. The data is extracted from NB102 Results
(DRS_REP_EFT_RESULTS_NB102_1...12) tables and written to the text files.
7.16.4.1 Job Dependencies
This Program follows successful completion of M_DB_SRV#DRSC323N_x jobs, where “E”
stands for Debit Card/EFTPoS and x is the report sections run in parallel (DRSC323).
7.16.4.2 Implementation
Implemented in the M_DB_SRV#DRSC325E job (the postfix E stands for Debit Card/EFTPoS).
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 55 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
7.16.4.3. Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
7.17 Schedule M_DB_SRV#DRS_EFT_ADMIN
This is the database housekeeping schedule. The schedule archives and purges data from the
Oracle tables and deletes the report/data files older than the pre-defined retention period.
7.17.1. Dependencies
Follows successful completion of the Network Banking schedules DRS_ADMIN
Precedes schedule DRS_EFT_TRN_ACK
7.17.2 Process DRSC361
The purpose of this module is to Archive Control, Data and Report tables to Support and Audit
requirements and Archive/Purge Data and Report tables older than the Retention period for
Archive server. The archive files stored under Archive server are for future references. The old
data is cleared to make space for the new data. Entries from the table
DRS_ARCHIVED_TABLES are used for archive parameters and criteria. The records that go into
this table are also present in the form of a spreadsheet in Appendix F — DRS Archiving Table
Mapping.
This module uses Oracle Export/Import method to archive data as specified in the DRS High
Level Design DES/APP/HLD/0033.
Only one instance of the program must be run at any time. Multiple instances at the same time
could result in corrupt export dump files being created.
If the data purge process fails due to the process not being able to get exclusive access to the
table to purge, an exception is raised and it continues to the next table. The next time the purge
process is run it will purge two days' worth of data. Some of the tables (like the daily tables) can
only hold around three days’ worth of data, so three failures in a row will give problems.
7.17.2.1 Job Dependencies
None.
7.17.2.2 Implementation
Implemented in the M_DB_SRV#DRSC361E job (the postfix “E” stands for Debit Card/EFTPoS).
7.17.2.3, Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
7.17.3 Process DRSC368
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 56 0f 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Please refer to the section 6.4.2 for details of the process.
7.17.3.1 Job Dependencies
Follows the successful completion of M_DB_SRV#DRSC361E job.
7.17.3.2. Implementation
The job runs every day. Implemented in the M_DB_SRV#DRSC368E_3 job (the postfix “E”
stands for Debit Card/EFTPoS).
7.17.3.3 Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
7.17.4 Script DRSX362.sh
The purpose of this Unix shell script is to delete various report/data files older than the file
retention period. The script reads the records present in the table DRS_FILES_TO_HOUSEKEEP
for the details of the report/data files to be deleted.
7.17.4.1 I Job Dependencies
This job should follow after successful completion of the job DRSC361E (the postfix “E” stands for
Debit Card/EFTPoS).
7.17.4.2_ Implementation
Implemented in the M_DB_SRV#DRSX362E job (the postfix “E” stands for Debit Card/EFTPoS).
7.17.4.3 Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
7.17.5 DRS_EFT_AUDIT
This job is for Debit Card File Auditing.
The schedule and job details have been provided by the TWS Development team.
7.18 Schedule M_DB_SRV#DRS_EFT_TRN_ACK
The schedule contains a job that checks for delivery status of report files.
7.18.1 Dependencies
Follows after successful completion of Schedule DRS_EFT_ ADMIN
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 57 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Precedes Schedule DRS_ BACKUP, DRS_FS_BACKUP.
7.18.2 Process DRSC367
The DRS report files for Debit Card are created in the directory pointed to by the environment
variable $EFT_TIPLOUTPUT. For Process DRSC367 harvests file receipt information by
checking for report file delivery success in the delivery receipt files. Since PODG does not
actually generate acknowledgement files, then this process is redundant
7.18.2.1 Job Dependencies
None
7.18.2.2 Implementation
Implemented in the M_DB_SRV#DRSC367E job (the postfix “E” stands for Debit Card/EFTPoS).
7.18.2.3 Rerun action
The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.
7.19 Schedule M_DB_SRV#DRS_EFT_PF_SIM
The schedule contains a job that simulate the production and processing of C2 Status file or C2
S-file.
7.19.1 Dependencies
Follows after successful completion of Schedule DRS_EFT_C12_PARS.
Precedes Schedule DRS_ EFT_C4_PARSE.
7.19.2 Process DRSC372
This process reads the transactions in drs_tx_c2 that have a record_status ='l' and
routing_gateway equal to that passed as a parameter. For each record found, it will update the
current drs_tx_c2 record and at the same time insert a row into ftms_rx_c4sd table with the
settlement date set to the input parameter.
Two instances of this process are initiated in the following job:
lee arameter 1 I Parameter 2 Parameter3
ee Name Job Dependency (system) / (Routing Gateway) I (Settlement Date)
IDRSC372E None EFT 722812 PADCSSETOT*
(BRSC372E"SSK™ Foliows! DRSC37IE” EFT
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 58 of 114
FUJ00234962
FUJ00234962

DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

The Routing Gateway parameter (122512/151293) allows the process to distinguish between
SSK Debit Card transactions and SSK Amex transactions. The settlement date for Debit and
Amex cards are different. The settlement date is a TWS Variable ((DCSSETDT*/*AMXSETDT‘)
that is set by TWS based on a calendar of bank holidays that it receives from RDDS.

7.19.2.1 Implementation
Implemented in the M_DB_SRV#DRSC372E job (the postfix “E” stands for Debit Card/EFTPoS)

7.19.2.2 Rerun action

The common process failure scenarios and rerun actions are described in the section Process
Failure and Recovery.

8 DRS Tables Overview

8.1. Common Tables

All DRS tables that are used to store non-transactional data are common to both Network
Banking and Debit Card/EFTPoS applications. These include tables for storing system
parameters, process control, audit and various file register tables.

Most common tables have a column named APPLICATION_TYPE, which can be mandatory or
optional depending on the type of table. Notable exclusions are tables associated with
housekeeping tasks such as partition management and archiving. If the application type is
mandatory, it is a part of the key for the table and its value is derived from the Application-Type
command-line input parameter that is passed to the process. If the application type is non-
mandatory, it will be used only for records that are Application specific. The two
APPLICATION_TYPE values used are ‘EFT’ for Debit Card Transactions and ‘NWB' for Network
Banking Transactions and ETU Transactions.

Refer to Appendix D — DRS Tables for a brief description of all common DRS tables.

8.2 System Parameters

The System Parameters are configurable parameters stored in DRS_SYSTEM_PARAMTERS
table. One set of System Parameters is stored for Network Banking (NWB) and Debit Card (EFT)
each. The table below lists all the System Parameters currently used by DRS.

Name App I Data-type —_I Description

DRS SYSTEM DATE NWB DATE The current date that the DRS system is working for.

& EFT The program DRSC360 at the start of each day updates
the parameter by incrementing its value by 1 day.

Before the DRS logical processing day starts, this
parameter will have the value of the preceding day. E.g.
at 7am (or before execution of DRSC350) on the 27" of
June 2002, this parameter will have the value “26" June
2002"

The parameter value is set to NULL after DRS baseline
installation. It is expected to be set to TRUNC
(SYSDATE) on the day prior to running the DRS schedule

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 59 0f 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide -
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Name App I Datatype —_I Description
Tor the first time.
PARTITION RECEIPT I NWB& I DATE Indicates the Receipt Date that the most recent partition
DATE EFT in the DRS_RX_NWB_MAIN_STORE table will hold
transactions for.
The program DRSC360 at the start of each day updates
the parameter by incrementing its value by 1 day.
Normally its value should match the value of parameter
“DRS SYSTEM DATE”
Before the DRS logical processing day starts, this
parameter will have the value of parameter “DRS
SYSTEM DATE”.
The parameter value is set to NULL after DRS baseline
installation. It is expected to be set to TRUNC
(SYSDATE) on the day prior to running the DRS schedule
for the first time.
DRS C4SD INPUT NWB& I NUMBER _I Indicates the number of partitions for the table
PARTITIONS EFT FTMS_RX_NWB_C4SD. This value is used by DRSC302
process to derive the next partition number to be
processed
C12 PARSE NWB& I NUMBER _I Indicates the number of instances of C12 parser
PROCESS COUNT EFT (DRSC301). This value is used to derive the total number
of transactions processed before a set of database alerts
could be raised that trigger the DRSC301 processing
C12 INPUT ALERT NWB& I NUMBER I Stores the minimum number of transactions that need to
LIMIT EFT be loaded into a partition of TMS_RX_NWB_C12 before a
database alert is raised to trigger the DRSC301
processing.
DRS C12 INPUT NwB& I NUMBER I Indicates the number of partitions for the table
PARTITIONS EFT TMS_RX_NWB_C12. This value is used by DRSC301
process to derive the next partition number to be
processed.
VERSION FOR NWB& I NUMBER I Stores the current major version number of the DRS
WORKSTATION EFT Workstation. This is compared by the Workstation with a
number stored within the application to check if the DRS
Workstation version is compatible with the DRS-Host.
HORIZON C12INPUT I NWB& I NUMBER I Stores the number of seconds after which instances of
ALERT TIMEOUT EFT the C12 parse and load process DRSC301 will timeout
while waiting for a database alert to trigger C12
processing.
OPTIMUM C12 XML I NWB& I NUMBER __I Indicates the recommended number of records that the
COUNT EFT Horizon C12 NBS agent should pass to the Host in each
call to the C12-interface
C4SD PAUSE WAIT I NWB& I NUMBER __I Stores the number of seconds for which instances of the
LIMIT EFT C4/S/D parser (DRSC302) are required to pause before
polling the FTMS_RX_NWB_C4SD table for the next
batch of input XML records.
C4SD PARSE NWB& I NUMBER I Indicates the number of instances of C4/S/D parser
PROCESS COUNT EFT (DRSC302). This parameter is unused as of now.
DRS DAILY TABLE NWB& I NUMBER I Indicates the number of partitions for each of the DRS
PARTITIONS EFT Daily Tables i.e. DRS_RX_NWB_C12, C4, C112, Sand
D. This value is used by instances of the Main Store
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 60 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide -
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Name App I Datatype —_I Description
process (DRSC310) to derive the next partition number fo
be processed.
DRS PROCESSING I NWB& I TEXT Indicates if the DRS Processing Day has completed. The
DAY COMPLETE EFT value is set to “Y” by DRS End of Day process
(DRSC351) and is used by instances of C12-parse and
load process (DRSC301) to exit processing
C4SD FILE LOAD NWB& I TEXT Indicates if the C4SD file(s) loading has completed. The
COMPLETE EFT value is set to “Y” by DRS File Load Complete process
(DRSC306) and is used by instances of C4SD-parse and
load process (DRSC302) to exit processing
MAXIMUM NUMBER I NWB& I NUMBER __I Stores the maximum number of partitions of the table
OF PARTITIONS EFT (DRS_RX_NWB_MAIN_STORE that can be created
Note that this parameter value must correspond with the
number of tablespaces available to hold the main store
partitions in order for the DRS Start of Day process to
succeed.
C12 RAISE Nwea I TEXT Indicates if an alert should be raised by the C12 Parse
REPEATED KEY EFT and load process (DRSC301) if it encounters a C12
EXCEPTION record that matches a record processed earlier during the
processing day on the Horizon-Transaction-Id and
Receipt-Date.
BATCH JOB NWB& I TEXT Indicates if the DRS batch processing has started. This is
STARTED EFT used by the DRS Workstation to prevent updates to the
database
NEWEST RECEIPT I NWB& I NUMBER I Specifies the upper limit wrt PARTITION RECEIPT DATE
DATE PRD OFFSET I EFT for allowable Receipt Dates
OLDEST RECEIPT NwB& I NUMBER I Specifies the lower limit wrt PARTITION RECEIPT DATE
DATE PRD OFFSET I EFT for allowable Receipt Dates
NB102 EXCEPTION I NWB& I NUMBER I To store the maximum limit for records to printed on the
LIMIT EFT NB102 reports
NB103_REP_RUN_DA I NWB& I NUMBER I NB103 Report Run date offset, either 0-Today(FRI) or 1-
TE_OFFSET EFT NextDay(SAT)
INVALID PK NwB& I NUMBER I Specifies the threshold limit for reporting transaction parts
OPERATIONAL EFT with NULL key values as Operational Exceptions
EXCEPTION LIMIT
SUBPARTITION NwB I NUMBER — I Specifies the number of rows Financial Institution AL_A
COUNT AL A subpattition can hold
SUBPARTITION NwB I NUMBER — I Specifies the number of rows Financial Institution AL_B
COUNT AL B subpartition can hold
SUBPARTITION NWB I NUMBER I Specifies the number of rows Financial Institution
COUNT CAPO A CAPO_A subpartition can hold
SUBPARTITION NWB I NUMBER — I Specifies the number of rows Financial institution
COUNT CAPO B CAPO_B subpartition can hold
SUBPARTITION NWB I NUMBER — I Specifies the number of rows Financial Institution LINK_A
COUNT LINK A subpattition can hold
SUBPARTITION NWB I NUMBER I Specifies the number of rows Financial Institution LINK_B
COUNT LINKB subpartition can hold
NRT LOCK FLAG NWB I N/A Row used as a flag to implement serial access to
DRS_NRT_INTERFACE_METADATA.
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 61 of 114
DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

Name App I Data-type _I Description

C12 DAILY SUMMARY I NWB NUMBER Specifies the Time (in minutes) for each summary
TIME INTERVAL & EFT interval.

C12 DAILY SUMMARY I NWB CHAR Specifies the list of response codes of the transactions
RESPONSE CODE & EFT that need to be summarised.

8.3 DRS Tables

The DRS tables can be divided into three categories:

8.3.1 Static Data Tables

Static data tables store reference-type information that is used by Host Processes and DRS
Workstation.

All static data tables have a column named APPLICATION_TYPE to show whether the reference
data is to be used for Network Banking (NWB), Debit Card (EFT) or both. This column could be
mandatory or nullable depending upon the type of data stored in a static data table. If the column
is nullable, just one set of values is stored in the table and the APPLICATION_TYPE column is
set only for the records that are specific to an APPLICATION_TYPE. For example,
APPLICATION_TYPE column is nullable in DRS_PROCESSES table, which stores the details of
the DRS processes. APPLICATION_TYPE column in this table is populated only for the
processes specific to Network Banking or Debit Card. For common _ processes,
APPLICATION_TYPE column is not populated in DRS_PROCESSES table.

lf the APPLICATION_TYPE column is mandatory and a part of the Unique/Primary Key
constraint, common records in the table are repeated for each application type. For example,
APPLICATION_TYPE column is mandatory in DRS_SYSTEM_PARAMETERS table which stores
details of the System Parameters. This table stores all common System Parameters twice, that is,
once for each application type.

8.3.2 Control/Registry Data Tables

The DRS database has a single set (as opposed to two sets of transaction tables) of tables that
store Control and Registry Information. The control records for both Network Banking and Debit
Card are stored in the same table and are distinguished by the value in APPLICATION_TYPE
column, which forms a part of the Unique/Primary key for the table. Examples of such tables
include DRS_REP_FILE_REGISTER, DRS_C4SD_FILE_REGISTER,
DRS_PROCESS_CONTROL etc.

8.3.3. Transaction Data Tables

The DRS has two sets of transaction data tables one for Network Banking and one for Debit
Card. Each set has a 3-letter acronym in the table name to show which application type the table
belongs to. The Network Banking tables use “NWB" and the Debit Card tables use the “EFT”
acronym. The tables storing similar transactional data for Networking Banking and Debit Card
reside in the same tablespace. For example, DRS_RX_NWB_MAIN_STORE_UPDATES and
DRS_RX_EFT_MAIN_STORE_UPDATES tables store updates to the old Network Banking
transactions and reside in the tablespace DRS_MAIN_STORE_UPDATES.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 62 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
The DRS has two sets of Oracle users one for Network Banking and one for Debit Card. These
users access the transaction data tables through a set of private synonyms. From example,
DRS_RX_NWB_MAIN_STORE_UPDATES table is accessed through a private synonym named
DRS_RX_MAIN_STORE_UPDATES for the Oracle users “OPS$DRSNWB” = and
“OPS$DRSNWB1...8”. Similarly, DRS_RX_EFT_MAIN_STORE_UPDATES table is accessed
through a private synonym named DRS_RX_MAIN_STORE_UPDATES for the Oracle users
“OPS$DRSEFT” and “OPS$DRSEFT1...8". The names of the private synonyms are same for
both the sets of Oracle users.
9 Files Created/Used
9.1 Input and Output Data Files
The input data files contain [C4/D/S] messages in XML format received from the Network Banking
Engine (for Network Banking) or Merchant Acquirer (for Debit Card). The input files containing [S]
messages are received for Debit Card only.
The output data files contain [C2] messages in XML format and are sent to Merchant Acquirer
through DCP C2-Bulk File Agent. The output files containing [C2] messages are created for Debit
Card only.
9.1.1 Electronic Top-Ups
9.1.1.1 C4/D Input
These files contain [C4] and [D] messages in XML format. TWS runs a script that delivers these
files into a Host directory to be loaded into the DRS database. For Electronic Top-Ups the daily
transaction feed file from e-pay is converted into [C4] and [D] messages in XML format and
placed by TWS into a Host directory
The file names and storage location areas are as follows:
Storage Location File Naming Convention Extension Extension
Before After
Processing Processing
$NWB_NBE_INPUT ETU_C4DIN_yyyymmdd .DTF tf
(/bvnw01 /drs/trans/nwbC4Din)
Where yyyymmdd is the Date of creation of the file in Year-Month-Day format and nnjnn] is the
sequence number of the file segment. (not applicable to Electronic Top-Ups).
The processed files are deleted after a configurable number of days by DRS File Purge job
(DRSX362.sh). Also all files are deleted from this directory after a further configurable amount of
time to sweep up any temporary files that are created by TWS.
9.1.2 Debit Card
9.1.2.1 C2 Output
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 63 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide .
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

These files contain [C2] messages in XML format. The Host process DRSC307 creates these
files. The TWS launches the DCS C2 Bulk File Agent to process the [C2] transaction file.
The file names and storage location areas follows:
Storage Location File Naming Convention Extension Extension

Before After

Processing _I Processing
$EFT_C2_OUTPUT DCS_C2BULKOUT_yyyymm I .TRN trn
(/bvnw01 /drs/trans/eftc2out) dd_nn
Where yyyymmdd is the Date of creation of the file in Year-Month-Day format and nn is the
sequence number derived from the current PFG cycle number maintained by TWS (starts at 01
and increments for each successive run in current business day).
The processed files are deleted after a configurable number of days by DRS File Purge job
(DRSX362.sh).
9.1.2.2 C2 Status Input
These files contain [C2] Status messages in ASCII format. The DCS C2 Bulk File Agent
generates this file once it has processed the [C2] messages file. The Host process DRSC308
loads this file into DRS database.
The file names and storage location areas follows:
Storage Location File Naming Convention Extension Extension

Before After

Processing _I Processing
$EFT_C2_ INPUT DCS_C2STSIN_yyyymmdd_ I STS sts
(/bvnw0 1 /drs/trans/efte2in) mn
Where yyyymmadd is the Date of creation of the file in Year-Month-Day format and nn is the
sequence number is derived from the current PFG cycle number maintained by TWS (starts at 01
and increments for each successive run in current business day). The details PFG cycle number
are available in TWS support guide
The processed files are deleted after a configurable number of days by DRS File Purge job
(DRSX362.sh).
9.1.2.3 C40 (Zero-Value-Confirmations) Input
These files contain Zero Value [C4] messages in XML format, received from the Bulk File Agent.
TWS delivers these files into a Host directory to be loaded into DRS database.
The file names and storage location areas follows:
Storage Location File Naming Convention Extension Extension

Before After

Processing Processing
$EFT_NBE_INPUT DCS_C40IN_yyyymmdd_nn DTF tf
(/bvnw01 /drs/trans/eftC4Dsin)

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 64 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

Where yyyymmdd is the Date of creation of the file in Year-Month-Day format and nn is the
sequence number is derived from the current PFG cycle number maintained by TWS (starts at 01
and increments for each successive run in current business day).
9.1.2.4 S Input
These files contain [S] messages in XML format, received from the Bulk File Agent. TWS delivers
these files into a Host directory to be loaded into DRS database.
The file names and storage location areas follows:
Storage Location File Naming Convention Extension Extension

Before After

Processing Processing
$EFT_NBE_INPUT DCS_SIN_yyyymmdd_nn _DTF tf
(/bvnw01 /drs/trans/eftC4Dsin)
Where yyyymmdd is the Date of creation of the file in Year-Month-Day format and nn is the
sequence number is derived from the current PFG cycle number maintained by TWS (starts at 01
and increments for each successive run in current business day).
9.1.2.5 C4/D Input
These files contain [C4] and [D] messages in XML format, received from the Bulk File Agent. The
Bulk File Agent generates these files using the EMIS files containing [C4/D] messages produced
by the Merchant Acquirer (MA). TWS delivers these files into a Host directory to be loaded into
DRS database.
The file names and storage location areas follows:
Storage Location File Naming Convention Extension Extension

Before After

Processing I Processing
$EFT_NBE_INPUT DCS_C4DIN_yyyymmdd_nn I .DTF dtf
(/bvnw01 /drs/trans/eftC4Dsin)
Where yyyymmdd is the Date of creation of the file in Year-Month-Day format and nn is the
sequence number derived from the current EMIS cycle number (starts at 01 and increments for
each successive EMIS pickup run in current business day — it is anticipated that this will only
occur once a day currently).
The processed files are deleted after a configurable number of days by DRS File Purge job
(DRSX362.sh).
9.2 Report Files
9.2.1 Network Banking (Including ETU) and Debit Card
9.2.1.1 MSU Report Files

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 65 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
These files contain NBOOO (for Network Banking only), NB101, NB102 and NB103 Reconciliation
Reports for MSU (Management Support Unit). The files are produced daily (with the exception of
NB103 which is weekly), one for each routing gateway and currency type. Electronic Top-Ups are
reported through the Network Banking reports as a unique routing gateway. Also, a Unix link of
these files is created in the TIP (POLMI) and/or Audit directories, where necessary.
TWS copies these report files from the Host to the MIS Workstation. Audit Server copies the
report files by running its own script. In the future there will be a staging server that the files will
be copied to, then the MSU Workstation can then access these files via this staging server.
The old report files (*.TXT) are deleted after a configurable number of days by DRS File Purge
job (DRSX362.sh).
The file names and storage location are as follows:
Directory Name File Name Extension Extension
Before After
Processing Processing
$NWB_MSU_OUTPUT & <Application><D Lck TXT
$EFT_MSU_OUTPUT tingGatew
<Section><Txn
(/bvnw01 /drs/trans/drsmsu) rency>
As mentioned above, the report files for both Network Banking and Debit Card are created in the
same physical directory.
The naming convention for the report files is as follows:
<Application><Date><RoutingGateway><ReportNum><Section><TxnGroup><Currency>.<EXT>
<Application> ‘NBS’ is used for Network Banking (including Electronic Top-
Ups) reports and ‘DCP’ for Debit Card reports in NB101, NB102
and NB103 reports. ‘DRS’ is used for NBOO0 report.
<Date> Report Run Date in format ‘YYYYMMDD".
<RoutingGateway> Routing Gateway Id. Add leading zeros to fit in the format
nnnnnnnnnn for NB101, NB102 and NB103. NBOOO uses
‘NIL_LRETURN’.
<ReportNo.> ‘NBOO0’, ‘NB101', ‘NB102’ or ‘NB103'.
<Section> Report Section. NB102 uses ‘01’ to ‘12’. NBOO0O, NB101 and
NB103 use ‘00’.
<TxnGroup> Transaction Group. NB103 use ‘WDR' (Withdrawals) or ‘DEP’
(Deposits). NBOO0, NB101 and NB102 use ‘N_A’.
<Currency> Currency. NB101, NB102 and NB103 use a value passed from
the database, usually ‘GBP’ or ‘EUR’. The currency is substituted
by ‘N_A' if not found for the report. NBOOO uses ‘N_A’.
<EXT> Initially set to LCK, once the file generation process is complete
itis set to TXT.
E.g., NBS200207300000000010NB10100N_AGBP.TXT
DCP200201291111111111NB10100N_AEUR.TXT
9.2.1.2 TIP (POLMI) Report and Acknowledgement Files
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 66 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
The directories $NWB_TIP_OUTPUT (for Network Banking) and $EFT_TIP_OUTPUT (for Debit
Card) contain the report files that are required by POL.
All the report files are initially created in $NWB_MSU_OUTPUT and $EFT_MSU_OUTPUT for
consumption by PODG
The file names and storage location for Network Banking are as follows:
Directory Name File Name Extension
Before
Processing
Jovnw01/drsitrans/nwbtip <Application><Dat TXT
tingGatewa
Similarly, the file names and storage location for Debit Card are as follows:
Directory Name File Name Extension
Before
Processing
$EFT_TIP_OUTPUT TXT
(/bvnw01 /drs/trans/efttip)
The details of report file naming convention are available in the section MSU Report Files.
9.3 Oracle Export Files for Audit, Archive and Support
Oracle export files are created for audit, archive and support requirements.
9.3.1 Network Banking and Debit Card
9.3.1.1 Oracle Export Files for Support
These files are created using Oracle “exp” utility. The export dump files contain data from DRS
tables as detailed in Appendix F — DRS Archiving Table Mapping Once the dump files are
successfully created, the files are compressed using Unix utility ‘compress’ to reduce the disk
space usage.
The file names and storage location for Network Banking and Debit Card are as follows:
Directory Name File Name Extension Extension After
Before Compression
Compression
$NWB_SUPPORT_OUTPUT & DRS<ApplicationAlias><Archi I .dmp dmp.Z
$EFT_SUPPORT_OUTPUT veGroupAlias><RunDate>
(/bvnw01 /drs/trans/drssupport)
Where,
<ApplicationAlias> Stored in DRS_ARCHIVED_TABLES table,
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 67 of 114
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

NWB for Network Banking Application and

EFT for Debit Card.
<ArchiveGroupAlias> Stored in DRS_ARCHIVED_TABLES table,
e.g. OPR (for Operational tables)
<RunDate> Current DRS Processing date in the format ‘'YYYYMMDD'.

For example, the name of Oracle dump file for DRS_RX_NWB_MAIN_STORE table will be
DRSNWBDMS20020523.dmp.Z_ and DRS_RX_EFT_MAIN_STORE table will be
DRSEFTDMS20020523.dmp.Z.

An export parameter containing the parameters required by the Oracle export utility and a log file
containing any errors encountered during the export are also created as per the following details:

Directory Name File Name Extension Extension After
Before Compression
Compression
$NWB_SUPPORT_OUTPUT & DRS<ApplicationAlias><Archi I .par N/A
$EFT_SUPPORT_OUTPUT veGroupAlias>

(fovnw01 /drsitrans/drssupport)

$NWB_EXPORT_LOG & DRS<ApplicationAlias><Archi I .log NIA
$EFT_EXPORT_LOG veGroupAlias><RunDate>

(/ovnw01 /drs/trans/drsexplog)

Where,
<ApplicationAlias> Stored in DRS_ARCHIVED_TABLES table,
NWB for Network Banking Application and
EFT for Debit Card.
<ArchiveGroupAlias> Stored in DRS_ARCHIVED_TABLES table,
e.g. OPR (for Operational tables).
<RunDate> Current DRS Processing date in the format ‘YYYYMMDD'.

For example, the mame of Oracle export parameters and logs files for
DRS_RX_NWB_MAIN_STORE table will be DRSNWBDMS.par and DRSNWBDMS20020523.log
respectively. Similarly, the name of Oracle export parameters and logs files for
DRS_RX_EFT_MAIN_STORE table will be DRSEFTDMS.par and DRSEFTDMS20020523.log
respectively.

Old files (DRSNWB*.log and DRSEFT*.log) are deleted after a configurable number of days by
DRS File Purge job (DRSX362.sh). The *.par files do not need housekeeping as the same file is
overwritten each day.

9.3.1.2 Oracle Export Files for Archive

The Oracle export dump files are initially created in the directory /bvnw01/drs/trans/drssupport
(pointed to by $NWB_SUPPORT_OUTPUT and $EFT_SUPPORT_OUTPUT). After the files have
been created and compressed successfully a Unix link is created in the directory
/bvnw01/drs/trans/drsarchive (pointed to by $NWB_ARCHIVE_OUTPUT and
$EFT_ARCHIVE_OUTPUT) for the files required for archive purpose as detailed in Appendix F —
DRS Archiving Table Mapping.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 68 of 114
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

The file names and storage location for export dump files are as follows:

Directory Name File Name Extension Extension After
Before Compression
Compression
$NWB_ARCHIVE_OUTPUT & DRS<ApplicationAlias><Archi_ I N/A dmp.Z
$EFT_ARCHIVE_OUTPUT veGroupAlias><RunDate>

(/bvnw0 1 /drs/trans/drsarchive)

Where,
<ApplicationAlias> Stored in DRS_ARCHIVED_TABLES table,
NWB for Network Banking Application and
EFT for Debit Card.
<ArchiveGroupAlias> Stored in DRS_ARCHIVED_TABLES table,
e.g. OPR (for Operational tables)
<RunDate> Current DRS Processing date in the format ‘YYYYMMDD'.

For example, the name of Oracle dump file for DRS_RX_NWB_MAIN_STORE table will be
DRSNWBDMS20020523.dmp.Z and for DRS_RX_EFT_MAIN_STORE table will be
DRSEFTDMS20020523.dmp.Z

Old files (DRSNWB*.dmp.Z and DRSEFT*.dmp.Z) are deleted after a configurable number of
days by DRS File Purge job (DRSX362.sh).

9.3.1.3 Oracle Export Files for Audit

The Oracle export dump files are initially created in the directory /bvnw01/drs/trans/drssupport
(pointed to by $NWB_SUPPORT_OUTPUT and $EFT_SUPPORT_OUTPUT).. After the files
have been created and compressed successfully a Unix link is created in the directory
bvnw01/drs/trans/drsaudit (point to by $NWB_AUDIT_OUTPUT and $EFT_AUDIT_OUTPUT) for
the files required for audit purpose as detailed in Appendix F — DRS Archiving Table Mapping.

The file names and storage location for export dump files are as follows:

Directory Name File Name Extension Extension After
Before Compression
Compression

$NWB_AUDIT_OUTPUT DRS<ApplicationAlias><Archi I N/A dmp.Z

><! >
& $EFT_AUDIT OUTPUT veGroupAlias><RunDate:

(/bvnw0 1/drs/trans/drsaudit)

Where,
<ApplicationAlias> Stored in DRS_ARCHIVED_TABLES table,

NWB for Network Banking Application and

EFT for Debit Card.
<ArchiveGroupAlias> Stored in DRS_ARCHIVED_TABLES table,

e.g. OPR (for Operational tables)
<RunDate> Current DRS Processing date in the format ‘YYYYMMDD'.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 69 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

For example, the name of Oracle dump file for DRS_RX_NWB_MAIN_STORE table will be
DRSNWBDMS20020523.dmp.Z_ and for DRS_RX_EFT_MAIN_STORE table will be
DRSEFTDMS20020523.dmp.Z
Old files (DRSNWB*.dmp.Z and DRSEFT*.dmp.Z) are deleted after a configurable number of
days by DRS File Purge job (DRSX362.sh).
9.4 DRS File Housekeeping Parameters
Directory Name File Name Retention {Delete Sub- Application

Period directories? Type
bvnw01/drsitrans/inwbC4Din * tf 5 N NWB
/bvnw0t/drs/transinwbC4Din CTL 5 N NwB
pynw0t/drs/trans/drsmsu NBS*.TXT 5 N NWB
\/bvnw01/drs/trans/drsmsu DRS*.TXT 5 N NWB
\/byvnw01/drs/trans/nwbtip . 5 N NWB
bynw01/drs/trans/drssupport DRSNWB*.dmp.Z 5 N NWB
bynw01/drs/trans/drsarchive DRSNWB*.dmp.Z 5 N NWB
bvnw01/drs/trans/drsexplog DRSNWB*.log 5 N NWwB
\/bvnw0 1/drs/trans/nwbC4Din * 7 N NWB
\/bvnw0 1/drs/trans/eftC4DSin “dt 5 N EFT
/bvnw01/drs/trans/eftC4DSin “CTL 5 N EFT
/pvnw0t/drs/trans/drsmsu DCP*.TXT 5 N EFT
/bynw0t/drs/trans/efttip * 5 N EFT
\bvnw01/drs/trans/drssupport DRSEFT*.dmp.Z 5 N EFT
/bvnw01/drs/trans/drsarchive DRSEFT*.dmp.Z 5 N EFT
bynw01/drs/trans/drsexplog DRSEFT* log 5 N EFT
bynw01/drs/trans/eftC4DSin * 7 N EFT
pvnw01/drs/trans/eftC2in * 5 N EFT
bvnw01/drs/trans/eftC2out * 5 N EFT
10 Support Usage of Archive/Support Export

Files
DRS Archive/Support files for Network Banking and Debit Card are created in the form of
compressed Oracle Export database dumps. For details on the naming conventions, file locations
and the file contents, refer to the sections 9.3 and Appendix F — DRS Archiving Table Mapping.
The compressed Oracle export file formats have been chosen to facilitate transport of these files
to multiple environments and ease of loading. Additionally, as the data will be sufficiently
compacted, the disk usage and transfer time will less. Note that these files are not meant for
restoring the state of tables in Live. The Live Backup and Restores are discussed in Section 11.
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 70 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
The Archive/Support files can be loaded by Support on a separate DRS Support environment.
This would typically be a machine running the same Host operating system and version of Oracle
as Live. The support rig must have all Host work packages that have been applied to Live. Also,
the size of the DRS database must match that of Live for all tablespaces with the exception of the
Main Store partition tablespaces.
The following steps should be followed to use the Archive/Support files on the Support rig:
e Copy the compressed Archive/Support file/s to the “/loadarea’” directory on the Support rig.
e Uncompress the file/s
e Delete all existing records from the target table/s in order to ensure no Primary Key violations
occur and that there is sufficient space in the target tablespace
e If importing the Main Store table (DRS_RX_NWB_MAIN_STORE), drop the table and use
import to create the table with the required partition name
e Use the Oracle 8.1.7 Import Utility “imp” to load the contents of the file into target tables. In
addition to the mandatory parameters like USERID and FILE, it is recommended that the
following parameters are used to minimise chances of failure:
BUFFER = 44000000
IGNORE = Y
COMMIT = Y
FROMUSER = OPS$DRS
TOUSER = OPS$DRS
FILE = <Name of the database dump file>
TABLES = <List of tables being imported>
11 Backup and Recovery
11.1 Backup
The DRS backups use the RMAN utility provided by Oracle to take full and incremental backups
daily.
The backup strategy enables a full database copy including archive logs to disk on a Sunday. The
incremental backup is taken from Monday to Saturday. The backups are kept on disks for up to 7
days before been deleted. The backup schedule is defined by the application designer following
the guidelines specified in DES/SYM/HLD/0016, but is expected to be along the following lines:
Following the completion of the Network Banking and Debit Card end of day schedules, and all
other database jobs have completed, the DRS backups are implemented by the DRS_BACKUP
and DRS_FS_BACKUP schedules. Running as full or incremental depending on the day of the
week.
11.2 Recovery
11.2.1__Process Failure
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 71 of 114
DRS Host Support Guide

Pe)
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

In case of failure, the DRS processes rollback changes made to the database wherever possible
before exiting and/or make use of the Process Control to save the last successful restart point.

Dependencies have been defined in the schedule, which disallows TWS from running processes
that are dependent on the failed process this ensuring data integrity. The failed process is then
re-run by the TWS scheduler after a predefined time gap (with manual intervention). In case of
multiple restart points in a process, program logic is used to start from the latest restart point.

11.2.2 System Failure

If the operating system crashes or there is an Oracle Instance failure during the DRS processing
day, it is possible to restart DRS from the point of failure. This is because the DRS database will
be run in ‘Archive-Log' mode.

Once the system is re-started, standard Oracle recovery process would apply all committed
transactions which have not been saved earlier, to the database through the use of redo-log
buffers and rollback segments in a process called “roll forward and back”. For more information
refer to the Oracle Administrators Guide for version 8.1.7.

The TWS scheduler records the process name that was being executed when the crash
occurred. As in the case of Process Failure, the schedule will need to be manually restarted from
the process that has failed.

11.2.3. Media Failure

In case of a media or disk failure, Oracle may not be able to save / read data from the disk. This
could happen due to a number of causes but as the DRS database is running in ‘Archive-log’
mode, it is possible to restart from a point in time prior to the failure in the DRS processing day.
This can be achieved by restoring the previous consistent database backup from the BCV (refer
to Section 11.1) and using the archived and online redo-log files to recover to a point of time just
prior to the media failure.

Successful database recovery from a media failure should be followed by schedule re-start from
the point of failure for the Network Banking/Debit Card and other connected systems.

It is not envisaged that a part of the schedule would need to be rerun as the restore using online
and archived redo-logs is expected to recover the database to its state prior to the failure and the
incomplete DRS processes could be restarted. However if there is a need for schedule rerun,
refer to Section 14.

If database cannot be restored with the above procedure, refer to Appendix B of doc ref:
DES/APP/SPG/3258 for restore procedure. This will restore database back to the latest
point when database crash occurred and the archivelogs will be restored.

12 External System Failures/Restarts

This section lists the external systems that interface with DRS and discusses the most common
failure scenarios and how DRS can recover from them. For an exhaustive description of Failure
Scenarios and Recovery, please refer to DES/APP/IFS/0006.

12.1 RDDS Host Database Failure

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version: 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED PageNo: 720f 114
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

lf a RDDS Host database failure occurs before the execution of the RDDS-to-DRS copy process
(DRSC364), a TWS dependency makes DRS wait for RDDS to be backed up again before
allowing the DRSC364 process to run.

lf a RDDS Host database failure occurs during the execution of the RDDS-to-DRS copy process
(DRSC364), the process is likely to fail and log one/more Operational Exceptions to record the
error details. Once RDDS database is back up again, the process can be rerun.

12.2 TES Host Database Failure

A TES Host database failure would result in the C4/D transactions not arriving. One or more of
the TES owned TES_AL_REC_RUN/TES_CAPO_REC_RUN/ TES_LINK_REC_RUN schedules
would not complete due to DRSC371 failing which will result in all the DRS batch overnight
schedules being held up.

Once the failure is resolved and the preceding TES processes have completed, the DRS batch
overnight jobs will start execution.

Because of the dependencies within the DRS schedule, there would be a corresponding delay in
the completion of TPS-Host batch overnight.

12.3 TWS File Transfer Failure

TWS scripts transfer the MSU Reports to MSU using NFS mounted host directory
(/ovnw01/drs/trans/drsmsu) on the SSC Server. Another set of scripts transfer the DRS Support
and Archive files to the SSC Archive Server again via NFS mounted Host directories
(/ovnw01/drs/trans/drssupport and /bvnw01/drs/trans/drsarchive).

Failure in transferring files to the MSU/SSC Archive may result in some/all of the files not being
transferred. This should not be an issue for Host processing and would not result in loss of data
as long as the file transfer mechanism is able to successfully transfer the files before the files are
deleted by DRS file housekeeping process.

The files would remain on the DRS-Host for MSU to request for manual transfer in case of
automatic transfer failures. Similarly the Support/Archive files can also be requested for a manual
transfer from the DRS-Host.

From Directories and DES/APP/HLD/0108, space for 5 peak working days at phase-2 volumes
has been requested for the DRS Support and MSU-Report directories.

12.4 Audit Server File Transfer Failure

DRS creates Unix hard links for reconciliation reports and a compressed export of the oldest Main
Store partition in the DRS-Audit (/>vnw01/drs/trans/drsaudit) directory.

Failure in transferring files to the Audit Server may result in some/all of the files not being
transferred to the Audit Server. This should not be an issue for Host processing and would not
result in loss of data as long as the file transfer mechanism is able to successfully transfer the
files before the space allocated to the audit directory is exhausted or before the files are deleted
by Audit file housekeeping. From Directories and DES/APP/HLD/0108, space for 5 peak working
days at phase-2 volumes has been requested for the Audit directory.

13 Tuning

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 73 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide -
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
13.1 Oracle Tuning
The following table indicates the tuning that has been done to the initTPS.ora parameter file:
Parameter Value Reason
DB_FILE_MULTIBLOCK_READ_COU I 16 Set to 1Mb, so that table scans are done as close as
NT possible to one extent against the partitioned main
store table and that full table scans are efficient
DB_FILES 600 Maximum number of database files that can be
opened for this database.
OPEN_CURSORS 400 Maximum number of open cursors a session can have
ata time.
DML_LOCKS 2048 Maximum number of DML locks — one for each table
modified in a transaction.
DB_BLOCK_BUFFERS 12800 Attempt to fetch large number of main store
transaction records into memory in order to improve
(100MB) performance
LOG_BUFFERS 163840 Size of the Redo Log Buffers
(16MB)
SORT_AREA SIZE 67108864 Allows the batch processes to sort large volumes of
(eam) transactions in memory
PARALLEL_MAX_SERVERS 80 Maximum number of Parallel Query Servers that can
be opened. Set to a high value to allow the various
multiple instance processes to execute parallel queries
PARALLEL_MIN_SERVERS 10 Minimum number of Parallel Query Servers that are
always open. Value has been set such that Oracle
does not need to open any parallel query servers while
the single instance processes (e.g. reports) are
running
PROCESSES 100 Maximum number of operating system user processes
that can simultaneously connect to Oracle.
TRANSACTIONS 64 Maximum number of Concurrent Transactions.
DISTRIBUTED_TRANSACTIONS 30 Maximum number of Concurrent Distributed
Transactions.
13.2 Schedule tuning
There are two ways to tune the schedule performance:
13.2.1. Schedule parallelism
Several parallel streams will run the load, parse and main store update jobs within the DRS
schedule (e.g. if eight streams are run, each stream will process on eighth of the total number of
partitions). The processes have been scheduled such that write to the same set of tables are not
run at the same time.
The parallelism needs to be tuned on a regular basis to take into account the changing volumes
and spread of data so that each activity can make maximum use of the computer configuration.
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services
Limited 2009-2020

CONFIDENCE)

Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020
STORED Page No: 74 of 114
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

FUJ00234962
FUJ00234962

13.2.2 Resource pools

TWS has a facility to limit the number of jobs running that requires a particular resource, such as
a tape drive. These resource pools are user defined, and can be used to minimise contention.

DRS does not currently use TWS resource pools as the number of jobs running at any given time
is not considered high enough.

13.3 Main store partition tuning

The DRS Main Store tables for Network Banking and Debit Card have been partitioned on
Receipt Date and sub-partitioned on ‘hash’ of Horizon-Transaction-Id. Each partition (along with
its sub-partitions) has its own tablespace, which is spread across physical disks. This has been
done to improve query efficiency and is particularly beneficial for use in parallel queries.

13.4 SQL hint tuning

The Oracle Database Server supports a number of ‘hints’ to its optimiser which informs the
RDBMS at run time of access paths that have been found (through performance testing) to be the
most efficient path to use.

Bearing in mind that DRS is a new product and that the transaction spread may change over
time, the SQL hints used have been stored in a table named DRS_SQL_HINTS. Host processes
that expect to find SQL hints access this table to fetch and use the SQL hint. This has been
implemented to provide for ease of change.

For processes that access large tables, the hint “Parallel” can be/is used for SQL operations
doing fetches and performing sorts. This makes use of the multiple processors present on Host,
multiple parallel query servers possible due to the virtual memory available on the host and the
striping of the tablespaces’ data files across disks.

14 Re-run

DRS has been designed to automatically recover from a data centre failure. All programs will
restart at the point of failure regardless of whether the TWS schedule was recovered.

Since DRS maintains data for 91 days and the non-transient tables are updated on receipt of
each transaction part, it is not advisable to rerun part of the schedule that has been successfully
processed.

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY _ Date: 30-Mar-2020

STORED Page No: 75 of 114
FUJ00234962
FUJ00234962

oO DRS Host Support Guide ~
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN E&

CONFIDENCE)

Appendix A — Network Banking TWS Schedule
See DES/APP/HLD/0091

FUJITSU RESTRICTED (COMMERCIAL IN. Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020

STORED Page No: 76 of 114
FUJ00234962
FUJ00234962

oO DRS Host Support Guide ~
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN E&

CONFIDENCE)

Appendix B — Debit Card TWS Schedule
See DES/APP/HLD/0091

FUJITSU RESTRICTED (COMMERCIAL IN. Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020

STORED Page No: 77 of 114
FUJ00234962
FUJ00234962

oO DRS Host Support Guide ~
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN E&

CONFIDENCE)

Appendix C — Tablespaces and Raw Volumes
Refer to DES/APP/HLD/0108 and DEV/INF/LLD/0043 for full details.

FUJITSU RESTRICTED (COMMERCIAL IN. Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020

STORED Page No: 78 of 114
FUJITSU

FUJ00234962

FUJ00234962

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

Appendix D — DRS Tables

This section provides a list of tables used by DRS along with their purpose and partition key details.

Common Table

These tables are common between the Network Banking and Debit Card.

Table Name

Partition Key

Brief Description

DRS_ANALYZED_OBJECTS

To store the details of DRS database objects need to be ANALYZED to gather the statistics. The statistics is used by Oracle
optimiser to improve the query performance.

DRS_ARCHIVED_TABLES

Holds the parameters that define rules for archiving each table.

DRS_C4SD_FILE_REGISTER

Records loading and processing of NBE files received into DRS

DRS_EXCEPTION_CODES

Contains all the possible exceptions the DRS system may encounter. If an exception is raised and does not appear in this table
then it is known an unknown error.

DRS_FILES_TO_HOUSEKEEP

Holds parameters that define rules for housekeeping [purging] the DRS-Host owned data directories \ files.

DRS_MSU_TEMP_QUERY

Audit queries executed by the DRS Workstation

DRS_MSU_TEMP_RESULT

To store the temporary results of the query executed by the DRS Workstation.

DRS_MS_DATA_MISSMATCH_RULES

Validation rules for DRSC310

DRS_NRT_INTERFACE_METADATA.

Stores the current position regarding certain partitioned tables.

DRS_OPERATIONAL_EXCEPTIONS

Stores details of errors that the system has encountered during processing (or during the time the system is operating). Errors
are inserted into this table from individual modules.

DRS_ORACLE_ERROR_CODES

Stores all Oracle Error Codes that correspond to a data exception

DRS_PARTITION_CREATES

Used by partition management. Details the current state of each partition for partition managed tables.

DRS_PARTITION_STATUS_HISTORY

Used by partition management. Details a history of partition create / archive / delete for each partition managed table.

DRS_PARTITIONED_INDEXES.

Used by partition management. Contains meta-data for partition definitions.

DRS_PARTITIONED_TABLES

Used by partition management. Contains meta-data for partition definitions

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN

UNCONTROLLED IF PRINTED OR LOCALLY

CONFIDENCE)

STORED

Ref DEV/APP/SPG/0028
Version: 7.0

Date: 30-Mar-2020

Page No: 79 of 114
FUJ00234962

FUJ00234962

oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Table Name Partition Key Brief Descri

DRS_PROCESS_AUDIT

Table maintains process audit information for all DRS Host processes. An entry is made in it at the beginning and end of each
Host process

DRS_PROCESS_CONTROL

Table is used to allow process re-startability. An entry is made for new execution of a DRS process instance.

In case such an entry exists for an instance for the processing day, a re-start condition is assumed. A valid Process end date
indicates process completion.

‘Some processes require multiple runs for the processing day and this is handled by incrementing the run number for run of the
process

DRS_PROCESSES

List of all processes with descriptions used by the DRS System

DRS_REP_FILE_REGISTER

Details of each report produced are logged into this table. Also any links created are flagged for each report.

DRS_REP_LINES

Hold SQL queries called by various report programs and used to derive the results for various Report sections.

DRS_REPORTS

Holds static data of all Reports defined for each application and destination.

DRS_SQL_HINTS

Stores the SQL hints that may be used by DRS host/workstation processes to optimise the query performance. Storing the SQL
Hint outside the code gives the facility of changing the hint without having to redeliver code.

DRS_STATE_VALIDATION_RULES.

Table to store DRS state validation rule ids and rule definitions.

DRS_SUBPARTITION_RANGES

Used by partition management. Defines the next partition range value for a table.

DRS_SYSTEM_PARAMETERS.

Stores all DRS System Parameters for each Application-Type.

DRS_TABLE_GROUPS

Used by partition management. Contains meta-data defining grouping for drs_partitioned_tables

DRS_TABLE_PARTITIONS.

Used by partition management. Contains meta-data for partition definitions.

DRS_TRANSACTION_STATES

Lookup table that stores the states a transaction can be set to.

DRS_TRANSACTION_TYPE_GROUPS.

Lookup table that stores the Transaction-Type numbers contained within a transaction group.

RDDS_ACCOUNTING WEEKS

DRS local copy of RDDS Accounting Weeks used for NB103 reporting,

RDDS_CLIENTS

DRS local copy of RDDS Clients

RDDS_ROUTING_GATEWAYS

DRS local copy of RDDS Routing Gateways

TMS_ACT_DRS

Agent Checkpoint table. This table is populated by the Horizon NBS Confirmation C12 Agent with a pointer to the last record

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 80 of 114
FUJITSU

FUJ00234962

FUJ00234962

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

Table Name Partition Key Brief Descrij
from the Messagestore that has been successfully loaded into DRS.

TMS_ART_DRS - Table stores the run state of the Horizon NBS Confirmation C12 Agent. The status is used to communicate the run state of the
Agent to other Agent instances.

JPS_OUTLETS-LAST-POLLED : Containe dato.of Last End-of D: d-by TPS fi outlet by Id-Copied daily-from-TRS after the TP:
batch-run

FPS—TIP_CA_RECEIRTS -

Copied daily from TPS after the TPS batch run,

Network Banking Tables

The following tables are specific to the Network Ban!

king.

Table Name

Partition Key

Brief Description

DRS_C12_NWB_INP_EXCEPTIONS

Stores unparsable / corrupt / invalid NBE [C12] XML messages

DRS_C12_NWB_MONITOR

History of monitor runs

DRS_C4SD_NWB_INP_EXCEPTIONS

Stores unparsable / corrupt / invalid NBE [C4/S/D] XML messages.

DRS_NWB_C12_DAILY_SUMMARY

Summary table

DRS_REP_NWB_CAP_TOTALS

This table holds selective data from

DRS_RX_NWB_MAIN_STORE, DRS_RX_NWB_MAIN_STORE_UPDATES, DRS_RX_NWB_C112_EXCP_MAIN and
DRS_RX_NWB_C4_EXCP_MAIN. This set of data is then used to populate DRS_REP_NWB_RESULTS_NB103.

DRS_REP_NWB_RESULTS_NB101

This table holds data from a combination of DRS_RX_NWB_MAIN_STORE and DRS_RX_NWB_C4_EXCP_MAIN used to
populate report line details for the NB101 Settlement Statement.

DRS_REP_NWB_RESULTS_NB102_1

This table holds selective data from DRS_REP_NWB_STATE_TOTALS required to populate report line details for the NB102
Section 4 output file.

DRS_REP_NWB_RESULTS_NB102_1
0

This table holds selective data from a combination of DRS_RX_NWB_MAIN_STORE, DRS_RX_NWB_C112_EXCP_MAIN,
DRS_RX_NWB_C12_EXCP_MAIN, DRS_RX_NWB_C4_EXCP_MAIN, DRS_RX_NWB_D_EXCP_MAIN and
DRS_RX_NWB_S_EXCP_MAIN used to populate report line details for the NB102 Section 10 output file.

DRS_REP_NWB_RESULTS_NB102_1

This table holds selective data from a combination of DRS_RX_NWB_MAIN_STORE, DRS_RX_NWB_C112_EXCP_MAIN,

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COM!
CONFIDENCE)

UNCONTROLLED IF PRINTED
STORED

MERCIAL IN Ref: DEV/APP/SPG/0028.
Version: 7.0

ORLOCALLY Date: 30-Mar-2020
Page No: 81 of 114
FUJITSU

FUJ00234962

FUJ00234962

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

Table Name

Partition Key

7

DRS_RX_NWB_C12_EXCP_MAIN, DRS_RX_NWB_C4_EXCP_MAIN, DRS_RX_NWB_D_EXCP_MAIN and
DRS_RX_NWB_S EXCP_MAIN required to populate report line details for the NB102 Section 11 output file.

DRS_REP_NWB_RESULTS_NB102_1
2

This table holds selective data from DRS_REP_NWB_STATE_TOTALS required to populate report line details for the NB102
Section 12 output file.

DRS_REP_NWB_RESULTS_NB102_2

This table holds selective data from a combination of DRS_RX_NWB_MAIN_STORE, DRS_RX_NWB_C112_EXCP_MAIN,
DRS_RX_NWB_C12_EXCP_MAIN, DRS_RX_NWB_C4_EXCP_MAIN, DRS_RX_NWB_D_EXCP_MAIN and
DRS_RX_NWB_S_EXCP_MAIN required to populate report line details for the NB102 Section 2 ouitput file.

DRS_REP_NWB_RESULTS_NB102_3

This table holds selective data from a combination of DRS_RX_NWB_MAIN_STORE, DRS_RX_NWB_C112_EXCP_MAIN,
DRS_RX_NWB_C12_EXCP_MAIN, DRS_RX_NWB_C4_EXCP_MAIN, DRS_RX_NWB_D_EXCP_MAIN and
DRS_RX_NWB_S_EXCP_MAIN required to populate report line details for the NB102 Section 3 output file.

DRS_REP_NWB_RESULTS_NB102_4

This table holds selective data from a combination of DRS_RX_NWB_MAIN_STORE, DRS_RX_NWB_C112_EXCP_MAIN,
DRS_RX_NWB_C12_EXCP_MAIN, DRS_RX_NWB_C4_EXCP_MAIN, DRS_RX_NWB_D_EXCP_MAIN and
DRS_RX_NWB_S_EXCP_MAIN required to populate report line details for the NB102 Section 4 output file.

DRS_REP_NWB_RESULTS_NB102_5

This table holds selective data from a combination of DRS_RX_NWB_MAIN_STORE, DRS_RX_NWB_C112_EXCP_MAIN,
DRS_RX_NWB_C12_EXCP_MAIN, DRS_RX_NWB_C4_EXCP_MAIN, DRS_RX_NWB_D_EXCP_MAIN and
DRS_RX_NWB_S_EXCP_MAIN required to populate report line details for the NB102 Section 5 output fle.

DRS_REP_NWB_RESULTS_NB102_6

This table holds selective data from DRS_REP_NWB_STATE_TOTALS required to populate report line details for the NB102
Section 6 output file.

DRS_REP_NWB_RESULTS_NB102_7

This table holds selective data from DRS_REP_NWB_STATE_TOTALS required to populate report line details for the NB102
Section 7 output file.

DRS_REP_NWB_RESULTS_NB102_8

This table holds selective data from a combination of DRS_RX_NWB_MAIN_STORE, DRS_RX_NWB_C112_EXCP_MAIN,
DRS_RX_NWB_C12_EXCP_MAIN, DRS_RX_NWB_C4_EXCP_MAIN, DRS_RX_NWB_D_EXCP_MAIN and.
DRS_RX_NWB_S_EXCP_MAIN required to populate report line details for the NB102 Section 8 output file.

DRS_REP_NWB_RESULTS_NB102_9

This table holds selective data from a combination of DRS_RX_NWB_MAIN_STORE, DRS_RX_NWB_C112_EXCP_MAIN,
DRS_RX_NWB_C12_EXCP_MAIN, DRS_RX_NWB_C4_EXCP_MAIN, DRS_I RX_NWB_D_EXCP_! MAIN and
DRS_RX_NWB_S_EXCP_MAIN to populate report line details for the NB102 Section 9 output fie.

DRS_REP_NWB_RESULTS_NB103

This table holds selective data from DRS_REP_NWB_CAP_TOTALS required to populate report line details for the NB103
Settled Transaction / Cash Account Reconciliation Statement output file

DRS_REP_NWB_STATE_TOTALS

This table holds selective data from
DRS_RX_NWB_MAIN_ STORE, DRS_RX_NWB_MAIN_STORE_UPDATES, DRS_RX_NWB_C112_EXCP_MAIN,

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN

UNCONTROLLED IF PRINTED OR LOCALLY

CONFIDENCE)

STORED

Ref DEV/APP/SPG/0028
Version: 7.0

Date: 30-Mar-2020

Page No: 82 of 114
FUJITSU

FUJ00234962

FUJ00234962

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

Table Name

Partition Key

DRS_RX_NWB_C72_EXCP_MAIN, DRS_RX_NWB_C4_EXCP_MAIN, DRS_RX_NWB_D_EXCP_MAIN and
DRS_RX_NWB_S EXCP_MAIN. This set of data is then used to populate NB 102 results tables for sections 1, 6, 7 and 12.

DRS_RX_NWB_C+12 HASH Table contains the parsed-and domain-validated {C142} records for-a DRS processing Day. For duplicate and corrupt records,
the-non-kay-col h Lblankand pond ml tad in the-table DRS-RX_NWB_C+42-EXCP.
-1D),64-partitions
: C442 Dally exceptions table populated by the DRS-C442 load pi
DRS.RX_NWB_C442-EXCP_MAIN -
DRS_RX_NWB_C12 HASH Table contains the parsed and domain-validated [C12] records for a DRS processing Day. For duplicate and corrupt records, the

(HORIZON_TRANSACTION
_1D), 64 partitions

non-key column values are I blank and a corresponding record is created in the table DRS_RX_NWB_C12_EXCP.

DRS_RX_NWB_C12_EXCP

C12 Daily Exceptions table populated by the DRS C12 Parse processes.

DRS_RX_NWB_C12_EXCP_MAIN

This table stores C12 exceptions data for up to 90 days. The table will be partitioned on the same partition key as the Main Store
table, i.e., on the Receipt Date of the transaction.

Data older than 90 days will be archived and then deleted from the table.

DRS_RX_NWB_C4

Table contains the parsed and domain-validated [C4] records for a DRS processing Day. For duplicate and corrupt records, the
non-key column values are I blank and a corresponding record is created in the table DRS_RX_NWB_C4_EXCP.

DRS_RX_NWB_C4_EXCP

C4 Daily Exceptions table populated by the DRS C4 Parse processes.

DRS_RX_NWB_C4_EXCP_MAIN

This table stores C4 exception data for up to 90 days. The table will be partitioned on the same partition key as the Main Store
table, i.e., on the Receipt Date of the transaction.

Data older than 90 days will be archived and then deleted from the table.

DRS_RX_NWB_D

HASH
(HORIZON_TRANSACTION
_ID), 64 partitions

Table contains the parsed and domain-validated [D] records for a DRS processing Day. For duplicate and corrupt records, the
non-key column values are I blank and a corresponding record is created in the table DRS_RX_NWB_D_EXCP

DRS_RX_NWB_D_EXCP

D Daily Exceptions table populated by the DRS D Parse processes

DRS_RX_NWB_D_EXCP_MAIN

This table stores [D] exception data for up to 90 days. The table will be partitioned on the same partition key as the Main Store

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

UNCONTROLLED IF PRINTED OR LOCALLY

STORED

Ref DEV/APP/SPG/0028
Version: 7.0

Date: 30-Mar-2020

Page No: 83 0f 114
FUJITSU

FUJ00234962

FUJ00234962

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

Table Name

Partition Key

table, i.e., on the Receipt Date of the transaction.
Data older than 90 days will be archived and then deleted from the table.

DRS_RX_NWB_MAIN_STORE

RANGE (RECEIPT_DATE)
(upto 91 partitions)

Sub-pattitioned on HASH
(HORIZON_TRANSACTION
_ID), 64 sub-partitions

Main DRS table that store alll the transaction parts received along with the transaction status

DRS_RX_NWB_MAIN_STORE_UPDA
TES

Table stores a copy of all the changes done to the Main Store partitions other than the current day's partition

DRS_RX_NWB_S

HASH
(HORIZON_TRANSACTION
_ID), 64 partitions

Table contains the parsed and domain-validated [S] records for a DRS processing Day. For duplicate and corrupt records, the
non-key column values are I blank and a corresponding record is created in the table DRS_RX_NWB_S_EXCP.

DRS_RX_NWB_S_EXCP

S Daily Exceptions table populated by the DRS S Parse processes

DRS_RX_NWB_S_EXCP_MAIN

This table stores [S] exception data for up to 90 days. The table will be partitioned on the same partition key as the Main Store
table, ie., on the Receipt Date of the transaction.

Data older than 90 days will be archived and then deleted from the table.

FTMS_RX_NWB_C4SD

HASH
(DRS_INSERT_SEQUENCE
_NUMBER), 8 partitions

C4/S/D Input Store populated by the DRS File load process using transactions from the C4/S/D data file from the NBS Switch for
Network Banking and Solve-PFG/MA for Debit Card.

TMS_RX_NWB_C12

HASH
(DRS_INSERT_SEQUENCE
_NUMBER), 8 partitions

C12 Input Store populated by the Agent instances via database object calls

DRS_TX_NWB_C2_AL_A

RANGE

(PARTITION _LOGICAL_DAT
E) (Upto 5 Partitions) Sub-
partitioned on
HASH(SUBPARTITION_!D),
400 sub-partitions

NBX C2 table that stores all the C2 transaction for the financial institution AL_A

DRS_TX_NWB_C2_AL_B

RANGE
(PARTITION _LOGICAL_DAT

NBX C2 table that stores all the C2 transaction for the financial institution AL_B

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

UNCONTROLLED IF PRINTED OR LOCALLY

STORED

Ref DEV/APP/SPG/0028
Version: 7.0

Date: 30-Mar-2020

Page No: 84 of 114
FUJITSU

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

FUJ00234962
FUJ00234962

Table Name

Partition Key

Brief Description

E) (Upto 5 Partitions) Sub-
partitioned on
HASH(SUBPARTITION_ID),
400 sub-partitions

DRS_TX_NWB_C2_CAPO_A

RANGE

(PARTITION LOGICAL_DAT
E) (Upto 5 Partitions) Sub-
partitioned on
HASH(SUBPARTITION_ID),
100 sub-partitions.

NBX C2 table that stores all the C2 transaction for the financial institution CAPO_A

DRS_TX_NWB_C2_CAPO_B

RANGE
(PARTITION _LOGICAL_DAT
E) (Upto 5 Partitions) Sub-
partitioned on
HASH(SUBPARTITION_ ID),
100 sub-partitions.

NBX C2 table that stores all the C2 transaction for the financial institution CAPO_B

DRS_TX_NWB_C2_EXCP

Exception table for C2 records.

DRS_TX_NWB_C2_LINK_A

RANGE
(PARTITION _LOGICAL_DAT
E) (Upto 5 Partitions) Sub-
partitioned on
HASH(SUBPARTITION_ ID),
400 sub-partitions

NBX C2 table that stores all the C2 transaction for the financial institution LINK_A

DRS_TX_NWB_C2_LINK_B

RANGE

(PARTITION _LOGICAL_DAT
E) (Upto 5 Partitions) Sub-
partitioned on
HASH(SUBPARTITION_ID),
100 sub-partitions.

NBX C2 table that stores all the C2 transaction for the financial institution LINK_B

Debit Card Tables

The following tables are specific to the Debit Card.

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref:

CONFIDENCE)

UNCONTROLLED IF PRINTED OR LOCALLY Date:
Page No:

STORED

Version

DEV/APP/SPG/0028.
7.0

30-Mar-2020

85 of 114
FUJITSU

FUJ00234962

FUJ00234962

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

Table Name

Partition Key

DRS_C12_EFT_INP_EXCEPTIONS

Stores unparsable / corrupt / invalid NBE [C12] XML messages

DRS_C12_EFT_MONITOR

History of monitor runs

DRS_C4SD_EFT_INP_EXCEPTIONS

Stores unparsable / corrupt / invalid NBE [C4/S/D] XML messages

DRS_EFT_C12_DAILY_SUMMARY

‘Summary table

DRS_REP_EFT_CAP_TOTALS

This table holds selective data from

DRS_RX_EFT_MAIN_STORE, DRS_RX_EFT_MAIN_STORE_UPDATES, DRS_RX_EFT_C112_EXCP_MAIN and
DRS_RX_EFT_C4_EXCP_MAIN. This set of data is then used to populate DRS_REP_EFT_RESULTS_NB103

DRS_REP_EFT_RESULTS_NB101

This table holds data from a combination of DRS_RX_EFT_MAIN_STORE and DRS_RX_EFT_C4_EXCP_MAIN used to
populate report line details for the NB101 Settlement Statement.

DRS_REP_EFT_RESULTS_NB102_1

This table holds selective data from DRS_REP_EFT_STATE_TOTALS required to populate report line details for the NB102
Section 1 output file.

DRS_REP_EFT_RESULTS_NB102_10

This table holds selective data from a combination of DRS_RX_EFT_MAIN_STORE, DRS_RX_EFT_C112_EXCP_MAIN,
DRS_RX_EFT_C12_EXCP_MAIN, DRS_RX_EFT_C4_EXCP_MAIN, DRS_RX_EFT_D_EXCP_MAIN and
DRS_RX_EFT_S_EXCP_MAIN used to populate report line details for the NB102 Section 10 output file

DRS_REP_EFT_RESULTS_NB102_11

This table holds selective data from a combination of DRS_RX_EFT MAIN. STORE, DRS_RX_EFT_C112_EXCP_MAIN,
DRS_RX_EFT_C12_EXCP_MAIN, DRS_RX_EFT_C4_EXCP_MAIN, DRS_RX_EFT_D_EXCP_MAIN and
DRS_RX_EFT_S_EXCP_MAIN required to populate report line details for the NB102 Section 17 output file

DRS_REP_EFT_RESULTS_NB102_12

This table holds selective data from DRS_REP_EFT_STATE_TOTALS required to populate report line details for the NB102
Section 12 output file

DRS_REP_EFT_RESULTS_NB102_2

This table holds selective data from a combination of DRS_RX_EFT_MAIN_STORE, DRS_RX_EFT_C112_EXCP_MAIN,
DRS_RX_EFT_C12_EXCP_MAIN, DRS_RX_EFT_C4_EXCP_MAIN, DRS_RX_EFT_D_EXCP_MAIN and
DRS_RX_EFT_S_EXCP_MAIN required to populate report line details for the NB102 Section 2 output file.

DRS_REP_EFT_RESULTS_NB102_3

This table holds selective data from a combination of DRS_RX_EFT MAIN_STORE, DRS_RX_EFT_C112_EXCP_MAIN,
DRS_RX_EFT_C12_EXCP_MAIN, DRS_RX_EFT_C4_EXCP_MAIN, DRS_RX_EFT_D_EXCP_MAIN and
DRS_RX_EFT_S_EXCP_MAIN required to populate report line details for the NB102 Section 3 output file.

DRS_REP_EFT_RESULTS_NB102_4

This table holds selective data from a combination of DRS_RX_EFT_MAIN_STORE, DRS_RX_EFT_C112_EXCP_MAIN,
DRS_RX_EFT_C12_EXCP_MAIN, DRS_RX_EFT_C4_EXCP_MAIN, DRS_RX_EFT_D_EXCP_MAIN and
DRS_RX_EFT_S_EXCP_MAIN required to populate report line details for the NB102 Section 4 output file

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN

UNCONTROLLED IF PRINTED OR LOCALLY

CONFIDENCE)

STORED

Ref DEV/APP/SPG/0028
Version: 7.0

Date: 30-Mar-2020

Page No: 86 of 114
FUJITSU

FUJ00234962

FUJ00234962

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

Table Name

Partition Key

DRS_REP_EFT_RESULTS_NB102_5

This table holds selective data from a combination of DRS_RX_EFT_MAIN_STORE, DRS_RX_EFT_C112_EXCP_MAIN,
DRS_RX_EFT_C12_EXCP_MAIN, DRS_RX_EFT_C4_EXCP_MAIN, DRS_RX_EFT_D_EXCP_MAIN and
DRS_RX_EFT_S_EXCP_MAIN required to populate report line details for the NB102 Section 5 output file

DRS_REP_EFT_RESULTS_NB102_6

This table holds selective data from DRS_REP_EFT_STATE_TOTALS required to populate report line details for the NB102
Section 6 output file.

DRS_REP_EFT_RESULTS_NB102_7

This table holds selective data from DRS_REP_EFT_STATE_TOTALS required to populate report line details for the NB102
Section 7 output file.

DRS_REP_EFT_RESULTS_NB102_8

This table holds selective data from a combination of DRS_RX_EFT_MAIN STORE, DRS_RX_EFT_C112_EXCP_MAIN,
DRS_RX_EFT_C12_EXCP_MAIN, DRS_RX_EFT_C4_EXCP_MAIN, DRS_RX_EFT_D_EXCP_MAIN and
DRS_RX_EFT_S_EXCP_MAIN required to populate report line details for the NB102 Section 8 output file.

DRS_REP_EFT_RESULTS_NB102_9

This table holds selective data from a combination of DRS_RX_EFT_MAIN STORE, DRS_RX_EFT_C112_EXCP_MAIN,
DRS_RX_EFT_C12_EXCP_MAIN, DRS_RX_EFT_C4_EXCP_MAIN, DRS_RX_EFT_D_EXCP_MAIN and
DRS_RX_EFT_S_EXCP_MAIN to populate report line details for the NB102 Section 9 output file

DRS_REP_EFT_RESULTS_NB103

This table holds selective data from DRS_REP_EFT_CAP_TOTALS required to populate report line details for the NB103.
Settled Transaction / Cash Account Reconciliation Statement output file

DRS_REP_EFT_STATE_TOTALS

This table holds selective data from

DRS_RX_EFT_MAIN_STORE, DRS_RX_EFT_MAIN STORE UPDATES, DRS_RX_EFT_C112_EXCP_MAIN,
DRS_RX_EFT_C12_EXCP_MAIN, DRS_RX_EFT_C4_EXCP_MAIN, DRS_RX_EFT_D_EXCP_MAIN and
DRS_RX_EFT_S_EXCP_MAIN. This set of data is then used fo populate NB102 results tables for sections 1, 6, 7 and 12

DRS_RX_EFT.C112

HASH
(HORIZON_TRANSACTION
=1D}-64-parlitions

Table contains the parsed and domain-validated ics 42] records for a DRS processing Day. For duplicate and corrupt records,
RX-EFT.cH4

DRS_RX_EFT_C142_EXCP

C112 Daily exceptions table populated by the DRS.C112 load processes

ORS RX ERT G12 EXCP MAIN

DRS_RX_EFT_C12

HASH
(HORIZON_TRANSACTION
_ID), 64 partitions

Table contains the parsed and domain-validated [C12] records for a DRS processing Day. For duplicate and corrupt records, the
non-key column values are I blank and a corresponding record is created in the table DRS_RX_EFT_C12_EXCP.

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

UNCONTROLLED IF PRINTED OR LOCALLY

STORED

Ref DEV/APP/SPG/0028
Version: 7.0

Date: 30-Mar-2020

Page No: 87 of 114
FUJITSU

FUJ00234962

FUJ00234962

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

Table Name

Partition Key

DRS_RX_EFT_C12_EXCP

C12 Daily Exceptions table populated by the DRS C12 Parse processes.

DRS_RX_EFT_C12_EXCP_MAIN

This table stores C12 exceptions data for up to 90 days. The table will be partitioned on the same partition key as the Main Store
table, i., on the Receipt Date of the transaction

Data older than 90 days will be archived and then deleted from the table.

DRS_RX_EFT_C4

Table contains the parsed and domain-validated [C4] records for a DRS processing Day. For duplicate and corrupt records, the
non-key column values are I blank and a corresponding record is created in the table DRS_RX_EFT_C4_EXCP.

DRS_RX_EFT_C4_EXCP

C4 Daily Exceptions table populated by the DRS C4 Parse processes

DRS_RX_EFT_C4_EXCP_MAIN

This table stores C4 exception data for up to 90 days. The table will be partitioned on the same partition key as the Main Store
table, ie., on the Receipt Date of the transaction.

Data older than 90 days will be archived and then deleted from the table.

DRS_RX_EFT_D

HASH
(HORIZON_TRANSACTION
_ID), 64 partitions

Table contains the parsed and domain-validated [D] records for a DRS processing Day. For duplicate and corrupt records, the
non-key column values are I blank and a cortesponding record is created in the table DRS_RX_EFT_D_EXCP.

DRS_RX_EFT_D_EXCP

D Daily Exceptions table populated by the DRS D Parse processes.

DRS_RX_EFT_D_EXCP_MAIN

This table stores [D] exception data for up to 90 days. The table will be partitioned on the same partition key as the Main Store
table, i.e., on the Receipt Date of the transaction.

Data older than 90 days will be archived and then deleted from the table.

DRS_RX_EFT_MAIN_STORE

RANGE (RECEIPT_DATE)
(upto 91 partitions)

Sub-partitioned on HASH
(HORIZON_TRANSACTION
_ID), 64 sub-partitions

Main DRS table that store alll the transaction parts received along with the transaction status

DRS_RX_EFT_MAIN_STORE_UPDAT
ES

Table stores a copy of all the changes done to the Main Store partitions other than the current day's partition.

DRS_RX_EFT_S

HASH
(HORIZON_TRANSACTION
_ID), 64 partitions

Table contains the parsed and domain-validated [S] records for a DRS processing Day. For duplicate and corrupt records, the
non-key column values are I blank and a corresponding record is created in the table DRS_RX_EFT_S_EXCP.

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

UNCONTROLLED IF PRINTED OR LOCALLY

STORED

Ref DEV/APP/SPG/0028
Version: 7.0

Date: 30-Mar-2020

Page No: 88 0f 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Table Name Partition Key Brief Descri
DRS_RX_EFT_S_EXCP : S Daily Exceptions table populated by the DRS S Parse processes
DRS_RX_EFT_S_EXCP_MAIN 7 This table stores [S] exception data for up to 90 days. The table will be partitioned on the same partition key as the Main Store

table, i.e., on the Receipt Date of the transaction,
Data older than 90 days will be archived and then deleted from the table.

FTMS_RX_EFT_C4SD HASH C4/SID Input Store populated by the DRS File load process using transactions from the C4/S/D data file from the NBS Switch for
(ORS_INSERT_SEQUENCE I Network Banking and Solve-PFG/MA for Debit Card.
_NUMBER), 8 partitions

TMS_RX_EFT_C12 HASH C12 Input Store populated by the Agent instances via database object calls
(ORS_INSERT_SEQUENCE
_NUMBER), 8 partitions

DRS_TX_EFT_C2 . C2 Output tables to store the C2 XML and status of transmission information
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028

© Copyright Fujitsu Services CONFIDENCE) Version 7.0

Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020

STORED Page No: 89 of 114
FUJITSU

DRS Host Support Guide

FUJITSU RESTRICTED (COMMERCIAL IN

CONFIDENCE)

Appendix E — DRS Exceptions

Priority listed against the exceptions in the following table stands for:

A -- Business critical error. If ignored, would violate SLA with Post Office. The error should be fixed immediately / workaround be implemented to avoid violating the

SLA deadline.

B - Error condition but of medium priority. May/will cause the DRS schedule to be held up and should be resolved at the earliest on the same/in the next business day

after resolving exceptions of Priority A.
C - Low priority error conditions / warnings / information only messages. These should be looked onto after resolving all exceptions of A and B priorities.

X - Ignore. Exception is no longer in use or exception is not being generated.

Exception [Short Description Full Description Action Program Name IPriority

Code

IDRS00000 ILog no exception For application use only. No error logged for this exception Ignore exception x

IDRS00001  IApplication Exception [Exception with no application error code defined. Refer to. B

lexception details

IDRS00002 [Oracle Exception (Oracle exception for which there is no business reason to occur B

IDRS10101 _ IInvalid input System ‘The Input System parameter was not found in table Refer to exception details for parameter name and check ldrscommon.pe IB
Parameter IDRS_SYSTEM_PARAMETERS or has NULL value contents of DRS_SYSTEM_PARAMETERS table

IDRS10102 [Process entry is No entry for the current process name found in table Refer to exception details for parameter name and check ldrscommon.pe IB
Imissing/invalid IDRS_PROCESSES when executing function StartControl () contents of DRS_SYSTEM_PARAMETERS table

IDRS10103 [Process entry is INo entry for the current process name found in table Refer to exception details for parameter name and check Idrscommon.pc IB
missing/invalid IDRS_PROCESSES when executing function StopControl () contents of DRS_SYSTEM_PARAMETERS table

IDRS10104 _Iinvalid input System The System parameter named "DRS SYSTEM DATE" was not _IRefer to exception details for parameter name and check drscommon.pe IB
Parameter Ifound in table DRS_SYSTEM_PARAMETERS, contents of DRS_SYSTEM_PARAMETERS table

IDRS10105 [Missing Data-Centr-Char Environment variable DATA_CENTRE_CHAR is not set Check the .vars file in the home directory of the UNIX user used Idrscommon.pe IB

{to execute the process
IDRS10106 invalid Env Variable TZ Environment variable TZ (Time Zone) is not set in the required — ICheck/rectify the contents of environment variable TZ Idrscommon.pe IB

format

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 90 of 114

FUJ00234962
FUJ00234962

FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
IDRS10107  Iinvalid Application Type _ invalid value of Application Type input parameter in function call ICheck that the command-line parameters being passed to the Idrscommon.pc IB
parameter lwith the given Parameter Name, Instance Number and Partition Icalling module are being correctly processed and that the first
lone is being assigned to the Application Type global
IDRS10108 invalid Application Type _Invalid value of Application Type input parameter in function call ICheck that the command-line parameters being passed to the Idrscommon.pe IB
parameter lwith the given Parameter Name, Instance Number and Partition Icalling module are being correctly processed and that the first
lone is being assigned to the Application Type global
IDRS10109  Iinvalid Application Type __ Invalid value of Application Type input parameter in function call ICheck that the command-line parameters being passed to the Idrscommon.pe IB
parameter lwith the given Parameter Name, Instance Number and Partition Icalling module are being correctly processed and that the first
lone is being assigned to the Application Type global
IDRS10110 Invalid Application Type —_IApplication Type global variable has invalid value Check that the command-line parameters being passed to the Idrscommon.pe IB
parameter calling module are being correctly processed and that the first
lone is being assigned to the Application Type global
DRS10201  Iinvalid Application Type _ Invalid value of Application Type input parameter received in __ICheck if the application module is passing correct parameters to Ipkg_drs_commo IB
parameter Hunction call with given values of Parameter Name and Instance  Ithe function In_body. ql
Number
DRS10202 _Iinvalid input System ‘The Input System parameter was not found in table Refer to exception details for parameter name and check pkg_drs_commo IB
Parameter IDRS_SYSTEM_PARAMETERS or has NULL value contents of DRS_SYSTEM_PARAMETERS table In_body.Sql
DRS10203  Iinvalid Application Type _Invalid value of Application Type input parameter received in _ICheck if the application module is passing correct parameters to Ipkg_drs_commo IB
parameter Hunction call with given values of Process Name and Input the function In_body. Sql
Partition
DRS10204 [Process entry is No entry for the current process name found in table Refer to exception details for Process Name and check contents Ipkg_drs_commo IB
Imissing/invaiid IDRS_PROCESSES for given value of Process Name lof DRS_SYSTEM_PARAMETERS table In_body. sql
IDRS10205 invalid Application Type _ invalid value of Application Type input parameter received in __ICheck if the application module is passing correct parameters to Ipkg_drs_commo IB
parameter Hunction call with given values of Process Name and Input the function In_body.sq]
Partition
DRS10206 [Process entry is No entry for the current process name found in table Refer to exception details for Process Name and check contents Ipkg_drs_commo IB
Imissingfinvalid IDRS_PROCESSES for given value of Process Name lof DRS_SYSTEM_PARAMETERS table In_body. ql
DRS10207 _ Iinvalid input System ‘The System parameter named "DRS SYSTEM DATE" was not [Refer to exception details for parameter name and check pkg_drs_commo IB

Parameter

In_body.sql

© Copyright Fujitsu Services
Limited 2009-2020

found in table DRS_SYSTEM_PARAMETERS. contents of DRS_SYSTEM_PARAMETERS table
FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 91 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS30101 incorrect Command-line Incorrect number of command-line input parameters have been [Check the TWS scripts to see if the call being made to the DRSC301.p¢ IB
parameters supplied to the module DRSC301 module is of the form: DRSC301 <Application Type> <Instance
Number> <Total Instances>
DRS30102  IMissing/Invalid Command- _ IMissing/Incorrect command-line input parameters have been _ICheck the TWS seripts to see if the call being made to the IDRSC301.pe IB
line parameters supplied to the module DRSC301 module is of the form: DRSC301 <Application Type> <Instance
Number> <Total Instances>
DRS30103 [Missing System parameter [No entry for parameter ‘HORIZON C12 INPUT ALERT Check the contents of table DRS_SYSTEM_PARAMETERS to IDRSC301.pc IB
TIMEOUT’ found in table DRS_SYSTEM_PARAMETERS see if a record corresponding to the given parameter is present
DRS30104 _Iinvalid Alert occurred Unknown Alert with the given name has occurred while waiting [Check if the database trigger on table DRS_RX_C12is raising IDRSC301.pc IB
Hor alerts with names Process-Alert-1..8 and End-of-day-Alert to Icorrect alerts, Also check if the DRS End-of-Day processing is
loceur raising correct alerts
DRS30105 _IUnparsable Exceptions The given number of exceptions related to input XML data which ICheck the contents of the C12 input exceptions table to manuallyIDRSC301.pe IC.
loccurred is unparsable has occurred ldecipher/reconcile data
DRS30106 {XML Parser Error XML Parser initialisation has failed with given error Check if sufficient amount of memory is available for the process.IDRSC301.pc IB
[Also check if the Oracle XML parser for C has been correctly
installed
DRS30107 Ic12 Daily table Sequence _[The count of number of occurences of Horizon-Txn-Id and Check for the reason of the duplicates in the table. Possible IDRSC301.pc IB
Error Receipt-Date (3rd part of the primary key) has exceeded causes are that the [C12] input interface is not working correctly
acceptable limit lor program errors with DRSC301 and/or the confirmation agent
processes
IDRS30108 [Unknown Error during IA non-data related Oracle error has occurred during inserts into ICheck oracle error message for further information DRSC301.pe IB
inserts ltable DRS_RX_C12
DRS30109 [Unknown Error during [A non-data related Oracle error has occurred during inserts into. [Check oracle error message for further information DRSC301.p¢ IB
inserts tables DRS_RX_C12 or DRS_RX_C12_EXCP
DRS30110 [Unknown Error during IA non-data related Oracle error has occurred during inserts into ICheck oracle error message for further information IDRSC301.pe IB
inserts table DRS_RX_C12_EXCP
DRS30111 {Missing System parameter [No entry for parameter 'DRS PROCESSING DAY COMPLETE’ ICheck the contents of table DRS_SYSTEM_PARAMETERS to IDRSC301.pc IB
Hound in table DRS_SYSTEM_PARAMETERS see if a record corresponding to the given parameter is present

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 92 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS30112 [Missing DRS System INo entry for parameter 'C12 RAISE REPEATED KEY. Check the contents of table DRS_SYSTEM_PARAMETERS to IDRSC30i.pc IB
Parameter EXCEPTION’ found in table DRS_SYSTEM_PARAMETERS for Isee if a record corresponding to the given parameter is present
Jgiven value of Application Type
DRS30113 [Program Error No record matching the given Input Sequence Number was Contact support with error details. DRSC301.pe IB
Hound in the input buffer
DRS30114 IDuplicate [C12] records [Detected one or more [C12] messages as duplicate based on _I Indicates possible Confirmation Agent restart after failure. DRSC301.pe  Ic
ound Itheir Horizon-Transaction-Id and Receipt-Date/Time Contact support with error details
DRS30115 incorrect C2 XML tag ‘The XML tag indicating the beginning of the given [C2] XML was IVerify the integrity of the [C2] XML record. Ifa tagis corrupt,  IDRSC301.pc IB
not found in the [C12] record corresponding to the current Input check if the confirmation Agent is functioning correctly
Sequence Number
DRS30116 incorrect C2 XML tag ‘The XML tag indicating the end of the given [C2] XML was not _IVerify the integrity of the [C2] XML record. Ifa tag is corrupt,  IDRSC301.pc IB
Hound in the [C12] record corresponding to the current Input _Icheck if the confirmation Agent is functioning correctly
Sequence Number
IDRS30117 _IIncorrect C2 Message Type IThe value of XML tag that identifies the Message Type does not IVerify the integrity of the [C2] XML record. Ifa tag is corrupt, IDRSC301.pc IB
match the given expected value for record with current Input —_Icheck if the confirmation Agent is functioning correctly
Sequence Number
DRS30118 _Iinvalid System Parameter _ [No entry for parameter INVALID PK OPERATIONAL Check the contents of table DRS_SYSTEM_PARAMETERS to IDRSC301.pc IB
EXCEPTION LIMIT found in table see if a record corresponding to the given parameter is present
IDRS_SYSTEM_PARAMETERS
IDRS30119  IUndefined Key Value Error [Unable to determine the cause of Key Value error. Probable [Contact support with error details. IDRSC301.pe IB
Icause is a bug in DRSC301
DRS30120 [No matching record found in No record matching the given Input Sequence Number found in [Probable cause is a bug in DRSC301. Contact Support with IDRSC301.pc— Ic
Input the input buffer more details.
DRS30130 _INull/Corrupt Horizon The [C12] transaction part corresponding to the given Insert [Check the XML message attached to the Operational Exception IDRSC301.pc  Ic.
Transaction Id Sequence Number has NULL/Corrupt value of Horizon land contact MSU for further action
[Transaction Id
DRS30131 INull/Corrupt Receipt Date [The [C12] transaction part corresponding to the given Insert _ICheck the XML message attached to the Operational Exception IDRSC301.pc  IC
Sequence Number has NULL/Corrupt value of Receipt land contact MSU for further action
Date/Time

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 93 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS30132 [Receipt Date out of bounds IThe [C12] transaction part corresponding to the given Insert ICheck the XML message attached to the Operational Exception IDRSC301.pe  IC.
Sequence Number has Receipt Date/Time outside the allowed and contact MSU for further action.
ldate range values
IDRS30133 Exception Threshold The Exception threshold <INVALID PK OPERATIONAL [An unnaturally high number of records with corrupt Primary Key [DRSC301.pc [A
Exceeded EXCEPTION LIMIT> for reporting on corrupt key transactions as Ivalues indicate that system as a whole is not functioning
lexceptions has exceeded normally. Check various system hardware/software components
for failure and contact support
DRS30134 [Unable to PREPARE Insert [Unable to Prepare Insert statement for table [%s] Check oracle error message for further information DRSC301.p¢ IB
Sal
IDRS30135 Database function Database function FN_START_NEW_BATCH call returned [%dJ, [Check the Operational exception table for [%s] IDRSC301.p¢ IB
lunsuccessful Check exceptions for [%s]
DRS30136 [Database function Database function FN_START_NEW_BATCH returned SQL [Check oracle error message for further information DRSC301.p¢ IB
lunsuccessful lcode [%d]
DRS30137  IDatabase function Database function FN_START_NEW_BATCH returned invalid [Check the Operational exception table for all DRSC301 Services. IDRSC301.p¢ IB
lunsuccessful Partition Keys [Partition Logical date=>%s][Subpartition
id=>%d[Logical Subpartition id=>%d]
DRS30138. [Database function Database function FN_CONFIRM_PRIOR_TO BATCH call —_ICheck the Operational exception table for {%s] DRSC301.p¢ IB
lunsuccessful returned [%d], Check exceptions for [%s]
DRS30139 [Database function Database function FN_CONFIRM_PRIOR_TO_BATCH returned ICheck oracle error message for further information DRSC301.p¢ IB
lunsuccessful SQL code [%d]
DRS30140 [Unable to insert record Error occurred whilst Inserting into DRS_TX_NWB_C2_EXCP _ICheck oracle error message for further information DRSC301.pe IB
table
IDRS30141 [No routing gateways to No routing gateways found in table Check the static data scripts been loaded correctly. IDRSC301.pe — ID
monitor. IDRS_TMON_ROUTING_GATEWAYS to monitor
IDRS30142 _Iinvalid System Parameter _ [invalid value [%d] found in DRS_SYSTEM_PARAMETERS for ICheck the System parameter specified in [%s] has a valid value IDRSC301.pc IB
value parameter [%s] set
DRS30143_INULL value in System NULL value found in DRS_SYSTEM_PARAMETERS for Check the System parameter specified in [%s] has a Non-NULL IDRSC301.pc IB
Parameter parameter [%s] value set.

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 94 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS30144 [Unable to access table [Error occurred whilst accessing table Check oracle error message for further information DRSC301.p¢ IB
IDRS_TMON_ROUTING_GATEWAYS table
DRS30145 [Unable to (Re)open cursor [Error occurred whilst (Reopening cursor dtrq_cur Check oracle error message for further information DRSC301.p¢ IB
DRS30146 [Unable to fetch from table _IError whilst fetching from DRS_TMON_ROUTING_GATEWAYS ICheck oracle error message for further information IDRSC301.p¢ IB
table
DRS30147 _INumber of routing gateways IMore than [%d] routing gateways have been found in This message is intended as an informational message only. No IDRSC301.pe_ID
exceeded. IDRS_TMON_ROUTING_GATEWAYS table, only [%d] will be —_Ineed to take any preventive actions. If the limit needs increasing
monitored, rest will be ignored Ithe module have to be changed
DRS30148 _ISystem parameter not found INo record found in table DRS_SYSTEM_PARAMETERS for the ICheck the System parameter specified in [%s] exists in the table. [DRSC301.pc IB
parameter [%s]
DRS30149 [Unable to access System Error whilst accessing table DRS_SYSTEM_PARAMETERS __ICheck oracle error message for further information IDRSC301.pe IB
parameters table
DRS30150 [Unable to PREPARE Error whilst Preparing Dynamic SQL [%s] Check the SQL specified in [%s] for any Syntax errors, ifnot,  IDRSC301.po IB
Dynamic SQL Icheck the oracle error message for further information.
DRS30151 [Error deriving time period [Error whilst deriving Time period intervals Check oracle error message for further information DRSC301.p¢ IB
intervals
DRS30152 [Error fetching time period —_IError whilst fetching the time period intervals Check oracle error message for further information DRSC301.p¢ IB
intervals
DRS30153 [Error deriving Int. no. for _I Error whilst deriving the Interval number for Receipt time [%s], I This message is intended as an informational message only. IDRSC301.pc  ID
Receipt time record ignored for monitoring This is due to an invalid Receipt time, No need to take any
faction, this transaction will be captured by C12 exception
IDRS30154 _IUnable to PREPARE Error whilst preparing UPDATE Dynamic SOL [%s] Check the SQL specified in [%s] for any Syntax errors, ifnot,  IDRSC301.pc IB
UPDATE Dynamic SQL Icheck the oracle error message for further information
IDRS30155 [Unable to PREPARE Error whilst preparing INSERT Dynamic SQL [%s] Check the SQL specified in [%s] for any Syntax errors, ifnot,  IDRSC301.po IB
INSERT Dynamic SQL Icheck the oracle error message for further information
DRS30156 [Error inserting into Error whilst Insering into DRS_C12_MONITOR table Check oracle error message for further information DRSC301.p¢ IB
DRS_C12_MONITOR

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 95 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS30157 [Error updating [Error whilst updating DRS_C12_MONITOR table. Check oracle error message for further information DRSC301.p¢ IB
DRS_C12_MONITOR
DRS30158 [Error fetching START NEW Error whilst fetching START NEW BATCH RETRIES from Check oracle error message for further information DRSC301.p¢ IB
BATCH RETRIES ldrs_system_parameters
DRS30159 [Error fetching START NEW Error whilst fetching START NEW BATCH SLEEP from Check oracle error message for further information IDRSC301.p¢ IB
BATCH SLEEP ldrs_system_parameters
DRS30160 {Error releasing old partitions IError whilst releasing old partitions Check oracle error message for further information IDRSC301.p¢ IB
pkg_drs_batch_mgt.fn_release_all_mine
IDRS30161 [Error releasing old partitions IError whilst releasing old partitions Check oracle error message for further information IDRSC301.pe IB
pkg_drs_batch_magt.fn_release_all_mine
DRS30201  Iincorrect Command-line _I Incorrect number of command-line input parameters have been [Check the TWS soripts to see if the call being made to the IDRSC302pe IB
parameters, supplied to the module DRSC302 module is of the form: DRSC302 <Application Type> <Instance
Number> <Total Instances>
DRS30202 IMissing/invalid Command- I Missing/Incorrect command-line input parameters have been _ICheck the TWS scripts to see if the call being made to the DRSC302p¢ IB
line parameters supplied to the module DRSC302 module is of the form: DRSC302 <Application Type> <Instance
Number> <Total Instances>
DRS30203 Missing System parameter [No entry for parameter 'C4SD PAUSE WAIT LIMIT’ found in _ICheck the contents of table DRS_SYSTEM_PARAMETERS to IDRSC302.pc IB
table DRS_SYSTEM_PARAMETERS [see if a record corresponding to the given parameter is present
DRS30204 Missing System parameter INo entry for parameter 'C4SD FILE LOAD COMPLETE found in ICheck the contents of table DRS_SYSTEM_PARAMETERS to IDRSC302.pc IB
table DRS_SYSTEM_PARAMETERS see if a record corresponding to the given parameter is present
DRS30205 _IUnparsable Exceptions The given number of exceptions related to input XML data which ICheck the contents of the C4SD input exceptions table to DRSC302p¢ —[c
loccurred is unparsable has occurred manually decipher/reconcile data
DRS30206 {XML Parser Error XML Parser initialisation has failed with given error Check if sufficient amount of memory is available for the process. IDRSC302.pc IB
[Also check if the Oracle XML parser for C has been correctly
installed
DRS30207 [Unknown Error during JA non-data related Oracle error has occurred during bulk inserts. [Check oracle error message for further information DRSC302p¢ IB
inserts into table DRS_RX_C4

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 96 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

Exception IShort Description Full Description [Action Program Name IPriority

Code

DRS30208 [Unknown Error during IA non-data related Oracle error has occurred during bulk inserts [Check oracle error message for further information DRSC302p¢ IB
inserts into table DRS_RX_D

DRS30209 [Unknown Error during JA non-data related Oracle error has occurred during bulk inserts. [Check oracle error message for further information DRSC302p¢ IB
inserts into table DRS_RX_S

]DRS30210 _IInvalid Input Message Type invalid value of Message Type passed to the function that Check contents of the FTMS_RX_C4SD input table to see if one IDRSC302.pc IB

handles Data related exceptions lor more XML messages are of invalid message type

IDRS30211 [Sequence reached Max _I The Horizon Transaction Id - Receipt Date Sequence has Confirm correct execution of the C4SD Loader process. Check IDRSC302pc IB
Value reached its maximum allowed value {for valid data in the FTMS_RX_C4SD table

IDRS30212 [Unknown Error during IA non-data related Oracle error has occurred during inserts into ICheck oracle error message for further information IDRSC302.pc IB
inserts tables DRS_RX_C4 or DRS_RX_C4_EXCP

DRS30213 [Sequence reached Max _I The Horizon Transaction Id - Receipt Date Sequence has Confirm correct execution of the C4SD Loader process. Check IDRSC302.pc IB
Value reached its maximum allowed value for valid data in the FTMS_RX_C4SD table

DRS30214 [Unknown Error during JA non-data related Oracle error has occurred during inserts into ICheck oracle error message for further information IDRSC302p¢ IB
inserts tables DRS_RX_D or DRS_RX_D_EXCP

DRS30215 Sequence reached Max _I The Horizon Transaction Id - Receipt Date Sequence has Confirm correct execution of the C4SD Loader process. Check IDRSC302.pc IB
Value reached its maximum allowed value {for valid data in the FTMS_RX_C4SD table

DRS30216 [Unknown Error during IA non-data related Oracle error has occurred during inserts into ICheck oracle error message for further information DRSC302p¢ IB
inserts tables DRS_RX_C4 or DRS_RX_C4_EXCP

DRS30217 [Unknown Error during IA non-data related Oracle error has occurred during inserts into ICheck oracle error message for further information DRSC302p¢ IB
inserts table DRS_RX_C4_EXCP.

DRS30218 [Unknown Error during [A non-data related Oracle error has occurred during inserts into [Check oracle error message for further information IDRSC302p¢ IB
inserts table DRS_RX_D_EXCP

IDRS30219 [Unknown Error during IA non-data related Oracle error has occurred during inserts into ICheck oracle error message for further information IDRSC302pe IB
inserts table DRS_RX_S_EXCP

IDRS30220 invalid Input Message Type _IInvalid value of Message Type returned by the function that Check contents of the FTMS_RX_C4SD input table to see if one IDRSC302.pc IB

parses the C4SD XML input lor more XML messages are of invalid message type

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 97 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS30401 invalid input Application _ The input Application Type parameter value is invalid Check if the C12 Confirmation Agent is passing correct value of ‘Ipkg_c12_agent_IB
Type input Application Type ldata_body sql
DRS30402 _Iinvalid input Application _I The input Application Type parameter value is invalid Check if the C12 Confirmation Agent is passing correct value of Ipkg_c12_agent_IB
Type input Application Type Jdata_body.sql
DRS30403 _ISevere Oracle Error [Severe Oracle Error detected in PKG_C12_AGENT_DATA. One or more errors have occurred in earlier calls to the interface Ipkg_c12_agent_IB
detected Initialisation has failed with one/more errors lor during initialisation which prevent the processing from ldata_body sql
proceeding successfully
DRS30501 incorrect Command-line Incorrect number of command-line input parameters have been [Check the TWS scripts to see if the call being made to the DRSC305.pc IB
parameters supplied to the module DRSC305 module is of the form: DRSC305 <Application Type> <Input
C4SD Filename inc! Path>
DRS30502 IMissing/invalid Command- _ IMissing/Incorrect command-line input parameters have been _ICheck the TWS seripts to see if the call being made to the IDRSC305.pc IB
line parameters supplied to the module DRSC305 module is of the form: DRSC305 <Application Type> <Input
C4SD Filename inc! Path>
DRS30503 [Environment Variable is _{ The environment variable <Application Type>_NBE_INPUT whichICheck whether the Rig has the correct DRS build, Also check theIDRSC305.pc IB
invalid points to the location of the C4/S/D input files is not set or has _I.vars file for correct value of environment variable
invalid value <ApplicationType>_NBE_INPUT and confirm if the .vars file is
being executed for the Unix user
DRS30504 Error during File-open [Error occurred while opening the input file segment with given [Check for the existence of the file with correct filename and path. IDRSC305.pc ‘IB
name (inc! Path) [Also check for correct read privileges on the file
DRS30505 Error during File close [Error occurred while closing the currently open file segment __ICheck if the file has been modified while it was being read from IDRSC305.pc IB
by DRSC305. Also check if the privileges on the file have been
altered in any way
DRS30506 incorrect File Header RecordIA header record, which wasn't the first record of the file, was___ICheck if the input File contents are valid DRSC305.p¢ I [D
ldetected in the Input C4/S/D file
IDRS30507 Incorrect File Trailer Record IFile trailer record, which wasn't the last record of the file, was__ICheck if the input File contents are valid IDRSC305.pe  ID
ldetected in the input C4/S/D file
DRS30508 {Trailer Record count The record count in the C4/S/D File Segment Trailer does not __ICheck if the input File contents are valid DRSC305.pe IC
mismatch match with the count of records processed

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 98 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS30509 _Iinvalid File Segment Header [invalid value of File Segment Header Record-type found in the _ICheck if the input File contents are valid DRSC305.p¢  [D
input File Segment
[DRS30510 invalid File Segment Header IThe File Segment Header Record does not have the expected —_ICheck if the input File contents are valid DRSC305.pc—[D
number of elements
IDRS30511 Invalid File Segment Trailer invalid value of File Segment Trailer Record-type found inthe __ICheck if the input File contents are valid IDRSC305.pe  ID
input File Segment
DRS30512 _IInvalid File Segment Trailer_ IThe File Segment Trailer Record does not have the expected —_I Check if the input File contents are valid IDRSC305.pe  ID
number of elements
IDRS30513 input File Segment being _I The Input File Segment is being reprocessed Check if the TWS scripts are re-processing the file or if the IDRSC305.pe IC
reprocessed Control and/or Data Files are being re-transmitted by NBE
DRS30514 _ IProgram/Rig Error Function StartControl () returned a value of 0 when a file entry IContact technical support for more information DRSC305.pe IB
lcould be made in the C4SD File Register
DRS30515 _IProram/Rig Error No record found in the C4SD File Register for given input File. [Most likely cause is that the entry for DRSC305 in DRSC305.pc IB
Segment and Application Type DRS_PROCESSES does not have the Multiple-Runs-in-single-
day flag set. Contact technical support for more information
DRS30516 input File Segment being _I The Input File Segment is being reprocessed Check if the TWS scripts are re-processing the file or if the IDRSC305.pe  IC
reprocessed Control and/or Data Files are being re-transmitted by NBE
DRS30517 _IProram/Rig Error Function StartControl () returned a value of 0 when a file entry [Most likely cause is that the entry for DRSC305 in IDRSC305.p¢ IB
lcould be made in the C4SD File Register DRS_PROCESSES does not have the Multiple-Runs-in-single-
day flag set. Contact technical support for more information
DRS30518 [Unable to rename File Cannot file a’ separator in the input File Segment Name hence IRefer to the error message for more details before deciding on IDRSC305.pc—Ic.
Segment lcannot rename the file to change its extension faction
DRS30519 [Unable to rename File [The File rename operation to change theFile Segment extension IRefer to the error message for more details before deciding on IDRSC305.pc — IC
Segment has failed with error faction. Probable causes would be user privileges on the File or
Ispecial characters in the File name
DRS30520 _Iinvalid File Record The first record of the C4/S/D File Segment is not a header Check if the input File contents are valid DRSC305.p¢ [D
record

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 99 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS30521 [No File Trailer Record No File Segment Trailer record found as the last record of the —_ICheck if the input File contents are valid DRSC305.p¢  [D
input C4/S/D file
DRS30601 incorrect Command-line Incorrect number of command-line input parameters have been [Check the TWS scripts to see if the call being made to the DRSC306.pc IB
parameters supplied to the module DRSC306 module is of the form: DRSC306 <Application Type>
IDRS30602 _Iinvalid/Null Parameter Value Iinvalid/Null value fetched for system parameter 'C4SD FILE —_—_ICheck contents of table DRS_SYSTEM_PARAMETERS fora IDRSC306.pc_ IB
LOAD COMPLETE! \valid character value for’C4SD FILE LOAD COMPLETE"
DRS30701 incorrect no of Command- _ [incorrect number of command-line parameters Check the TWS scripts to see if the call being made to the IDRSC307.pc IB
line parameters module is of the form: DRSC307 <Application Type>
<TWSSequenceNumber>
DRS30702 invalid Command line Invalid command-line parameter Check the TWS scripts to see if the call being made to the IDRSC307.pc IB
parameter module is of the form: DRSC307 <Application Type>
<TWSSequenceNumber>
[DRS30703 [Environment variable is not_ [Environment variable is not set Set the Environment variable with correct value. DRSC307.pc IB
set
DRS30704 [Failed to access directory _ [Failed to access directory set by EFT_C2_OUTPUT Change the access permissions for the directory DRSC307.pc IB
IDRS30705_IDRS SYSTEM DATE not set [DRS SYSTEM DATE not set in DRS_SYSTEM_PARAMETERS ICheck table DRS_SYSTEM_PARAMETERS for DRS SYSTEM IDRSC307.pc IB
table DATE
DRS30706 _IFile already exists Output File .TRN already exists IDRSC307.p¢ IB
DRS30707 [Failed to open File Failed to open .LCK File Refer to the Exception Error message for further details DRSC307.p¢ IB
DRS30708 [Failed to write Header Failed to write Header record to .LCK File Refer to the Exception Error message for further details IDRSC307.pc IB
DRS30709 Update of C2 XML records [Update of Host Array for C2 XML records failed Check oracle error message for further information DRSC307.p¢ IB
failed
DRS30710 [Failed to write Body record [Failed to write Body record to .LCK File Refer to the Exception Error message for further details DRSC307.pc IB
IDRS30711 {Failed to write Trailer Failed to write Trailer record to .LCK File Refer to the Exception Error message for further details IDRSC307.pe IB
DRS30712 [Failed to close File Failed to close .LCK File Refer to the Exception Error message for further details DRSC307.p¢ IB

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 100 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS30713 [Failed to rename file Failed to rename .LCK file to .TRN file Refer to the Exception Error message for further details DRSC307.pc IB
DRS30801 _Iincorrect no of Command- _ [incorrect number of command-line parameters Check the TWS scripts to see if the call being made to the IDRSC308.pc IB
line parameters module is of the form: DRSC307 <Application Type>
<TWSSequenceNumber>
DRS30802 _IInvalid Command line Invalid command-line parameter Check the TWS soripts to see if the call being made to the IDRSC308.p¢ IB
parameter module is of the form: DRSC307 <Application Type>
<TWSSequenceNumber>
DRS30803 [Environment variable is not_ [Environment variable is not set Set the Environment variable with correct value. DRSC308.p¢ IB
set
DRS30804 [Failed to access directory [Failed to access directory set by EFT_C2_INPUT Change the access permissions for the directory DRSC308.p¢ IB
IDRS30805_IDRS SYSTEM DATE not set [DRS SYSTEM DATE not set in DRS_SYSTEM_PARAMETERS ICheck table DRS_SYSTEM_PARAMETERS for DRS SYSTEM IDRSC308,pc IB
table DATE
DRS30806 _Iinvalid File Name Invalid File Name <InputFileName> IDRSC308.pe IB
DRS30807 [Failed to open File Failed to open <InputFileName> File Refer to the Exception Error message for further details IDRSC308.pe IB
DRS30808 _IFile already processed File <InputFileName> already processed Refer to the Exception Error message for further details IDRSC308.pe IB
DRS30809 _Iinvalid Header Record Invalid Header Record in Input File Refer to the Exception Error message for further details DRSC308.p¢ (IB
IDRS30810 [Header record missing Header record missing in Input File Refer to the Exception Error message for further details DRSC308.p¢ (IB
DRS30811 invalid Body Record Invalid Body Record in Input File Refer to the Exception Error message for further details IDRSC308.p¢ IB
DRS30812 Error Threshold Reached —_ I Number of Invalid Body Record Count has increased the error_IRefer to the Exception Error message for further details DRSC308.p¢ IB
threshold
DRS30813 _Iinvalid Body Record Invalid Body Record in Input File for Insert Sequence Number —_IRefer to the Exception Error message for further details IDRSC308.p¢ IB
<InsSeqNo>
DRS30814 [Body Record missing Body Record Missing in Input file Refer to the Exception Error message for further details DRSC308.p¢ (IB
DRS30815 [Failed to update records _[ Failed to update C2 XML records Refer to the Exception Error message for further details IDRSC308.pe IB

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 101 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception [Short Description Full Description ‘Action Program Name IPriority
[Code
DRS30816 [Trailer record missing Invalid Trailer Record in Input File / Trailer Record missing in [Refer to the Exception Error message for further details DRSc308.p¢ IB
Input File
IDRS30817 — IInvalid Trailer Record Invalid Trailer Record in Input File / Trailer Record missing in Refer to the Exception Error message for further details IDRSC308.pc IB
Input File
DRS30818 _ [Failed to rename file Failed to rename .LCK file to. TRN file Refer to the Exception Error message for further details DRSC308.pc IB
DRS30819 [Unable to access lUnable to access database table DRS_TX_C2 Check the database to see proper permissions have been given [DRSC308.pc IB
DRS_TX_C2 to the users.
DRS30820 [Unable to fetch from [Unable to do a fetch from database table DRS_TX_C2 Check the database to see proper permissions have been given IDRSC308.pc IB
DRS_TX_c2 to the users
IDRS30821 Incomplete transactions existIOne or more transactions with PROCESS_STATUS ="T" found IContact support with error details IDRSC308.pe = ID.
in DRS_TX_C2 table.
DRS31001 incorrect Command-line _ incorrect number of command-line input parameters have been IUsage: DRSC310 <Run Type> <Application Type> <Instance IDRSC310.pe IB
parameters supplied to the module DRSC310 Number> <Total Instances>
IDRS31002 Incorrect Command-line __ Incorrect value/number of the RunType command-line parameter IInvalid Run Type passed on the command-line. Only 'DAY' or IDRSC310.pc IB
parameters has been supplied to the module DRSC310 'NIGHT is allowed.
IDRS31003  Iincorrect Command-line _I Missing or invalid command-line parameters have been supplied IUsage: DRSC310 <Run Type> <Application Type> <Instance IDRSC310.pc_ IB
parameters to the module DRSC310 Number> <Total Instances>
DRS31005 _IState lookup buffer overflow [Fatal Error. More than 256 elements required in State Lookup _IIncrease the state lookup buffer size in the program. Contact 4th IDRSC310.pe IB
Buffer. The buffer could not be populated successfully. line support.
DRS31006 [Match not found in DRS ~—_INo match found in State Lookup Buffer for the Current State and Check the contents of DRS Transaction States table. Contact IDRSC310.pe IB
States table Transaction Part Arrived. Isupport with error details.
DRS31007 INo room to store the next All state columns for the transaction have been occupied. Could [Check the contents of the transaction present in the Main Store IDRSC310.pc IB
trans state not store the next state of the transaction into Main Store table. Itable. Contact support with error details.
DRS31008  Istate rules lookup buffer [Fatal Error. More than 128 elements required in State Rules _I Increase the state rules lookup buffer size in the program. DRSC310.pe IB
overflow Lookup Buffer. The buffer could not be populated successfully. IContact support with error details.
DRS31009 [Missing state validation rule [Rule Id was not found in DRS_STATE_VALIDATION RULES — Check the contents of DRS_STATE_VALIDATION RULES — IDRSC310.pc_ IB
id table table. Contact support with error details.
FUJITSU RESTRICTED (COMMERCIAL IN Ref. DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version: 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 102 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS31010 [Main Store buffer overflow [Can not initialise a new transaction record in Main Store Buffer. [Contact support with error details. DRSC310.p¢ IB
Maximum count has been reached.
IDRS31011 [Duplicate C12 transaction I Duplicate flag has been found set by the daily input processing [Check the contents of the DRS Main Store and C12 Daily Input IDRSC310.pc IB
part not found lwhere there is no existing transaction part for the matching lables. Contact support with error details.
Primary Key present in the Main Store table
IDRS31012 {Duplicate C4 transaction partIDuplicate flag has been found set by the daily input processing _ICheck the contents of the DRS Main Store and C4 Daily Input IDRSC310.pc IB
Inot found lwhere there is no existing transaction part for the matching tables. Contact support with error details.
Primary Key present in the Main Store table.
IDRS31013  IDuplicate C112 trans part [Duplicate flag has been found set by the daily input processing _ICheck the contents of the DRS Main Store and C112 Daily Input IDRSC310.pc IB
Inot found lwhere there is no existing transaction part for the matching tables. Contact support with error details.
Primary Key present in the Main Store table
DRS31014 [Duplicate D trans part not [Duplicate flag has been found set by the daily input processing _ICheck the contents of the DRS Main Store and "D" Daily Input IDRSC310.pc IB
ound lwhere there is no existing transaction part for the matching tables. Contact support with error details.
Primary Key present in the Main Store table.
DRS31015 {Duplicate S trans part not [Duplicate flag has been found set by the daily input processing _ICheck the contents of the DRS Main Store and"S" Daily Input IDRSC310.pc IB
found lwhere there is no existing transaction part for the matching tables. Contact support with error details.
Primary Key present in the Main Store table.
DRS31016 _Iinsert into Main Store Could not insert a record into DRS Main Store Updates table. [Check the contents of DRS Main Store Updates table. Contact IDRSC310.pc IB
Update failed Isupport with error details.
IDRS31017 Missing DRS System No record found in table DRS_SYSTEM_PARAMETERS for the [Check the contents of the table DRS_SYSTEM_PARAMETERS. IDRSC310.pc IB
Parameter parameter named 'PARTITION RECEIPT DATE" Contact support with error details.
DRS31018 {State validation rules has [Fatal Error. One or more validation rules have changed in Check the definition of state validation rules in the database and IDRSC310.pc IB
Ichanged IDRS_STATE_VALIDATION_RULES table the program and update program accordingly. Contact support
lwith error details,
DRS31019 ILoss of State in Main Store [State information has been lost when updating state to F99 via _ICheck the DRS_Operational_Exceptions table for lost, Drs Workstation IB
table the DRS Workstation information. Contact support with error details.
DRS31101 incorrect number of Incorrect number of command-line input parameters have been _ICheck the TWS saripts to see if the call being made to the DRSC3t1.pc IB

parameters

supplied to the module

module is of the form: DRSC311 <Application Type>

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 103 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS31102 {Single insert failed [Single Insert into DRS_RX_C12_EXCP_MAIN has failed Check ORACLE error message for further information DRSC3t1.pc IB
IDRS31103__ Exception unknown The exception to be copied is of unknown type Check ORACLE error message for further information IDRSC3i1.pe IB
DRS31104 {Read current state has failed IUnable to process the current state of the transaction Check ORACLE error message for further information DRSC311.pc IB
DRS31105 [Too many elements in state _Itoo many elements in the state lookup buffer so the buffer could ICheck total state records in DRS TRANSACTION STATES [DRSC311.pc IB
lookup buffer not be populated successfully
DRS31106 {no match in lookup buffer [Unable to find matching primary keys in the main store for the [Check data in DRS_RX_MAIN_STORE DRSC311.pe IB
lduplicate exception in the daily table.
DRS31107 {Single insert failed [Single Insert into DRS_RX_C4_EXCP_MAIN has failed Check ORACLE error message for further information DRSC3t1.pc IB
DRS31108 {Single insert failed [Single Insert into DRS_RX_D_EXCP_MAIN has failed Check ORACLE error message for further information DRSC311.pe IB
DRS31109 {Single insert failed [Single Insert into DRS_RX_S_EXCP_MAIN has failed Check ORACLE error message for further information DRSC311.pc IB
DRS31110 {Single insert failed [Single Insert into DRS_RX_C112_EXCP_MAIN has failed Check ORACLE error message for further information DRSC311.pc IB
DRS31111 {Data Error Unable to copy a transaction due to a data error Transaction may not exist in main store. Check log to see what IDRSC311.pc IB
field failed
DRS32001 incorrect Command-line [Incorrect number of command-line input parameters have been Check the TWS scripts to see if the call being made to the DRSC320.p¢ IB
parameters supplied to the module DRSC320 module is of the form: DRSC320 <Application Type>
DRS32002 IMissing/Invalid Command- _ [Missing/Incorrect command-line input parameters have been —_ICheck the TWS soripts to see if the call being made to the DRSC320.pc IB
line parameters supplied to the module DRSC320 module is of the form: DRSC320 <Application Type>
DRS32201  Iincorrect Command-line —_[Missing/Incorrect command line input parameters have been _ICheck the TWS scripts to see if the call being made to the DRSC322p¢ IB
parameters supplied to the module DRSC322 module is of the form DRSC322 <Application Type>
IDRS32202 IMissing/Invalid Command- IThe input parameter <Application Type> value is NULL, specify aICheck the TWS scripts to see if the call being made has a valid IDRSC322.pc IB
line parameters valid value [Application Type.
DRS32203 INo report ine query found —_INo report line query found for report NB101, check Check table DRS_REP_LINES for appropriate query IDRSC322p¢ IB
IDRS_REP_LINES table
IDRS32204 [Failed to open cursor C1 _[Failed to open cursor C1, check ORACLE error code Check ORACLE error message for further information IDRSC322pe IB

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 104 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS32205 _Iinsert into NB101 Results [Could not insert a record into DRS NB101 Results table Check oracle error message for further information DRSC322p¢ IB
table failed
DRS32206 [PARTITION RECEIPT No record found in DRS_SYSTEM_PARAMETERS table for _ [Check table DRS_SYSTEM_PARAMETERS for the appropriate I[DRSC322.pc IB
DATE! Not found. !PARTITION RECEIPT DATE’. parameter
DRS32207 [PARTITION RECEIPT [System Parameter PARTITION RECEIPT DATE! is NULL Check table DRS_SYSTEM_PARAMETERS for the appropriate IDRSC322,pc IB
DATE? is NULL parameter
IDRS32301 incorrect Command-line __ incorrect number of command-line input parameters have been ICheck the TWS scripts to see if the call being made to the IDRSC323.pc IB
parameters supplied to the module DRSC323 module is of the form: DRSC323 <Application Type>
IDRS32302_IMissing/invalid Command- _IMissing/incorrect command-line input parameters have been _ICheck the TWS scripts to see if the call being made to the IDRSC323.p¢ IB
line parameters supplied to the module DRSC323 module is of the form: DRSC323 <Application Type>
DRS32303 INo report line query found —_INo report line query found for report, check DRS_REP_LINES Check table DRS_REP_LINES for appropriate query DRSC323.pe IB
for report table
DRS32304 [Failed to open cursor Failed to open cursor CUR_DRS_REP_LINES, check ORACLE. [Check ORACLE error message for further information DRSC323.p¢ IB
ICUR_DRS_REP_LINES __Ierror code
DRS32401 incorrect Command-line Incorrect number of command-line parameters Check the TWS scripts to see if the call being made to the IDRSC324.pe IB
parameters module is of the form: DRSC324 [ApplicationT ype]
DRS32402  IMissing/Invalid command- _ [Missing/Invalid command-line parameters Check the TWS scripts to see if the call being made to the DRSC324.p¢ IB
line parameters module is of the form: DRSC324 [ApplicationT ype]
IDRS32403 [Environment variable is not {Environment variable is not set Check the environment variable $NWB_MSU_OUTPUT or IDRSC324.pe IB
set $_NWB_OUTPUT or $NWB_AUDIT_OUTPUT or
SNWB_TIP_OUTPUT
DRS32404 {Opening file failed with error [Opening report file failed with error Check if file already exists with restricted permissions or if DRSC324.pc IB
Idirecctory has restricted permissions
IDRS32405 Closing file failed with error IClosing report file failed with error Check if file exists in $NWB_MSU_OUTPUT or IDRSC324.pe IB
I_ MSU_OUTPUT
DRS32406 [Writing Header error Header being printed is too big Increase header size if necessary DRSC324.p¢ IB

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 105 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS32407 [Error Printing ist column —_[Error in printing first column headings row Check column heading data DRSC324.p¢ IB
headings
[DRS32408 [Error Printing 2nd column —_ [Error in printing second column headings row Check column heading data DRSC324.p¢ IB
headings
DRS32409 Error Printing 1st column —_I Error in printing last TOTAL row Check column heading data IDRSC324.p¢ IB
headings
DRS32410 {Error formatting record Error printing data from drs_rep_file register to the output file. [Check data in drs_rep_results_nb101 IDRSC324.pc IB
outputs
IDRS32411 [Error renaming .LCK file to. IError renaming .LCK file fo .TXT file in $NWB_MSU_OUTPUT _ Check permissions on .LCK files in $NWB_MSU_OUTPUT IDRSC324.p¢ IB
TXT file
DRS32412 [Error whilst removing file _ [Error whilst removing file <TxtFile>:<ErrorMsg> Check <ErrorMsg> for further details IDRSC324.p¢—IC
IDRS32413 [Unable to link file TIP/AUDIT IUnable to link file from $NWB_MSU_OUTPUT to Delete file from $NWB_TIP_OUTPUT and/or IDRSC324.pc IB
directory SNWB_TIP_OUTPUT or $NWB_AUDIT_OUTPUT directory __ ISNWB_AUDIT_OUTPUT. Check permissions on directory
DRS32501 incorrect Command-line —_[Missing/Incorrect command-line input parameters have been _ICheck the TWS scripts to see if the call being made to the DRSC325.pc IB
parameters supplied to the module DRSC325 module is of the form: DRSC325 <Application Type>
DRS32502 IMissing/Invalid Command- [incorrect number of command-line input parameters have been [Check the TWS scripts to see if the call being made to the DRSC325.pc IB
line parameters supplied to the module DRSC325 module is of the form: DRSC325 <Application Type>
DRS32503 {Environment variable is not [Environment variable is not set Check the environment variable $NWB_MSU_OUTPUT or DRSC325.p¢ IB
set I$_NWB_OUTPUT or $NWB_AUDIT_OUTPUT or
SNWB_TIP_OUTPUT
DRS32504 I Writing Header error Header being printed is too big Increase header size if necessary DRSC325.pc IB
DRS32505 Opening file failed with error [Opening report file failed with error Check if file already exists with restricted permissions or if DRSC325.pc IB
directory has restricted permissions
IDRS32506 Closing file failed with error IClosing report file failed with error Check if file exists in SNWB_MSU_OUTPUT or IDRSC325.pc IB
I_ MSU_OUTPUT
DRS32507 [Error Printing ist column [Error in printing first column headings row Check column heading data DRSC325.pc Ic
headings

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 106 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS32508 [Error Printing 2nd column —_ [Error in printing second column headings row Check column heading data DRSC325.pe Ic
headings
DRS32509 [Error formatting record [Error printing data from drs_rep_file register to the output file [Check data in drs_rep_results_nb102_x DRSC325.p¢ Ie
outputs
IDRS32510 [Error renaming .LCK file to Error renaming .LCK file to .TXT file in $NWB_MSU_OUTPUT __ICheck permissions on .LCK files in $NWB_MSU_OUTPUT IDRSC325.p¢ IB
TXT file
IDRS32511 Error whilst removing file _IError whilst removing file <TxtFile>:<ErrorMsg> Check <ErrorMsg> for further details IDRSC325.po
IDRS32512 [Unable to link file TIP/AUDIT IUnable to link file from $NWB_MSU_OUTPUT to Delete file from $NWB_TIP_OUTPUT and/or IDRSC325.pe IB
directory SNWB_TIP_OUTPUT or $NWB_AUDIT_OUTPUT directory ISNWB_AUDIT_OUTPUT. Check permissions on directory
DRS32801 incorrect Command-line _Incorrect number of command-line parameters Check the TWS soripts to see if the call being made to the DRSC328.p¢ IB
parameters module is of the form: DRSC328 [ApplicationT ype]
DRS32802 IMissing/Invalid command- _ [Missing/Invalid command-line parameters Check the TWS seripts to see if the call being made to the DRSC328.p¢ IB
line parameters module is of the form: DRSC328 [ApplicationT ype]
IDRS32803 [Environment variable is not {Environment variable is not set Check the environment variable $NWB_MSU_OUTPUT or IDRSC328.pe IB
set Is_NWB_OUTPUT or $NWB_AUDIT_OUTPUT or
SNWB_TIP_OUTPUT
DRS32804 Opening file failed with error [Opening report file failed with error Check if file already exists with restricted permissions or if DRSC328.p¢ IB
Idirecctory has restricted permissions
IDRS32805 Closing file failed with error IClosing report file failed with error Check if file exists in $NWB_MSU_OUTPUT or IDRSC328.pe IB
I_ MSU_OUTPUT
DRS32806 I Writing Header error Header size being printed is too big Increase header size if necessary DRSC328.pe
DRS32807 {Error Printing 1st column —_IError in printing first column headings row Check column heading data IDRSC328.pe
headings
DRS32808 [Error Printing 2nd column [Error in printing second column headings row Check column heading data IDRSC328.pe  IC
headings
DRS32809 [Error formatting record Error printing data from drs_rep_file register to the output file [Check data in drs_rep_file_register DRSC328.pc IB
loutputs

© Copyright Fujitsu Services

Limited 2009-2020

UNCONTROLLED IF PRINTED OR LOCALLY

FUJITSU RESTRICTED (COMMERCIAL IN Ref:

CONFIDENCE) Version

Date:

STORED Page No:

DEV/APP/SPG/0028

30-Mar-2020
107 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

Exception IShort Description Full Description [Action Program Name IPriority

Code

DRS32810 _Iinvalid/No row selected in _[invalid/Null SQL found in DRS_REP_LINES for report = NBOOO_ICheck entry in drs_rep_lines for report_number = 'NBOOO' DRSC328.pc (IB
idrs_rep_lines land (Application-Type = x Or Application-Type = NULL)

IDRS32811 [Error renaming .LCK file to. IError renaming .LCK file to .TXT file in $NWB_MSU_OUTPUT —_ICheck permissions on .LCK files in $NWB_MSU_OUTPUT IDRSC328.pe IB
TXT file

DRS32812 [Error whilst removing file _IError whilst removing file <TxtFile>:<ErrorMsg> Check <ErrorMsg> for further details IDRSC328.pe

IDRS32813 [Unable to link file TIP/AUDIT IUnable to link file from $NWB_MSU_OUTPUT to Delete file from $NWB_TIP_OUTPUT and/or IDRSC328.pe IB
directory SNWB_TIP_OUTPUT or $NWB_AUDIT_OUTPUT directory ISNWB_AUDIT_OUTPUT. Check permissions on directory

DRS35001 incorrect no of Command- _ [incorrect number of command-line input parameters have been [Check the TWS scripts to see if the call being made to the IDRSC350.pe IB
line parameters supplied to the module DRSC350 module is of the form: DRSC350 <Application Type>

DRS35002 _Iinvalid Command line Invalid command-line input parameters have been supplied to ICheck the TWS scripts to see if the call being made to the DRSC350.pc IB
parameter the module DRSC350 module is of the form: DRSC350 <Application Type>

DRS35003 [Failed to retrieve TablespaceICould not retrieve tablespace Name for <TableName> Check ORACLE error message for further information DRSC350.pc IB
Name

DRS35004 [Parameter not set Parameter MAXIMUM NUMBER OF PARTITIONS not set for [Check ORACLE error message for further information DRSC350.pc IB

<ApplicationType>
DRS35005 [Parameter not set Parameter PARTITION RECEIPT DATE not set for Check ORACLE error message for further information DRSC350.pc IB
<ApplicationType>

IDRS35006 [Failed to drop Partition Failed to drop Partition <PartitionNAme> for <TableName> Check ORACLE error message for further information DRSC350.pc IB

IDRS35007 [Failed to create Partition _I Failed to create Partition <PartitionNAme> for <TableName> —_ ICheck ORACLE error message for further information IDRSC350.pc IB

IDRS35008 Failed to update Failed to update DRS SYSTEM DATE and PARTITION Check ORACLE etror message for further information DRSC350.p¢ IB
DRS_SYSTEM_PARAMETEIRECEIPT DATE for <ApplicationType>
RS

DRS35009 [Failed to update Failed to update C4SD FILE LOAD COMPLETE, DRS. Check ORACLE error message for further information DRSC350.p¢ IB
DRS_SYSTEM_PARAMETEIPROCESSING DAY COMPLETE and BATCH JOB STARTED
RS {tor <ApplicationType>

DRS35101 incorrect Command-line Incorrect number of command-line input parameters have been [Check the TWS scripts to see if the call being made to the DRSC351.p¢ IB
parameters supplied to the module DRSC351 module is of the form: DRSC351 <Application Type>

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 108 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception [Short Description Full Description ‘Action Program Name IPriority
[Code
DRS35102 [Missing System parameter [No entry for parameter 'DRS PROCESSING DAY COMPLETE’ ICheck the contents of table DRS_SYSTEM_PARAMETERS to IDRSC351.p¢ IB
{found in table DRS_SYSTEM_PARAMETERS see if a record corresponding to the given parameter is present
IDRS35301 [Incorrect Command-line Incorrect number of command-line input parameters have been ICheck the TWS scripts to see if the call being made to the IDRSC353.pc IB
parameters supplied to the module DRSC353 module is of the form: DRSC350 <Application Type>
DRS35302 invalid Command line Invalid command-line input parameters have been supplied to [Check the TWS scripts to see if the call being made to the DRSC353.p¢ IB
parameter the module DRSC353 Imodule is of the form: DRSC350 <Application Type>
DRS35303 [Update of Batch Parameter ITable DRS_SYSTEM_PARAMETERS could not be updated —_ICheck ORACLE error message for further information DRSC353.p¢ IB
failed
IDRS36101 [Incorrect Command-line Incorrect number of command-line input parameters have been ICheck the TWS scripts to see if the call being made to the IDRSC361.pc 1B
parameters supplied to the module DRSC361 module is of the form: DRSC361 [ApplicationType]
DRS36102 IMissing/Invalid Command- _IMissing/Invalid command-line parameters have been supplied to [Check the TWS scripts to see if the call being made to the DRSC361.pe IB
line parameters the module DRSC361 module is of the form: DRSC361 [ApplicationType]
DRS36103 [System parameter not found [PARTITION RECEIPT DATE or MAXIMUM NUMBER OF Check table DRS_SYSTEM_PARAMETERS for the appropriate IDRSC361.pe IB
IPARTITIONS not found. parameters
DRS36104 [Unable toaccess table [Unable to access DRS_SYSTEM_PARAMETERS table Check Oracle table DRS_SYSTEM_PARAMETERS exists and IDRSC361.pc IB
has necessary permissions
DRS36105 invalid System parameter [PARTITION RECEIPT DATE system parameter is NULL Check table DRS_SYSTEM_PARAMETERS for the appropriate IDRSC361.pc IB
parameter
DRS36106 invalid System parameter [MAXIMUM NUMBER OF PARTITIONS System parameter is [Check table DRS_SYSTEM_PARAMETERS for the appropriate IDRSC361.pc IB
NULL parameter
IDRS36107 IUnable to access table [Unable to access DRS_ARCHIVED_TABLES table [Check Oracle table DRS_ARCHIVED_TABLES exists and has IDRSC361.pce iB
necessary permissions,
IDRS36108 Unable to fetch from table [Unable to fetch from DRS_ARCHIVED_TABLES table [Check Oracle table DRS_ARCHIVED_TABLES for the IDRSC361.pc iB
lappropriate message
DRS36109 [Environment variable is not_ [Environment variable <EnvVar> is not set. [Set the Environment variable with correct value DRSc361.pe IB
set
IDRS36110_ IError creating parameter file IError creating parameter file <Parfile>:<ErrorMsg> Check <ErrorMsg> for further details IDRSC361.pe IB
FUJITSU RESTRICTED (COMMERCIAL IN Ref. DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 109 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

Exception IShort Description Full Description [Action Program Name IPriority

Code

DRS36111 [Unable to create a link toa [Unable to create a link to the file <Source> -> Check <ErrorMsg> for further details IDRSC361.pe IB
file /<Target>:<ErrorMsg>

DRS36112 [Unable to execute Dynamic [Unable to execute dynamic SQL statement <SQL Stmt> Check ORACLE error message for further information IDRSC361.pe IB
SQL stmt

DRS36113 [Unable to access table Unable to access USER_TAB_PARTITIONS table Check Oracle table USER_TAB_PARTITIONS exists and has IDRSC361.pc IB

necessary permissions
DRS36114 [Unable to fetch from table [Unable to fetch from USER_TAB_PARTITIONS table Check Oracle table USER_TAB_PARTITIONS for appropriate IDRSC361.pc IB
message

IDRS36115 [Error executing unix Error executing command <CommandStr>:<ErrorMsg> Check <ErrorMsg> for further details IDRSC361.p¢ IB
command

DRS36116 _ Error opening export Log file [Error opening export Log file <Logfile>:<ErrorMsg> Check <ErrorMsg> for further details DRSC361.pe IB

DRS36117 [Error whilst exporting data _IError whilst exporting data, check log file <LogFile> Check export log file <Logfile> for the actual error message. IDRSC361,pc IB

IDRS36118 [Unable to read export log file IUnable to read export log file <Logfile>:<ErrorMsg> Check <ErrorMsg> for further details DRSC361.pc IB

IDRS36119 [Static data missing IDRS_ARCHIVED_TABLES static data missing, no tables Check Oracle table DRS_ARCHIVED_TABLES, if entries DRSC361.p¢ IB

archived/purged missing, run build script to populate.

DRS36120 [Error whilst renaming .dmp [Error whilst renaming file from <SrcFile> to Check <ErrorMsg> for further details DRSC361.p¢ IB
to .err file <TgtFile>:<ErrorMsg>

DRS36201 [File Housekeeping job has _ [DRS File Housekeeping job has failed due to an application or [Check the TWS log for more details of the error. Contact DRSx362.sh IB
failed ldatabase error EDSC/SSC (3rd Line Support) in normal working hours.

DRS36401 incorrect Command-line _IMissing/Incorrect command-line input parameters have been _ICheck the TWS soripts to see if the call being made to the DRSC364.pc IB
parameters supplied to the module DRSC364 module is of the form: DRSC364 <Application Type>

IDRS36402 No data to be copied from —_INo data has been found to be copied from RDDS table Check the data and correct public synonyms exist IDRSC364.p¢ IB
RDDS IDRS_ROUTING_GATEWAYS

DRS36403 _INo data to be copied from _INo data has been found to be copied from RDDS table Check the data and correct public synonyms exist DRSC364.p¢ IB
RDDS IDRS_ACCOUNTING_WEEKS

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 110 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)

Exception IShort Description Full Description [Action Program Name IPriority

Code

DRS36701 incorrect Command-line __[Missing/Incorrect command-line input parameters have been _ICheck the TWS scripts to see if the call being made to the DRSC367.pc IB
parameters supplied to the module DRSC367 module is of the form: DRSC367 <Application Type>

DRS36702 IMissing/invalid Command- [incorrect number of command-line input parameters have been [Check the TWS scripts to see if the call being made to the. DRSC367.pc IB
line parameters supplied to the module DRSC367 module is of the form: DRSC367 <Application Type>

DRS36703 Environment variable is not_ [Environment variable NWB II _TIP_OUTPUT is not set ‘Set environment variable appropriately IDRSC367.pc IB
set

DRS36704 {Error occurred opening pipe IError occurred opening pipe Refer to the Exception Error message for further details DRSC367.pc IB

DRS36705 [Error occurred closing pipe _ [Error occurred closing pipe Refer to the Exception Error message for further details DRSC367.pc IB

DRS36706 {TIP Receipt File open failed Error occurred while opening the TIP harvest receipt file in Read ICheck for the existence of TIP harvest receipt file and refer to theIDRSC367.pc IB
with error mode Exception Error message for further details

IDRS36707 {TIP File Delivery Date/Time IThe file delivery Date/Time of corresponding transaction file for IDRSC367.pc IB
Inot found the TIP interface was not found in the TIP Harvest Receipt file

DRS36708 [File entry not found in File _ [Entry for the TIP transaction file was not found in the table IDRSC367.pc IB
Register tps_file_register

DRS36709 [Error while renaming receipt IAn Error occurred while renaming the TIP Harvest Receipt fle to [Check Exception Error message for further details DRSC367.pc IB
file Ichange file extension from “ACK” to “.ack”

DRS36801  Iincorrect Command-line _I Incorrect number of input command-line parameters Check the TWS soripts to see if the call being made to the DRSC368.pc IB
parameters, module is of the form: DRSC368 <Application Type> <Run

Group 1>...<Run Group N>

DRS36802 _IInvalid Command line No input Run Groups have been provided on command line [Check the TWS soripts to see if the call being made to the DRSC368.pc IB

parameters module is of the form: DRSC368 <Application Type> <Run
Group 1>...<Run Group N>
DRS36803 _Iinvalid Input Record Group [No records found in table DRS_ANALYZED_OBJECTS for Check if the Run-Group being passed command-line DRSC368.p¢ IB
Object Group with given name corresponds with data in DRS_ANALYZED_OBJECTS table

IDRS36804 No record foundin DRS —_INo corresponding record for the input Table/Index with given _ICheck contents of DRS_ANALYZED_OBJECTS to ensure that IDRSC368.pc IB

Metadata name found in DRS Metadata the correct Object Name and Object Type are used

© Copyright Fujitsu Services

Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 111 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS36805 Given Partition Number not IThe given partition number for Table/Index with given Object _ICheck contents of DRS_ANALYZED_OBJECTS to ensure that IDRSC368.pc IB
available Name is not available as the object has only set sumber of the correct Partition Number is present as parameter for the
partitions (Object Name and Object Type
DRS36806 _IGiven Partition Number not_INo corresponding entry for the input Table/Index with given Check contents of DRS_ANALYZED_OBJECTS to ensure that IDRSC368.po (IB
available name and given partition position found in DRS Metadata Ithe correct Partition Number is present as parameter for the
(Object Name and Object Type
DRS37101 incorrect Command-line incorrect number of command-line input parameters have been [Check the TWS scripts to see if the call being made to the DRSC371.pe
parameters supplied to the module DRSC371 module is of the form: DRSC371 <Application Type> B
DRS37102  IMissing/Invalid Command- _IMissing/Incorrect command-line input parameters have been _ICheck the TWS soripts to see if the call being made to the IDRSC371.pe
line parameters supplied to the module DRSC371 module is of the form: DRSC371 <Application Type>
DRS37106 _Iinvalid C4/D table names _IInvalid C4/D table names entry in tes_partition_creates table _ [Check C4/D entry in tes_partiion_creates table IDRSC371.pe
DRS37107 [Unknown Error during JA non-data related Oracle error has occurred during bulk inserts. ICheck oracle error message for further information DRSC371.pe
inserts into table DRS_RX_C4 B
DRS37111 [Sequence reached Max _I The Horizon Transaction Id - Receipt Date Sequence has Confirm correct execution of the C4SD process(TESC340) DRSC371.pe
Value reached its maximum allowed value Check for valid data in the TES_TX_C4 table B
IDRS37112 [Unknown Error during IA non-data related Oracle error has occurred during inserts into ICheck oracle error message for further information IDRSC371.pe
inserts tables DRS_RX_C4 or DRS_RX_C4_EXCP B
IDRS37117 [Unknown Error during IA non-data related Oracle error has occurred during inserts into ICheck oracle error message for further informatio IDRSC371_.pe
inserts lable DRS_RX_C4_EXCP B
IDRS37108 [Unknown Error during JA non-data related Oracle error has occurred during bulk inserts ICheck oracle error message for further information IDRSC371 pe
inserts into table DRS_RX_D B
IDRS37113 ISequence reached Max —_I The Horizon Transaction Id - Receipt Date Sequence has Confirm correct execution of the C4/D process(TESC340), IDRSC371.pe
Value reached its maximum allowed value Check for valid data in the TES_TX_D table B
DRS37114 [Unknown Error during IA non-data related Oracle error has occurred during inserts into ICheck oracle error message for further information IDRSC371.pe
inserts tables DRS_RX_D or DRS_RX_D_EXCP B
DRS37118 [Unknown Error during IA non-data related Oracle error has occurred during inserts into. ICheck oracle error message for further information DRSC371.pe
inserts table DRS_RX_D_EXCP B

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028.
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 112 of 114
FUJ00234962

FUJ00234962
oO DRS Host Support Guide
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN
CONFIDENCE)
Exception IShort Description Full Description [Action Program Name IPriority
Code
DRS37110__Iinvalid Input Message Type invalid value of Message Type passed to the function that Check contents of the TES_TX_C4/D input table to see if one or IDRSC371.pc
handles Data related exceptions more messages are of invalid message type
DRS37101 incorrect Command-line Incorrect number of command-line input parameters have been [Check the TWS scripts to see if the call being made to the IDRSC371.pe
parameters supplied to the module DRSC371 module is of the form: DRSC371 <Application Type>
DRS37201 _Iincorrect no of Command- _ [incorrect number of command-line parameters Check the Maestro scripts to see if the call being made tothe IDRSC372
line parameters module is of the form: DRSC372 <Application Type> <Routing
Gateway><DCSSETDT> B
DRS37202 _Iinvalid Command line Invalid Command line parameter Check the Maestro scripts to see if the call being made to the IDRSC372
parameter module is of the form: DRSC372 <Application Type> <Routing
Gateway>><DCSSETDT> B
DRS37203 _IInvalid input Routing Input Routing Gateway not find in Check the Maestro scripts to see if the correct input routing DRSC372
Gateway IRDDS_ROUTING_GATEWAYS Igateway is invoked to the module DRSC372 B
DRS37204 [Error whilst OPEN cursor IThe process is Unable to open the SQL cursor due tosome Check the SL statement in the exception message for any IDRSC372
ldatabase issues Isyntax errors or table access errors. B
DRS37205 [Error whilst FETCH from _I The process is unable to fetch from the SQL cursor due to some ICheck the SQL statement in the exception message for any IDRSC372
cursor ldatabase issues syntax errors or table access errors B

© Copyright Fujitsu Services
Limited 2009-2020

FUJITSU RESTRICTED (COMMERCIAL IN Ref: DEV/APP/SPG/0028
CONFIDENCE) Version: 7.0
UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020
STORED Page No: 113 of 114
FUJ00234962
FUJ00234962

oO DRS Host Support Guide ~
FUJITSU FUJITSU RESTRICTED (COMMERCIAL IN E&

CONFIDENCE)

Appendix F — DRS Archiving Table Mapping

DRS_ARCHIVED_TAB

LES.csv
FUJITSU RESTRICTED (COMMERCIAL IN. Ref: DEV/APP/SPG/0028
© Copyright Fujitsu Services CONFIDENCE) Version 7.0
Limited 2009-2020 UNCONTROLLED IF PRINTED OR LOCALLY Date: 30-Mar-2020

STORED Page No: 114 of 114
